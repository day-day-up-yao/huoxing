{"version":3,"sources":["webpack:///./_multiappsharing/components-m/WebchatOpenInBrowser/index.js","webpack:///./_multiappsharing/public/hooks/useAppDownload.js","webpack:///./_multiappsharing/components-m/WebchatOpenInBrowser/images/wechat-download-tips.png","webpack:///./_multiappsharing/components-m/DownloadBtn/index.js","webpack:///./_multiappsharing/components-m/DownloadBtn/images/cellphone-icon.png","webpack:///./assets/containers-m/Home/TopAdCarousel/index.js","webpack:///./assets/containers-m/Home/NewsListItem/index.js","webpack:///./assets/containers-m/Home/FlashListItem/index.js","webpack:///./assets/containers-m/Home/NewsContent/index.js","webpack:///./assets/containers-m/Home/index.js"],"names":["react__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","react__WEBPACK_IMPORTED_MODULE_0___default","n","_images_wechat_download_tips_png__WEBPACK_IMPORTED_MODULE_2__","_images_wechat_download_tips_png__WEBPACK_IMPORTED_MODULE_2___default","__webpack_exports__","props","openInBrowser","a","createElement","className","onClick","setOpenInBrowser","src","tipsImg","alt","_redux_actions_public__WEBPACK_IMPORTED_MODULE_1__","_components_Toast__WEBPACK_IMPORTED_MODULE_2__","_public__WEBPACK_IMPORTED_MODULE_3__","iosUrl","andUrl","useRef","openApp","useCallback","url","doNotDownload","callback","intHandle","_clickTime","_count","location","href","isIos","isAndroid","current","Date","setInterval","elsTime","clearInterval","document","hidden","webkitHidden","console","log","appDownload","type","id","obj","isWechat","concat","useEffect","getAndroidDownloadUrl","then","res","code","Toast","info","msg","err","module","exports","p","_useState","useState","_useState2","_babel_runtime_helpers_slicedToArray__WEBPACK_IMPORTED_MODULE_0___default","iphonex","setIphonex","_useState3","_useState4","useAppDownload","clickDownload","isIphoneX","react__WEBPACK_IMPORTED_MODULE_1___default","phoneIcon","_components_m_WebchatOpenInBrowser__WEBPACK_IMPORTED_MODULE_4__","Home_TopAdCarousel","primaryImgData","useSelector","state","home","shallowEqual","react_default","swiper","map","item","index","swiper_slide","key","title","target","mImgSrc","NewsListItem","nickName","coverPic","publishTime","serverTime","newsLink","videoImg","stringJsonItem","formatPublishTime","propTypes","string","isRequired","createdTime","content","startIndex","indexOf","endIndex","flashTitle","substring","flashLink","Home_NewsContent","isLoading","currentPage","slicedToArray_default","params","setParams","dispatch","useDispatch","newsHeadlinesData","newsList","setNewsList","scrollFunc","windowScroll","$btnMore","getElementById","scrollOffset","top","windowOffset","height","elementOffset","loadMore","window","removeEventListener","data","time","isArray","length","getTime","getNewsHeadlines","list","objectSpread_default","itemList","infoObj","infoType","containers_m_Home_NewsListItem","extends_default","Home_FlashListItem","Home","DownloadBtn","Component","connect","userInfo","login"],"mappings":"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","file":"containers-m-Home-4340ff1b.js","sourcesContent":["import React from 'react'\nimport './index.scss'\nimport tipsImg from './images/wechat-download-tips.png'\n\nexport default (props) => {\n    return props.openInBrowser && <div\n        className=\"download-app-wechat-tips\"\n        onClick={() => props.setOpenInBrowser(false)}>\n        <div className=\"download-app-img\">\n            <img src={tipsImg} alt=\"请在浏览器中打开\" />\n        </div>\n    </div>\n}\n","import { useEffect, useCallback, useRef } from 'react'\nimport { getAndroidDownloadUrl } from '../../redux/actions/public'\nimport Toast from '../../components/Toast'\nimport { isAndroid, isIos, isWechat } from '../../public'\n\nconst checkOpen = (callback) => {\n    let _clickTime = +(new Date())\n    // 启动间隔20ms运行的定时器，并检测累计消耗时间是否超过3000ms，超过则结束\n    let _count = 0\n    let intHandle\n    intHandle = setInterval(() => {\n        _count++\n        let elsTime = +(new Date()) - _clickTime\n        if (_count >= 100 || elsTime > 3000) {\n            clearInterval(intHandle)\n            if (elsTime > 3000 || document.hidden || document.webkitHidden) {\n                console.log('正在打开app')\n            } else {\n                callback()\n            }\n        }\n    }, 20)\n}\n\n/**\n * @params type 当前页面类型 id文章视频等相对应的id\n * newsDetail新闻详情，newsList新闻列表\n * flashDetail快讯详情，flashList快讯列表\n * videoDetail视频详情，videoList视频列表\n * authorCenter作者中心\n * 不传type默认跳转到首页\n * 返回appDownload 传递以上参数\n * 并返回openInBrowser是否提示浏览器中打开\n * */\nexport default () => {\n    const iosUrl = 'https://itunes.apple.com/cn/app/id1343659925?mt=8'\n    const andUrl = useRef('')\n\n    const openApp = useCallback((url, doNotDownload) => {\n        location.href = url\n        checkOpen(() => {\n            if (isIos() && !doNotDownload) location.href = iosUrl\n            if (isAndroid() && !doNotDownload) location.href = andUrl.current\n        })\n    }, [andUrl])\n\n    const appDownload = useCallback((type, id, obj) => {\n        const doNotDownload = obj ? obj.doNotDownload : false\n        let openInBrowser = false\n        if (isWechat() && isIos()) {\n            // 打开appStore\n            location.href = iosUrl\n        } else if (isWechat() && isAndroid()) {\n            // 提示浏览器中打开\n            openInBrowser = true\n        } else {\n            switch (type) {\n                case 'liveshare':\n                    openApp(`marsbusiness://liveshare/${id}`, doNotDownload)\n                    break\n                case 'newsDetail':\n                    openApp(`marsbusiness://news/${id}`, doNotDownload)\n                    break\n                case 'newsList':\n                    openApp(`marsbusiness://newlist/${id}`, doNotDownload)\n                    break\n                case 'flashDetail':\n                    openApp(`marsbusiness://fast/${id}`, doNotDownload)\n                    break\n                case 'flashList':\n                    openApp(`marsbusiness://home/fast`, doNotDownload)\n                    break\n                case 'videoDetail':\n                    openApp(`marsbusiness://video/${id}`, doNotDownload)\n                    break\n                case 'videoList':\n                    openApp(`marsbusiness://home/video`, doNotDownload)\n                    break\n                case 'authorCenter':\n                    openApp(`marsbusiness://authorCenter/${id}`, doNotDownload)\n                    break\n                case 'noticeDetail':\n                    openApp(`marsbusiness://noticeDetail/${id}`, doNotDownload)\n                    break\n                default:\n                    openApp(`marsbusiness://home/new`, doNotDownload)\n            }\n        }\n\n        return openInBrowser\n    }, [andUrl])\n\n    useEffect(() => {\n        getAndroidDownloadUrl().then(function (res) {\n            if (res.code === 1) {\n                andUrl.current = res.obj\n            } else {\n                Toast.info(res.msg)\n            }\n        }).catch(function (err) {\n            throw err\n        })\n    }, [])\n\n    return appDownload\n}\n","module.exports = __webpack_public_path__ + \"wechat-download-tips-fef770a1.png\";","import React, { useState, useCallback, useEffect } from 'react'\nimport './index.scss'\n\nimport { isIphoneX } from 'multiPublic/index'\nimport WebchatOpenInBrowser from '../../components-m/WebchatOpenInBrowser'\nimport useAppDownload from '../../public/hooks/useAppDownload'\nimport phoneIcon from './images/cellphone-icon.png'\n\nexport default (props) => {\n    const [iphonex, setIphonex] = useState(false)\n    const [openInBrowser, setOpenInBrowser] = useState(false)\n    const appDownload = useAppDownload()\n    const clickDownload = useCallback(() => {\n        setOpenInBrowser(appDownload(props.type, props.id))\n    }, [])\n    useEffect(() => {\n        isIphoneX() && setIphonex(true)\n    }, [])\n    return <div className={`download-app-wrapper ${iphonex ? 'iphonex' : ''}`}>\n        <a className=\"download-app-btn\" onClick={clickDownload}>\n            <img src={phoneIcon} alt=\"下载MarsBit\"/>\n            下载MarsBit APP\n        </a>\n        <WebchatOpenInBrowser openInBrowser={openInBrowser} setOpenInBrowser={setOpenInBrowser} />\n    </div >\n}\n","module.exports = __webpack_public_path__ + \"cellphone-icon-524dafc5.png\";","import React from 'react'\nimport { useSelector, shallowEqual } from 'react-redux'\nimport { Swiper, SwiperSlide } from 'swiper/react'\nimport './index.scss'\nexport default () => {\n    const { primaryImgData } = useSelector((state) => ({\n        primaryImgData: state.home.primaryImgData\n    }), shallowEqual)\n\n    return (\n        <div className=\"top-ad-carousel\">\n            <Swiper id='newsWrap'>\n                {\n                    primaryImgData && primaryImgData.map((item, index) => {\n                        return (\n                            <SwiperSlide className=\"\" key={index}>\n                                <a title={item.title} target=\"_self\" href={item.url}>\n                                    <img src={item.mImgSrc} alt={item.title} />\n                                </a>\n                                <span className=\"img-news-title\">{item.title}</span>\n                            </SwiperSlide>\n                        )\n                    })\n                }\n            </Swiper>\n        </div>\n    )\n}\n","import { string } from 'prop-types'\nimport React from 'react'\nimport { stringJsonItem, formatPublishTime } from 'multiPublic/index'\nimport './index.scss'\n// import SimpleImg from './SimpleImg'\n\nconst NewsListItem = (props) => {\n    const { title, nickName, coverPic, publishTime, id, serverTime } = props\n    const newsLink = `/newsdetail/${id}.html`\n    const videoImg = stringJsonItem(coverPic, 'wap_small')\n    return <div className=\"news-list-more\">\n        <a className=\"item-left\" title={title} href={newsLink} target=\"_self\" >\n            <div className=\"title\">{title}</div>\n            <div className=\"list-text\">\n                <div className=\"bottom-left clearfix\">\n                    <div className=\"nick-name\">{nickName}</div>\n                    <div className=\"time\"> <time>{formatPublishTime(publishTime, (serverTime && serverTime !== '') && serverTime)}</time></div>\n                </div>\n            </div>\n            <div className=\"cover-img-sma-first\">\n                {/* <SimpleImg coverPic={videoImg} type=\"wap_small\" /> */}\n                <img src={videoImg} />\n            </div>\n        </a>\n    </div>\n}\nNewsListItem.propTypes = {\n    title: string.isRequired\n}\n\nexport default NewsListItem\n","import { string } from 'prop-types'\nimport React from 'react'\nimport { formatPublishTime } from 'multiPublic/index'\nimport './index.scss'\n\nconst NewsListItem = (props) => {\n    const { title, createdTime, id, content, serverTime } = props\n    let startIndex = content.indexOf('【') === -1 ? 0 : content.indexOf('【') + 1\n    let endIndex = content.indexOf('】') === -1 ? 0 : content.indexOf('】')\n    let flashTitle = content.substring(startIndex, endIndex)\n    let flashLink = `/flash/${id}.html`\n    return <div className=\"news-list-more\">\n        <a title={title} href={flashLink} target=\"_self\" >\n            <div className=\"flashTitle\">{flashTitle}</div>\n            <div className=\"list-text\">\n                <div className=\"bottom-left clearfix\">\n                    <div className=\"nick-name txt_0A7FF2\">快讯</div>\n                    <div className=\"time\">·<span> <time>{formatPublishTime(createdTime, (serverTime && serverTime !== '') && serverTime)}</time></span></div>\n                </div>\n            </div>\n        </a>\n    </div>\n}\nNewsListItem.propTypes = {\n    title: string.isRequired\n}\n\nexport default NewsListItem\n","import React, { useState, useEffect, useCallback, useRef } from 'react'\nimport { useSelector, useDispatch } from 'react-redux'\nimport NewsListItem from '../NewsListItem'\nimport FlashListItem from '../FlashListItem'\nimport Toast from 'multiComps/Toast'\nimport { scrollOffset, elementOffset, isArray, windowOffset, windowScroll } from 'multiPublic'\nimport { getNewsHeadlines } from '../../../redux/actions/home'\nimport './index.scss'\nexport default () => {\n    const isLoading = useRef(false) // 是否在加载中\n    const paramObj = {\n        currentPage: 1\n    }\n    const [params, setParams] = useState(paramObj)\n    const dispatch = useDispatch()\n    const { newsHeadlinesData } = useSelector((state) => ({\n        newsHeadlinesData: state.home.newsHeadlinesData\n    }))\n    const [newsList, setNewsList] = useState(newsHeadlinesData)\n\n    useEffect(() => {\n        const scrollFunc = windowScroll((res) => {\n            if (res !== 'down' || isLoading.current) return false\n\n            const $btnMore = document.getElementById('btnMore')\n            if (scrollOffset().top + windowOffset().height > elementOffset($btnMore).top - windowOffset().height / 2) {\n                loadMore()\n            }\n        })\n        return () => {\n            window.removeEventListener('scroll', scrollFunc, false)\n        }\n    }, [params, isLoading, newsHeadlinesData])\n\n    const loadMore = useCallback(() => {\n        if (isLoading.current) return false\n\n        isLoading.current = true\n        let data = newsHeadlinesData.concat()\n        let time = data && isArray(data) && data.length > 2 ? data[data.length - 1].publishTime : new Date().getTime()\n        dispatch(getNewsHeadlines(time, 'isMore', true)).then(function (res) {\n            if (res.code === 1) {\n                isLoading.current = false\n                let list = res.obj\n                if (!isArray(list) || list.length === 0) {\n                    Toast.info('暂无更多新闻')\n                } else {\n                    setParams({\n                        ...params,\n                        currentPage: params.currentPage + 1\n                    })\n                }\n            } else {\n                Toast.info(res.msg)\n            }\n        }).catch(function (err) {\n            console.log(err)\n            Toast.info('获取列表错误')\n        })\n    }, [params, isLoading])\n    useEffect(() => {\n        setNewsList(newsHeadlinesData)\n    }, [newsHeadlinesData])\n\n    return (\n        <div className=\"news-box\">\n            <div className=\"list-box\">\n                {\n                    newsList && newsList.map((item, index) => {\n                        const itemList = item.infoObj\n                        if (item.infoType === 'news') {\n                            return <NewsListItem {...itemList} key={index} />\n                        } else if (item.infoType === 'live') {\n                            return <FlashListItem {...itemList} key={index} />\n                        }\n                    })\n                }\n            </div>\n            <div className=\"flash-more-btn\">\n                <div className=\"btn-more\" id=\"btnMore\">加载更多</div>\n            </div>\n        </div>\n    )\n}\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\nimport DownloadBtn from 'multiCompsM/DownloadBtn'\nimport TopAdCarousel from './TopAdCarousel'\nimport NewsContent from './NewsContent'\nimport './index.scss'\n\nclass Home extends Component {\n    render () {\n        // const { userInfo } = this.props\n\n        return <div className=\"m-home\">\n            <TopAdCarousel />\n            <NewsContent />\n            <DownloadBtn type=\"home\" />\n        </div>\n    }\n}\n\nconst mapStateToProps = (state) => ({\n    userInfo: state.login.userInfo\n})\nexport default connect(mapStateToProps)(Home)\n"],"sourceRoot":""}