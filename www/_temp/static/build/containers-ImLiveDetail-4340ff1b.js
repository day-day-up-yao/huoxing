(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[20],{1188:function(e,t,a){"use strict";var i=a(3),l=a.n(i),n=a(22),c=a.n(n),o=a(0),r=a(27),s=a(19),m=a(17),u=a(1),d=a(1102),v=function(e){return Number(e)<10?"0".concat(e):e},f={color:"rgba(255, 255, 255, 0.9)",fontSize:"24px",textShadow:"rgb(0, 0, 0) 1px 0px 1px, rgb(0, 0, 0) 0px 1px 1px, rgb(0, 0, 0) 0px -1px 1px, rgb(0, 0, 0) -1px 0px 1px"};t.a=function(e){var t=Object(r.d)(),i=Object(r.e)(function(e){return{roomHistoryList:e.live.roomHistoryList,room:e.live.room}},r.c),n=i.room,p=i.roomHistoryList,b=Object(o.useState)({d:0,h:0,m:0,s:0}),g=c()(b,2),h=g[0],E=g[1],N=e.elementID,x=Object(o.useCallback)(function(){var e=(new Date).getTime(),t=Number(n.beginTime)-e,a={d:0,h:0,m:0,s:0};t>=0&&(a.d=Math.floor(t/1e3/60/60/24),a.h=Math.floor(t/1e3/60/60%24),a.m=Math.floor(t/1e3/60%60),a.s=Math.floor(t/1e3%60)),E(a),0===n.status&&setTimeout(x,1e3)},[]),y=Object(o.useState)(!1),O=c()(y,2),j=O[0],I=O[1],k=Object(o.useState)(null),_=c()(k,2),S=_[0],w=_[1];Object(o.useEffect)(function(){S&&!j&&(document.querySelector(".xgplayer-icon-large").removeAttribute("style"),document.querySelector(".xgplayer-icon-muted").removeAttribute("style"),S.video.muted=!1)},[j]);var L=Object(o.useCallback)(function(e,t){if(e){var i={id:N,url:e,poster:n.coverPicUrl,width:"id_test_video"===N?"100%":884,height:"id_test_video"===N?"100%":500,pip:!1,screenShot:!1,autoplay:!0,lang:"zh-cn",playsinline:!0,ignores:["volume"]},c={id:N,url:e,poster:n.coverPicUrl,rotate:{innerRotate:!0,clockwise:!1},pip:!0,pipConfig:{bottom:200,right:0,width:320,height:180},screenShot:!0,autoplay:!0,width:"id_test_video"===N?"100%":884,height:"id_test_video"===N?"100%":500,lang:"zh-cn",playsinline:!0,controls:!0,danmu:{comments:[],area:{start:.02,end:1.02}}};if("playback"===t&&Object(u.u)()){c=l()({},c,{playbackRate:[.5,.75,1,1.5,2],defaultPlaybackRate:1});var o=[],r=!0,s=!1,m=void 0;try{for(var d,v=p[Symbol.iterator]();!(r=(d=v.next()).done);r=!0){var b=d.value;o.push({mode:"scroll",duration:1e4,id:b.id,start:b.updateTime-n.beginTime,txt:b.content,style:f})}}catch(e){s=!0,m=e}finally{try{r||null==v.return||v.return()}finally{if(s)throw m}}c.danmu.comments=o}else"playback"!==t||Object(u.u)()?c.controls=!1:(c=i,1===n.roomType?(c.height=211,c.cssFullscreen=!0):c.height=310);var g=null;if("flv"===Object(u.j)(e)){a(1103),c=l()({},c,{url:c.url.replace(".flv",".m3u8")});var h=a(1163);g=new h(c)}else if("m3u8"===Object(u.j)(e)){a(1103);var E=a(1163);g=new E(c)}else{var x=a(1103);a(1407),g=new x(c)}Object(u.o)(function(e){e?console.log("HTML5 Video Autoplay Supported!"):(console.log("HTML5 Video Autoplay Not Supported :("),g.once("canplay",function(){document.querySelector(".xgplayer-icon-large").setAttribute("style","display:none"),document.querySelector(".xgplayer-icon-muted").setAttribute("style","display:block"),g.video.muted=!0,g.play(),I(!0)}))}),w(g),window.livePlayer=g}},[]),T=Object(d.a)();Object(o.useEffect)(function(){S&&(console.log(1111),S.on("play",function(){T({eventId:"playback_control",eventInfo:{action:"play"}})}),S.on("pause",function(){T({eventId:"playback_control",eventInfo:{action:"pause"}})}),S.on("requestFullscreen",function(){T({eventId:"playback_control",eventInfo:{action:"fullscreen"}})}),S.on("exitFullscreen",function(){T({eventId:"playback_control",eventInfo:{action:"exit_fullscreen"}})}))},[S]);var C=Object(o.useCallback)(function(e){var t="";switch(e.status){case 0:t="not_started";break;case 1:t="living";break;case 2:t="finished";break;default:t="not_started"}return t},[]);Object(o.useEffect)(function(){n&&(window.onbeforeunload=function(){T({eventId:"exit_room",eventInfo:{state:C(n)}})})},[n]);var M=Object(o.useState)(),R=c()(M,2),D=R[0],A=R[1];return Object(o.useEffect)(function(){!n||0!==n.status&&1!==n.status||n.status!==D&&(A(n.status),T({eventId:"enter_room",eventInfo:{state:C(n)}}))},[n]),Object(o.useEffect)(function(){if(n)switch(n.status){case 0:x();break;case 1:var e=n.webPullStreamUrl?n.webPullStreamUrl:n.pullStreamUrl;if(!e)return void m.a.info("未获取到视频直播地址，请刷新试试");null===S&&(e.indexOf("?txSecret=")>-1&&(e=e.split("?txSecret=")[0]),-1===e.indexOf("https://")&&(e=e.replace("http://","https://")),L(e,"playing"));break;case 2:T({eventId:"enter_playback"});var t=n.recordVideoUrl;if(!t)return;null!==S&&(S.destroy(!0),w(null)),-1===t.indexOf("https://")&&(t=t.replace("http://","https://")),L(t,"playback");break;default:setTimeout(function(){m.a.info("直播间不存在或已删除")},500)}},[n]),Object(o.useEffect)(function(){var e=setInterval(function(){1===n.status&&t(Object(s.i)({roomIDs:n.roomId}))},5e3);return function(){clearInterval(e)}},[t.live,n]),Object(o.useEffect)(function(){console.log(666);var e=setInterval(function(){0===n.status||2===n.status&&!n.recordVideoUrl?t(Object(s.d)({roomId:n.roomId})):clearInterval(e)},3e3);return function(){clearInterval(e)}},[t.live,n]),Object(o.useEffect)(function(){!Object(u.u)()&&S&&(document.body.onclick=function(){S.play()})},[S]),{player:S,countTime:h,timeZero:v,setMutedBtnShow:I,mutedBtnShow:j}}},1192:function(e,t,a){"use strict";var i=a(2),l=a.n(i),n=a(4),c=a.n(n),o=a(22),r=a.n(o),s=a(0),m=a(65),u=a.n(m),d=a(1193),v=a.n(d);t.a=function(){var e=Object(s.useState)(null),t=r()(e,2),i=t[0],n=t[1],o=Object(s.useState)(!1),m=r()(o,2),d=m[0],f=m[1],p=Object(s.useState)(!1),b=r()(p,2),g=b[0],h=b[1],E=Object(s.useState)(!1),N=r()(E,2),x=N[0],y=N[1];return{imReady:d,imLogin:g,imJoin:x,createIM:Object(s.useCallback)(function(e){var t=a(1166),i=t.createIM({SDKAppID:1400383128});i.on(t.EVENT.IM_READY,function(e){f(!0)}),i.on(t.EVENT.IM_NOT_READY,function(e){console.log("用户被NotReady触发"),f(!1)}),i.on(t.EVENT.IM_REMOTE_USER_JOIN,function(e){e.data.forEach(function(e){console.log((e.nick||e.payload.userIDList[0])+" 来了")})}),i.on(t.EVENT.IM_REMOTE_USER_LEAVE,function(e){e.data.forEach(function(e){console.log((e.nick||e.payload.userIDList[0])+" 走了")})}),i.on(t.EVENT.IM_KICKED_OUT,function(e){console.log("用户被踢下线时触发"),console.log(e.data.type)}),i.on(t.EVENT.IM_NET_STATE_CHANGED,function(e){console.log("网络状态发生改变"),console.log(e.data.state)}),i.on(t.EVENT.IM_PUSH_STOPPED,function(e){console.log("主播停止推流时触发"),console.log("postscript: ",e.data)}),i._tim.on(v.a.EVENT.MESSAGE_RECEIVED,function(t){console.log("custom message received",t.data),t.data.forEach(function(e){console.log((e.from||e.nick)+" : ",e.payload.text)}),e(t)}),n(i)},[]),getImLogin:Object(s.useCallback)(function(){var e=c()(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u()({url:"/imusersig/".concat(t)});case 2:a=e.sent,i.login({userID:t,userSig:a.data.data}).then(function(e){console.log("im.login"),console.log("登录成功"),console.log(e),h(!0)}).catch(function(e){console.log("登录失败"),console.warn("im | login | failed",e),h(!1)});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),[i]),joinImRoom:Object(s.useCallback)(function(e){var t=a(1166);i.enterRoom&&i.enterRoom(e).then(function(e){switch(console.log(e.data),e.data.status){case t.TYPES.ENTER_ROOM_SUCCESS:console.log("成功加入直播间"),y(!0);break;case t.TYPES.ALREADY_IN_ROOM:console.log("已经在直播间里"),y(!0);break;default:y(!1)}}).catch(function(e){console.warn("im | enterRoom | failed",e),y(!1)})},[i]),setImLogin:h,setImJoin:y,im:i}}},1482:function(e,t,a){},1483:function(e,t,a){},1484:function(e,t,a){},1485:function(e,t,a){e.exports=a.p+"live_detail_type_2-8a275757.gif"},1486:function(e,t,a){e.exports=a.p+"live_detail_pop-e84b1852.png"},1487:function(e,t,a){e.exports=a.p+"live-tip-warning-63dcc696.png"},1488:function(e,t,a){},1489:function(e,t,a){e.exports=a.p+"live-tip-clear-f707987a.png"},1490:function(e,t,a){e.exports=a.p+"live-tip-close-77eb6637.png"},1491:function(e,t,a){e.exports=a.p+"live-tip-cross-e684198f.png"},1492:function(e,t,a){},1493:function(e,t,a){},1494:function(e,t,a){},1495:function(e,t,a){},1501:function(e,t,a){},1505:function(e,t,a){e.exports=a.p+"live_chat_nolive-79dc86f9.png"},1506:function(e,t,a){},1508:function(e,t,a){},1509:function(e,t,a){e.exports=a.p+"live-join-phone-1baef09e.png"},1510:function(e,t,a){e.exports=a.p+"live-join-wx-368c013c.png"},293:function(e,t,a){"use strict";a.r(t);var i=a(0),l=a.n(i),n=(a(1482),a(49)),c=a.n(n),o=a(22),r=a.n(o),s=a(27),m=(a(1483),a(1)),u=(a(1484),a(1101)),d=a(1485),v=a.n(d),f=a(1486),p=a.n(f),b=a(1487),g=a.n(b),h=function(e){var t=e.status,a=e.name,i=e.type2,n=e.beginTime,c=e.presenterList,o=e.popularity,r=e.pop,s=e.onBtnGetTipAddClick,d=r.popularity?r.popularity:o&&0!==o?o:0,f=d;return d>1e6?f="99.9万+":d>1e4&&(f="".concat((d/1e4).toFixed(1),"万")),l.a.createElement("div",{className:"im-live-detail-left-live-video-header"},l.a.createElement(u.c,{className:"im-live-detail-left-live-video-header-img",authorInfo:c[0]}),l.a.createElement("div",{className:"im-live-detail-left-live-video-header-info"},l.a.createElement("div",{className:"im-live-detail-left-live-video-header-top-box"},l.a.createElement("div",{className:"im-live-detail-left-live-video-header-top-left"},void 0!==t&&0===t&&l.a.createElement("div",{className:"im-live-detail-left-live-video-header-icon im-live-detail-left-live-video-header-type1"},"即将开始"),void 0!==t&&1===t&&l.a.createElement("div",{className:"im-live-detail-left-live-video-header-icon im-live-detail-left-live-video-header-type2"},l.a.createElement("img",{src:v.a,style:{height:"16px",marginRight:"4px"}}),"直播中"),void 0!==t&&2===t&&l.a.createElement("div",{className:"im-live-detail-left-live-video-header-icon im-live-detail-left-live-video-header-type3"},"回放中"),a&&""!==a&&l.a.createElement("div",{className:"im-live-detail-left-live-video-header-title",title:a},a),i&&""!==i&&l.a.createElement("div",{className:"im-live-detail-left-live-video-header-title-sp"},i)),l.a.createElement("div",{className:"im-live-detail-left-live-video-header-top-text"},l.a.createElement("img",{className:"im-live-detail-left-live-video-header-top-text-icon",src:p.a}),"观看人次：".concat(f))),l.a.createElement("div",{className:"im-live-detail-left-live-video-header-bottom-box"},l.a.createElement("div",{className:"im-live-detail-left-live-video-header-bottom-left"},a&&""!==a&&l.a.createElement("div",{className:"im-live-detail-left-live-video-header-bottom-text"},"主播：".concat(c&&c.length>0&&""!==c[0].nickName?c[0].nickName:"")),n&&""!==n&&l.a.createElement("div",{className:"im-live-detail-left-live-video-header-bottom-text"},"直播时间：".concat(Object(m.l)(n,"yyyy-MM-dd hh:mm")))),l.a.createElement("div",{className:"im-live-detail-left-live-video-header-bottom-right",onClick:function(){return s()}},l.a.createElement("img",{className:"im-live-detail-left-live-video-header-bottom-right-icon",src:g.a}),"举报"))))},E=(a(1488),a(17)),N=a(19),x=a(1489),y=a.n(x),O=a(1490),j=a.n(O),I=a(1491),k=a.n(I),_=[{type:1,name:"违法违禁"},{type:2,name:"淫秽色情"},{type:3,name:"抽烟喝酒"},{type:4,name:"危险行为"},{type:5,name:"侮辱谩骂"},{type:6,name:"其他"}],S=function(e){var t=e.room,a=e.onBtnGetTipAddClick,n=Object(i.useState)(0),c=r()(n,2),o=c[0],s=c[1],u=Object(i.useState)(""),d=r()(u,2),v=d[0],f=d[1],p=Object(i.useState)(!1),b=r()(p,2),g=b[0],h=b[1],x=Object(i.useRef)(),O=Object(i.useRef)(),I=Object(i.useCallback)(function(e){var t=Object(m.J)(e.target.value);t.length<=100?O.current.innerText=t.length:e.target.value=t.substring(0,300)},[]),S=Object(i.useCallback)(function(e){s(e)},[]),w=function(e){for(var t=e.split(","),a=t[0].match(/:(.*?);/)[1],i=atob(t[1]),l=i.length,n=new Uint8Array(l);l--;)n[l]=i.charCodeAt(l);return new Blob([n],{type:a})},L=Object(i.useCallback)(function(e){var t=e.target.files[0];if(window.FileReader){var a=new FileReader;a.readAsDataURL(t),a.onloadend=function(e){f(e.target.result),h(!0),Object(N.m)({uploadFile:w(e.target.result),type:"news",data:"",watermark:0}).then(function(e){1===e.code&&f(e.obj),h(!1)}).catch(function(e){throw console.log("上传图片失败"),h(!1),e})}}},[]),T=Object(i.useCallback)(function(){f("")},[]),C=Object(i.useCallback)(function(){if(!0!==g)if(0!==o){var e=t.presenterList&&t.presenterList.length>0?t.presenterList[0].passportId:"";if(""!==e){var i=Object(m.J)(x.current.value),l={roomId:t.roomId,passportId:e,type:o,reason:i,imgUrl:v};Object(N.a)(l).then(function(e){1===e.code&&(E.a.info("举报成功"),setTimeout(function(){a()},1e3))}).catch(function(e){throw E.a.info("举报失败"),e})}}else E.a.info("请选择举报类型")},[g,o,a]),M=Object(i.useCallback)(function(){a()},[a]);return l.a.createElement("div",{className:"im-live-tip-box"},l.a.createElement("div",{className:"im-live-tip-box-bg"}),l.a.createElement("div",{className:"im-live-tip-box-popup"},l.a.createElement("div",{className:"im-live-tip-box-top"},l.a.createElement("div",{className:"im-live-tip-box-title"},"举报理由"),l.a.createElement("div",{className:"im-live-tip-box-clear",onClick:function(){return M()}},l.a.createElement("img",{className:"im-live-tip-box-clear-img",src:y.a}))),l.a.createElement("div",{className:"im-live-tip-box-type-list"},_.map(function(e,t){return l.a.createElement("div",{className:"im-live-tip-box-type-item ".concat(e.type===o?"im-live-tip-box-type-item-active":""),key:t,onClick:function(){return S(e.type)}},e.name)})),l.a.createElement("div",{className:"im-live-tip-box-reason"},l.a.createElement("textarea",{className:"im-live-tip-box-reason-input",placeholder:"（必填）填写举报理由与上传截图，可让快速处理相关问题",ref:x,onChange:I}),l.a.createElement("div",{className:"im-live-tip-box-reason-input-sp"},l.a.createElement("em",{ref:O},"0"),"/300")),l.a.createElement("div",{className:"im-live-tip-box-update"},l.a.createElement("div",{className:"im-live-tip-box-update-img-bg"},l.a.createElement("img",{className:"im-live-tip-box-update-img-cross ".concat(""!==v?"im-live-tip-box-update-img-text":""),src:""!==v?v:k.a}),l.a.createElement("input",{className:"im-live-tip-box-update-img-inputfile",onChange:function(e){return L(e)},name:"file",id:"file",type:"file",accept:".jpg,.jpeg,.png"}),""!==v?l.a.createElement("img",{className:"im-live-tip-box-update-img-close",onClick:function(){return T()},src:j.a}):null),l.a.createElement("div",{className:"im-live-tip-box-update-text"},"（必填）图片大小不超过4M")),l.a.createElement("div",{className:"im-live-tip-box-btn",onClick:function(){return C()}},"提交")))},w=a(1188),L=function(){var e=Object(s.e)(function(e){return{room:e.live.room,popularityList:e.live.popularityList}},s.c),t=e.room,a=e.popularityList,n=Object(w.a)({elementID:"im-live-detail-left-live-video"}),o=n.player,u=n.countTime,d=n.timeZero,v=n.setMutedBtnShow,f=n.mutedBtnShow,p=Object(i.useState)(0),b=r()(p,2),g=b[0],E=b[1],N=Object(i.useState)(!1),x=r()(N,2),y=x[0],O=x[1];Object(i.useEffect)(function(){if((2===t.status||1===t.status)&&o){var e=document.getElementById("im-live-detail-left-live-video"),a=Object(m.O)(function(t){"down"===t&&0===g&&Object(m.G)().top>600&&(o.getPIP(),E(1),e.style.zIndex=1e3),"up"===t&&1===g&&Object(m.G)().top<600&&(o.exitPIP(),E(0),e.style.zIndex=0)});return function(){window.removeEventListener("scroll",a,!1)}}},[t,o,g]);var j=Object(i.useCallback)(function(){O(!y)},[y]);return l.a.createElement("div",{className:"im-live-detail-left-live-video"},l.a.createElement(h,c()({},t,{pop:a&&Object(m.n)(a)&&a.length>0?a[0]:0,onBtnGetTipAddClick:j})),l.a.createElement("div",{className:"im-live-detail-left-live-video-wrapper"},0===t.status||2===t.status&&!t.recordVideoUrl?l.a.createElement("img",{className:"im-live-detail-left-live-video-bg",src:t.coverPicUrl}):null,l.a.createElement("div",{className:"im-live-detail-video-wrapper"},l.a.createElement("div",{id:"im-live-detail-left-live-video",style:{width:"100%",height:"100%",zIndex:0}}),l.a.createElement("div",{className:"click-cancel-muted",style:{display:f?"block":"none"},onClick:function(){o&&v(!1)}},l.a.createElement("button",null,"点击取消静音"))),0===t.status?l.a.createElement("div",{className:"im-live-detail-left-live-video-footer"},0===u.d&&0===u.h&&0===u.m&&0===u.s?l.a.createElement("div",{className:"im-live-detail-left-live-video-footer-text1"},"主播马上就到，敬请期待"):l.a.createElement("div",{className:"im-live-detail-left-live-video-footer-text1"},"距开播预计还剩"),0===u.d&&0===u.h&&0===u.m&&0===u.s?null:l.a.createElement("div",{className:"im-live-detail-left-live-video-footer-text2"},d(u.d),l.a.createElement("span",{className:"im-live-detail-left-live-video-footer-text1"},"天"),d(u.h),l.a.createElement("span",{className:"im-live-detail-left-live-video-footer-text1"},"时"),d(u.m),l.a.createElement("span",{className:"im-live-detail-left-live-video-footer-text1"},"分"),d(u.s),l.a.createElement("span",{className:"im-live-detail-left-live-video-footer-text1"},"秒"))):null,2!==t.status||t.recordVideoUrl?null:l.a.createElement("div",{className:"im-live-detail-left-live-video-footer"},l.a.createElement("div",{className:"im-live-detail-left-live-video-footer-text1"},"直播已结束，回放制作中，敬请期待"))),!0===y?l.a.createElement(S,{room:t,onBtnGetTipAddClick:j}):null)},T=(a(1492),function(){var e=Object(s.e)(function(e){return{liveDetailImgData:e.home.liveDetailImgData}},s.c).liveDetailImgData;return l.a.createElement("div",{className:"im-live-detail-left-live-ad"},l.a.createElement("a",{className:"im-live-list-right-join-box",href:e.length>0?e[0].url:"",target:"_blank"},l.a.createElement("img",{className:"im-live-detail-left-live-ad-img",src:e.length>0?e[0].pcImgSrc:""})))}),C=a(23),M=(a(1493),a(1494),function(e){var t=e.brief;return l.a.createElement("div",{className:"im-live-detail-left-live-info"},l.a.createElement("div",{className:"ql-container ql-snow"},l.a.createElement("div",{className:"ql-editor",dangerouslySetInnerHTML:{__html:t}})))}),R=a(1164),D="info",A="recommend",U=function(){var e=Object(C.c)().t,t=Object(s.e)(function(e){return{brief:e.live.room.brief,roomLiveRecommendList:e.live.roomLiveRecommendList.inforList}},s.c),a=t.brief,n=t.roomLiveRecommendList,c=Object(i.useState)(D),o=r()(c,2),m=o[0],u=o[1],d=function(e){u(e)};return l.a.createElement("div",{className:"im-live-detail-left-live-bottom-box"},l.a.createElement("div",{className:"im-live-detail-left-live-bottom-box-header"},l.a.createElement("div",{className:"im-live-detail-left-live-bottom-box-header-item",onClick:function(){return d(D)}},l.a.createElement("div",{className:"im-live-detail-left-live-bottom-box-header-text ".concat(m===D?"im-live-detail-left-live-bottom-box-header-select":"")},e("live_brief")),m===D&&l.a.createElement("div",{className:"im-live-detail-left-live-bottom-box-header-line"})),l.a.createElement("div",{className:"im-live-detail-left-live-bottom-box-header-item",onClick:function(){return d(A)}},l.a.createElement("div",{className:"im-live-detail-left-live-bottom-box-header-text ".concat(m===A?"im-live-detail-left-live-bottom-box-header-select":"")},e("live_tj_strem")),m===A&&l.a.createElement("div",{className:"im-live-detail-left-live-bottom-box-header-line"}))),l.a.createElement("div",{className:"im-live-detail-left-live-bottom-box-wrapper"},m===D&&l.a.createElement(M,{brief:a}),m===A&&l.a.createElement(R.a,{listData:n})))},V=a(1111),J=a(2),P=a.n(J),H=a(4),B=a.n(H),F=a(111),G=a.n(F),q=(a(1495),a(16)),K=a(1496),z=a.n(K),Y=(a(1501),function(e){var t=e.type,a=e.nick,i=e.text,n=void 0!==t?99===t?"im-live-detail-right-chart-item-sys":98===t?"im-live-detail-right-chart-item-name":"":"";return l.a.createElement("div",{className:"im-live-detail-right-chart-item"},void 0!==t&&1===t&&l.a.createElement("span",{className:"im-live-detail-right-chart-item-sp im-live-detail-right-chart-item-icon1"},"主播"),void 0!==t&&2===t&&l.a.createElement("span",{className:"im-live-detail-right-chart-item-sp im-live-detail-right-chart-item-icon2"},"嘉宾"),void 0!==a&&l.a.createElement("span",{className:"im-live-detail-right-chart-item-name"},"".concat(a,"：")),void 0!==i?l.a.createElement("span",{className:"im-live-chart-item ".concat(n),dangerouslySetInnerHTML:{__html:z()({input:i,options:{attributes:{target:"_blank"}}})}}):"")}),Z=a(1165),$=a(1192),Q=a(1505),W=a.n(Q),X=a(1102),ee=function(){var e=Object(X.a)(),t=Object(C.c)().t,a=Object(s.e)(function(e){return{room:e.live.room,roomHistoryList:e.live.roomHistoryList,userInfo:e.login.userInfo.info}},s.c),n=a.room,o=a.userInfo,u=a.roomHistoryList,d=Object(s.d)(),v=Object(i.useState)([]),f=r()(v,2),p=f[0],b=f[1],g=Object(i.useState)(0),h=r()(g,2),x=h[0],y=h[1],O=Object(i.useRef)(),j=Object(i.useRef)(),I=Object(i.useRef)(),k=Object(i.useRef)(),_=Object(i.useRef)(),S=function(e){e&&e.data&&Object(m.n)(e.data)&&e.data.map(function(e){if(e.type)switch(e.type){case"TIMCustomElem":if(!e.payload||!e.payload.data)return;if("CustomTextMsg"===JSON.parse(e.payload.data).cmd){if(!e._elements||!Object(m.n)(e._elements))return;var t={type:0};e._elements.map(function(e){if("TIMCustomElem"===e.type){var a=JSON.parse(e.content.data).data;t.nick=a.nickName,t.msgId=a.msgId,(n.presenterList?n.presenterList:[]).map(function(e){a.passportId===e.passportId&&(t.type=1)}),(n.guestList?n.guestList:[]).map(function(e){a.passportId===e.passportId&&(t.type=2)})}else"TIMTextElem"===e.type?t.text=e.content.text:(console.log("===================================="),console.log("新的类型参数：".concat(e)),console.log("===================================="))}),J(t)}break;case"TIMGroupSystemNoticeElem":if(!e.payload)return;if(e.payload.userDefinedField&&""!==e.payload.userDefinedField){var a=JSON.parse(e.payload.userDefinedField),i=a.cmd;"delMsgHx"===i&&a.data&&a.data.msgId&&H(a.data.msgId),"forbidMsgHx"===i&&a.data&&a.data.passportId&&a.data.content&&o.passportId&&o.passportId===a.data.passportId&&J({type:99,text:a.data.content})}else e.payload.operationType&&5===e.payload.operationType&&(d(Object(N.d)({roomId:n.roomId})),R(!1))}})},w=Object($.a)(),L=w.createIM,T=w.getImLogin,M=w.joinImRoom,R=w.setImJoin,D=w.im,A=w.imReady,U=w.imLogin,V=w.imJoin;Object(i.useEffect)(function(){switch(n.status?n.status:0){case 0:y(1);break;case 1:y(0);break;case 2:y(1)}},[n]),Object(i.useEffect)(function(){0!==n.status&&u&&Object(m.n)(u)&&u.length>0&&(b([]),u.map(function(e){var t={nick:e.nickName,text:e.content,type:0};(n.presenterList?n.presenterList:[]).map(function(a){e.passportId===a.passportId&&(t.type=1)}),(n.guestList?n.guestList:[]).map(function(a){e.passportId===a.passportId&&(t.type=2)}),J(t)}),setTimeout(function(){I.current.scrollIntoView(!1)},500))},[n,u]),Object(i.useEffect)(function(){1===n.status&&L(S)},[n.status]),Object(i.useEffect)(function(){if(D){var e=o.passportId?o.passportId:G()(Object(m.K)()).substring(7,23);T(e)}},[D,o]),Object(i.useEffect)(function(){return k.current&&(clearInterval(k.current),k.current=null),A&&(U||1!==n.status?(clearInterval(k.current),k.current=null,M(n.roomId)):k.current=setInterval(function(){var e=o.passportId?o.passportId:G()(Object(m.K)()).substring(7,23);T(e)},1e4)),function(){clearInterval(k.current)}},[A,U,o,n.status]),Object(i.useEffect)(function(){return _.current&&(clearInterval(_.current),_.current=null),V||1!==n.status?(clearInterval(_.current),_.current=null):_.current=setInterval(function(){M(n.roomId)},1e4),function(){clearInterval(_.current),_.current=null}},[n.status,V]),Object(i.useEffect)(function(){!0===A&&!0===U&&!0===V&&(J({type:98,text:"欢迎来到MarsBit直播间！直播间内严禁出现违法违规、低俗色情、吸烟酗酒等内容，若有违规行为请及时举报"}),setTimeout(function(){I.current.scrollIntoView(!1)},500))},[A,U,V]);var J=Object(i.useCallback)(function(e){var t=p;t.push(e),645===Object(m.g)(I.current).bottom?(b(JSON.parse(JSON.stringify(t))),I.current.scrollIntoView(!1)):b(JSON.parse(JSON.stringify(t)))},[]),H=Object(i.useCallback)(function(e){for(var t=p,a=0;a<t.length;a++)if(t[a].msgId&&t[a].msgId===e){t.splice(a,1);break}645===Object(m.g)(I.current).bottom?(b(JSON.parse(JSON.stringify(t))),I.current.scrollIntoView(!1)):b(JSON.parse(JSON.stringify(t)))},[]),F=Object(i.useCallback)(function(e){var t=Object(m.J)(e.target.value);t.length<=100?O.current.innerText=t.length:e.target.value=t.substring(0,100)},[]),K=Object(i.useCallback)(B()(P.a.mark(function t(){var a,i,l,c;return P.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(V&&1!==x){t.next=2;break}return t.abrupt("return");case 2:if(o.passportId){t.next=5;break}return d(Object(q.i)("account",!0)),t.abrupt("return");case 5:if(o.nickName&&""!==o.nickName){t.next=9;break}return t.abrupt("return");case 9:if(a=/^[0-9a-zA-Z]*$/,2!==(i=o.nickName.split("MarsBit")).length||""!==i[0]||!a.test(i[1])){t.next=14;break}return d(Object(q.j)(!0)),t.abrupt("return");case 14:if(""!==(l=Object(m.J)(j.current.value))){t.next=17;break}return t.abrupt("return");case 17:return t.prev=17,y(1),t.next=21,Object(N.k)({roomId:n.roomId,passportId:o.passportId,nickName:o.nickName,content:l});case 21:(c=t.sent)&&1===c.code?(y(0),e({eventId:"send_msg"})):(E.a.info(c.msg?c.msg:"发送失败"),y(0)),j.current.value="",j.current.focus(),I.current.scrollIntoView(!1),t.next=32;break;case 28:t.prev=28,t.t0=t.catch(17),console.log("im | sendCustomMessage | failed",t.t0),y(0);case 32:case"end":return t.stop()}},t,null,[[17,28]])})),[V,x,o]),z=Object(i.useCallback)(function(){n&&2===n.status||d(Object(q.i)("account",!0))},[]);return l.a.createElement("div",{className:"im-live-detail-right-live-chat"},l.a.createElement(Z.a,{title:t("live_commincation")}),n&&void 0!==n.status&&0===n.status&&l.a.createElement("div",{className:"im-live-detail-right-live-chat-nolive"},l.a.createElement("img",{className:"im-live-detail-right-live-chat-nolive-icon",src:W.a}),t("live_not_start")),l.a.createElement("div",{className:"im-live-detail-right-live-chat-list"},l.a.createElement("div",{className:"im-live-detail-right-live-chat-list-box",id:"id_scroll",ref:I},p&&p.map(function(e,t){if(e.text)return l.a.createElement(Y,c()({},e,{key:t}))}))),l.a.createElement("div",{className:"im-live-detail-right-live-chat-input-box"},(!o.passportId||n&&void 0!==n.status&&1!==n.status)&&l.a.createElement("div",{className:"im-live-detail-right-live-chat-input ".concat(n&&void 0!==n.status&&2===n.status?"im-live-detail-right-live-chat-input-end":"im-live-detail-right-live-chat-input-noload"),onClick:z},n&&void 0!==n.status&&2===n.status?null:l.a.createElement("span",{className:"im-live-detail-right-live-chat-input-noload-sp"},"登录"),n&&void 0!==n.status&&2===n.status?t("live_finsh"):t("live_to_say")),o&&o.passportId&&n&&void 0!==n.status&&1===n.status&&l.a.createElement("textarea",{className:"im-live-detail-right-live-chat-input",ref:j,onChange:F,onKeyUp:function(e){e&&"keyup"===e.type&&13!==e.keyCode||K()},disabled:1===x||!V}),l.a.createElement("div",{className:"im-live-detail-right-live-chat-btn-box"},l.a.createElement("div",{className:"im-live-detail-right-live-btn-sp"},l.a.createElement("em",{ref:O},"0"),"/100"),l.a.createElement("div",{className:"im-live-detail-right-live-chat-btn ".concat(n&&void 0!==n.status&&2!==n.status&&0===x&&!0===V?"im-live-detail-right-live-chat-btn-ok":""),onClick:K},t("live_send")))))},te=(a(1506),a(1408)),ae=function(){var e=Object(s.e)(function(e){return{room:e.live.room}},s.c).room;return l.a.createElement("div",{className:"im-live-detail-right-live-presenter"},l.a.createElement(Z.a,{title:"主讲人"}),l.a.createElement("div",{className:"im-live-detail-right-live-presenter-box"},e.presenterList&&Object(m.n)(e.presenterList)&&e.presenterList.map(function(e,t){return l.a.createElement(te.a,c()({},e,{key:t}))}),e.guestList&&Object(m.n)(e.guestList)&&e.guestList.map(function(e,t){return l.a.createElement(te.a,c()({},e,{key:t}))})))},ie=(a(1508),a(1509)),le=a.n(ie),ne=a(1510),ce=a.n(ne),oe=function(){return l.a.createElement("div",{className:"im-live-detail-right-live-join"},l.a.createElement(Z.a,{title:"直播合作"}),l.a.createElement("div",{className:"im-live-detail-right-live-join-box"},l.a.createElement("div",{className:"im-live-detail-right-live-join-title"},"直播咨询"),l.a.createElement("div",{className:"im-live-detail-right-live-join-text-box"},l.a.createElement("img",{className:"im-live-detail-right-live-join-img",src:le.a}),l.a.createElement("div",{className:"im-live-detail-right-live-join-text"},"电话：18322606595")),l.a.createElement("div",{className:"im-live-detail-right-live-join-text-box"},l.a.createElement("img",{className:"im-live-detail-right-live-join-img",src:ce.a}),l.a.createElement("div",{className:"im-live-detail-right-live-join-text"},"微信：CRYPTO1996")),l.a.createElement("div",{className:"im-live-detail-right-live-join-title",style:{marginTop:"24px"}},"商务合作"),l.a.createElement("div",{className:"im-live-detail-right-live-join-text-box"},l.a.createElement("img",{className:"im-live-detail-right-live-join-img",src:le.a}),l.a.createElement("div",{className:"im-live-detail-right-live-join-text"},"电话：15555527736")),l.a.createElement("div",{className:"im-live-detail-right-live-join-text-box"},l.a.createElement("img",{className:"im-live-detail-right-live-join-img",src:ce.a}),l.a.createElement("div",{className:"im-live-detail-right-live-join-text"},"微信：15555527736"))))},re=a(1167);t.default=function(){Object(re.a)();var e=Object(X.a)();return Object(i.useEffect)(function(){e({eventId:"view_live_intro"})},[]),l.a.createElement("div",{className:"im-live-detail-page"},l.a.createElement("div",{className:"im-live-detail-page-main-box"},l.a.createElement("div",{className:"im-live-detail-page-main-box-left"},l.a.createElement(L,null),l.a.createElement(T,null),l.a.createElement(U,null)),l.a.createElement("div",{className:"im-live-detail-page-main-box-right"},l.a.createElement(ee,null),l.a.createElement(ae,null),l.a.createElement(oe,null),l.a.createElement(V.a,{isLive:!0}))))}}}]);
//# sourceMappingURL=containers-ImLiveDetail-4340ff1b.js.map