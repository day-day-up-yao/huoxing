(window.webpackJsonp=window.webpackJsonp||[]).push([[172],{1595:function(e,t,n){"use strict";n.r(t);n(675);var a=n(676),r=n.n(a),i=(n(1385),n(1386)),l=n.n(i),c=(n(247),n(183)),o=n.n(c),u=(n(184),n(1378)),s=n.n(u),p=(n(679),n(249)),d=n.n(p),m=(n(361),n(20)),f=n.n(m),h=(n(680),n(250)),y=n.n(h),g=(n(1376),n(1377)),b=n.n(g),w=(n(677),n(362)),v=n.n(w),E=n(0),C=n.n(E),S=n(246),k=(n(1835),n(51)),O=n.n(k),_=n(48),j=n(2);function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){P(e,t,n[t])})}return e}function P(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(e,t){return function(n){Object(_.i)("post","/crawler/unreadCount",I({},e),function(e){if(1===e.code){var a=e.obj;n(N({num:I({loaded:!0},a)})),t&&t(a)}else f.a.error(e.msg)})}},N=function(e){return{type:j.Cb.ADD_DATA,data:e}},M=function(e){return{type:j.Cb.SET_SEARCH_QUERY,data:e}},T=function(e){return{type:j.Cb.SET_FILTER_DATA,data:e}},x=function(e){return{type:j.Cb.SET_PAGE_DATA,data:e}},q=n(248),A=n(10);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){K(e,t,n[t])})}return e}function H(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var U=v.a.Option,F=b.a.confirm,G=[],Q=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=V(t).call(this,e),n=!r||"object"!==D(r)&&"function"!=typeof r?z(a):r,K(z(n),"contentRender",function(e,t){return"2"===t?C.a.createElement("div",null,C.a.createElement("h4",null,C.a.createElement(y.a,{overlayClassName:"twitter-tooltip",placement:"bottom",title:"".concat(Object(_.q)(e.brief,4e3)||"无内容")},C.a.createElement("span",null,"【",e.title?e.title:"无标题","】"),e.brief?C.a.createElement("span",{dangerouslySetInnerHTML:n.createMarkup(Object(_.q)(e.brief,400))}):"")),e.content_cn||e.title_cn?C.a.createElement("h4",{style:{padding:"5px 0"}},C.a.createElement("span",null,"翻译："),C.a.createElement(y.a,{overlayClassName:"twitter-tooltip",placement:"bottom",title:"".concat(Object(_.q)(e.brief_cn,3e3)||"无内容")},C.a.createElement("span",null,"【",e.title_cn?e.title_cn:"无标题","】"),e.brief_cn?C.a.createElement("span",{dangerouslySetInnerHTML:n.createMarkup(Object(_.q)(e.brief_cn,300))}):"")):"",e.read_time?C.a.createElement("h5",null,"已读时间：",Object(_.w)(e.read_time)," 管理员：",e.userName||"暂无"):""):C.a.createElement("div",null,C.a.createElement("h4",null,C.a.createElement(y.a,{overlayClassName:"twitter-tooltip",placement:"bottom",title:"".concat(Object(_.q)(e.content,4e3)||"无内容")},C.a.createElement("span",null,"【",e.title?e.title:"无标题","】"),e.content?C.a.createElement("span",{dangerouslySetInnerHTML:n.createMarkup(Object(_.q)(e.content,400))}):"")),e.content_cn||e.title_cn?C.a.createElement("h4",{style:{padding:"5px 0"}},C.a.createElement("span",null,"翻译："),C.a.createElement(y.a,{overlayClassName:"twitter-tooltip",placement:"bottom",title:"".concat(Object(_.q)(e.content_cn,3e3)||"无内容")},C.a.createElement("span",null,"【",e.title_cn?e.title_cn:"无标题","】"),e.content_cn?C.a.createElement("span",{dangerouslySetInnerHTML:n.createMarkup(Object(_.q)(e.content_cn,300))}):"")):"",e.read_time?C.a.createElement("h5",null,"已读时间：",Object(_.w)(e.read_time)," "):"")}),K(z(n),"handleChange",function(e){var t=n.props,a=t.dispatch,r=t.filter;a(T({type:e})),n.setState({type:e}),A.hashHistory.push("/socialMedia-twitter?page=1&filterCat=".concat(r.filterCat,"&type=").concat(e)),n.doSearch("init",{currentPage:1,type:e})}),K(z(n),"handleImpChange",function(e){var t=n.props,a=t.dispatch,r=t.filter;a(T({filterCat:e})),n.setState({filterCat:e}),A.hashHistory.push("/socialMedia-twitter?page=1&type=".concat(r.type,"&filterCat=").concat(e)),n.doSearch("init",{currentPage:1,filterCat:e})}),K(z(n),"readChange",function(e){(0,n.props.dispatch)(T({includeRead:e.target.checked})),n.doSearch("init",{currentPage:1,includeRead:e.target.checked})}),K(z(n),"unReadChange",function(e){(0,n.props.dispatch)(T({includeDupurl:e.target.checked})),n.doSearch("init",{currentPage:1,includeDupurl:e.target.checked})}),K(z(n),"getOrderNum",function(e){n.setState({order:e})}),K(z(n),"handleCancel",function(){return n.setState({previewVisible:!1})}),K(z(n),"handlePreview",function(e){n.setState({previewImage:e.target.getAttribute("src"),previewVisible:!0})}),K(z(n),"onSelectChange",function(e,t){var a=[];t.map(function(e,t){a.push(e.uuid)}),n.setState({selectedRowKeys:e,idArr:a})}),n.state={loading:!0,previewVisible:!1,previewImage:"",type:"2",position:"0",selectedRowKeys:[],order:1,recommendVisible:!1},n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(t,E["Component"]),n=t,(a=[{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.location;n(R({type:0})),n(T({type:a.query.type||"2",filterCat:a.query.filterCat||"0"})),this.doSearch("init"),G=[{title:C.a.createElement("h3",null,"ID"),key:"id",width:65,dataIndex:"id"},{title:C.a.createElement("h3",null,"来源"),key:"source",width:80,render:function(e,t){return-1!==t.url.indexOf("http")?C.a.createElement("a",{target:"_blank",title:t.source,href:t.url},t.source):C.a.createElement("span",{title:t.source},t.source)}},{title:C.a.createElement("h3",null,"内容"),className:"contentCell",key:"content",render:function(t){return C.a.createElement("div",{className:"".concat(t.isImportant&&"red")},e.contentRender(t,e.props.filter.type))}},{title:C.a.createElement("h3",null,"发布时间"),key:"strtime",align:"center",width:85,render:function(t){return C.a.createElement("p",{style:{textAlign:"center"},dangerouslySetInnerHTML:e.createMarkup(Object(_.w)(t.strtime,"-",!0))})}},{title:C.a.createElement("h3",null,"抓取时间"),key:"createTime",width:85,render:function(t){return C.a.createElement("p",{style:{textAlign:"center"},dangerouslySetInnerHTML:e.createMarkup(Object(_.w)(t.create_time,"-",!0))})}},{title:C.a.createElement("h3",null,"操作"),key:"action",align:"center",width:100,render:function(t){return C.a.createElement("div",{className:"btn"},t.read_time?C.a.createElement("p",null,C.a.createElement("a",{disabled:!0,className:"opt-btn",style:{background:"#858585"}},"已读")):C.a.createElement("p",null,C.a.createElement("a",{className:"opt-btn",onClick:function(){e.multiRead({item:t,type:"read"})},style:{background:"#1aaf35"}},"标记为已读")),C.a.createElement(y.a,{placement:"bottom",title:"功能暂未开放"},t.custom&&t.custom.unRelated?C.a.createElement("p",null,C.a.createElement("a",{disabled:!0,className:"opt-btn",style:{background:"#858585"}},"已标记不相关")):C.a.createElement("p",null,C.a.createElement("a",{disabled:!0,className:"opt-btn",onClick:function(){e.handleMark({item:t,type:"unrelated"})},style:{background:"#858585"}},"标记不相关"))),C.a.createElement("p",null,C.a.createElement("a",{onClick:function(){return 1===t.canImport?e.insertItem({item:t}):""},className:"opt-btn",href:"javascript:void(0)",style:{background:1===t.canImport?"#ff9b6e":"#afafaf"}},"导入")))}}]}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"channelName",value:function(e,t){var n="";return e.map(function(e,a){parseInt(e.value)===parseInt(t)&&(n=e.label)}),n}},{key:"insertItem",value:function(e){var t=this.props,n=t.filter,a=t.dispatch;if("2"===n.type)a(Object(q.h)(e)),localStorage.setItem("insertFlash",JSON.stringify(e)),window.open("http://".concat(window.location.host,"/#/flash-edit?from=twitter"));else if("1"===n.type)window.open("http://".concat(window.location.host,"/#/post-send?from=twitter&urls=")+encodeURIComponent(e.item.url)+"&newsid=".concat(e.item.id));else{if("5"!==n.type)return f.a.error("仅支持快讯和新闻的直接导入!"),!1;window.open("http://".concat(window.location.host,"/#/post-send?from=tactics&urls=")+encodeURIComponent(e.item.url)+"&newsid=".concat(e.item.id))}}},{key:"doSearch",value:function(e,t){var n=this,a=this.props,r=a.dispatch,i=a.filter,l=a.location,c=a.search;this.setState({loading:!0});var o=L({},c,i,{type:l.query.type||"2",filterCat:l.query.filterCat||"0",pageSize:20,currentPage:l.query.page||1});r(function(e,t,n){return function(e){Object(_.i)("get","/crawler/news",t?I({},t):{},function(t){if(1===t.code){var a=t.obj;e(N({list:a.inforList})),e(x({totalCount:a.recordCount,pageSize:a.pageSize,currentPage:a.currentPage})),n&&n(a)}else f.a.error(t.msg)})}}(0,o=L({},o,t),function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.props.dispatch;this.doSearch("init",{currentPage:1}),e(x({currentPage:1}))}},{key:"changePage",value:function(e){this.setState({loading:!0}),window.scrollTo(0,0);var t=this.props,n=t.dispatch,a=t.filter;A.hashHistory.push("/socialMedia-twitter?page=".concat(e,"&filterCat=").concat(a.filterCat,"&type=").concat(a.type)),n(x({currentPage:e})),this.doSearch("init",L({currentPage:e},a))}},{key:"handleMark",value:function(e){var t=this,n=this.props.dispatch;F({title:"提示",content:"确认要对这条信息进行标记吗 ?",onOk:function(){t.setState({loading:!0});var a={uuid:e.item.uuid,jsonString:JSON.stringify({unRelated:"unrelated"===e.type,passportId:O.a.get("hx_passportId"),operator:O.a.get("hx_nickName")}),passportId:O.a.get("hx_passportId"),type:t.props.filter.type};Object(_.i)("POST","/crawler/updateCustomJson",L({},a),function(e){t.setState({loading:!0}),1===e.code?(n(R({type:0})),f.a.success("操作成功"),t.doSearch("init")):f.a.error(e.msg)})}})}},{key:"multiRead",value:function(e){var t=this,n=this.props.dispatch,a={uuid:e.type&&"multi"===e.type?t.state.idArr.join(","):e.item.uuid,passportId:O.a.get("hx_passportId"),type:t.props.filter.type,userName:O.a.get("hx_nickName")};Object(_.i)("POST","/crawler/read",L({},a),function(e){t.setState({loading:!1}),1===e.code?(n(R({type:0})),f.a.success("操作成功"),t.setState({selectedRowKeys:[]}),t.doSearch("init")):f.a.error(e.msg)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,a=t.pageData,i=t.filter,c=t.num,u=t.location,p=t.dispatch,m=t.search,f=this.state.selectedRowKeys,h={selectedRowKeys:f,onChange:this.onSelectChange},y=f.length>1,g=[{label:"新闻",value:"1",num:c.news_clean||0},{label:"快讯",value:"2",num:c.lives_clean||0},{label:"社交媒体",value:"3",num:c.twinfo_clean||0},{label:"微博",value:"4",num:c.weibo_clean||0},{label:"策略",value:"5",num:c.mars_strategy_clean||0}];return C.a.createElement("div",{className:"twitter-index"},C.a.createElement("span",null,"类型筛选："),c.loaded&&C.a.createElement(v.a,{defaultValue:"".concat(u.query.type||"2"),style:{width:120,marginRight:10},onChange:this.handleChange},g.map(function(e){return C.a.createElement(U,{title:e.label,value:e.value,key:e.value},e.label,C.a.createElement("span",{style:{color:"red"}}," (",e.num,")"))})),C.a.createElement(v.a,{defaultValue:"".concat(u.query.filterCat||"0"),style:{width:80,marginRight:10},onChange:this.handleImpChange},C.a.createElement(U,{title:"未导入",value:"0"},"未导入"),C.a.createElement(U,{title:"算法导入",value:"1"},"算法导入"),C.a.createElement(U,{title:"人工导入",value:"2"},"人工导入"),C.a.createElement(U,{title:"全部",value:"3"},"全部"),C.a.createElement(U,{title:"重要",value:"4"},"重要"),C.a.createElement(U,{title:"不重要",value:"5"},"不重要")),C.a.createElement(d.a,{defaultChecked:i.includeRead,onChange:this.readChange},"包含已读"),C.a.createElement(d.a,{onChange:this.unReadChange},"包含重复"),C.a.createElement("span",null,"来源:"),C.a.createElement(s.a,{onPressEnter:function(){e._search()},value:m.sourceLike,style:{width:150,marginRight:10},onChange:function(e){return p(M({sourceLike:e.target.value}))},placeholder:"请输入要搜索的来源"}),C.a.createElement("span",null,"内容: "),C.a.createElement(s.a,{onPressEnter:function(){e._search()},value:m.contentLike,style:{width:150},onChange:function(e){return p(M({contentLike:e.target.value}))},placeholder:"请输入要搜索的内容"}),C.a.createElement(o.a,{type:"primary",disabled:!y,style:{margin:"0 15px"},onClick:function(){e.multiRead({type:"multi"})}},"批量已读"),C.a.createElement(o.a,{type:"primary",onClick:function(){e.doSearch("init")}},"刷新"),C.a.createElement("div",{className:"mt10"},C.a.createElement(r.a,{spinning:this.state.loading,size:"large"},C.a.createElement(l.a,{rowSelection:h,dataSource:n.map(function(e,t){return L({},e,{key:t})}),columns:G,bordered:!0,pagination:{current:parseInt(u.query.page)||parseInt(a.currentPage),total:a.totalCount,pageSize:a.pageSize,onChange:function(t){return e.changePage(t)}}}),C.a.createElement(b.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancel},C.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage})))))}}])&&H(n.prototype,a),i&&H(n,i),t}();t.default=Object(S.connect)(function(e){return{twitterInfo:e.twitterInfo,list:e.twitterInfo.list,search:e.twitterInfo.search,filter:e.twitterInfo.filter,pageData:e.twitterInfo.pageData,numArr:e.twitterInfo.numArr,num:e.twitterInfo.num}})(Q)},1835:function(e,t,n){var a=n(1836);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(186)(a,r);a.locals&&(e.exports=a.locals)},1836:function(e,t,n){(e.exports=n(185)(!1)).push([e.i,"",""])}}]);