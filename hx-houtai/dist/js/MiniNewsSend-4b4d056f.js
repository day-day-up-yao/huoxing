(window.webpackJsonp=window.webpackJsonp||[]).push([[120,32],{1488:function(e,t,a){"use strict";a.r(t),function(e){a(675);var n=a(676),i=a.n(n),r=(a(1381),a(1382)),o=a.n(r),s=(a(1383),a(1384)),l=a.n(s),c=(a(1376),a(1377)),u=a.n(c),p=(a(680),a(250)),m=a.n(p),d=(a(1394),a(1395)),f=a.n(d),g=(a(681),a(682)),h=a.n(g),b=(a(1392),a(1393)),v=a.n(b),y=(a(1396),a(1397)),S=a.n(y),w=(a(247),a(183)),I=a.n(w),j=(a(1388),a(1389)),L=a.n(j),E=(a(1387),a(50)),C=a.n(E),_=(a(361),a(20)),O=a.n(_),x=(a(678),a(363)),k=a.n(x),P=(a(184),a(1378)),N=a.n(P),V=(a(1379),a(1380)),A=a.n(V),M=a(0),T=a.n(M),F=a(246),D=a(10),q=a(1407),U=a.n(q),R=a(1650),H=a(1398),B=(a(1606),a(11)),z=a.n(B),Y=a(51),J=a.n(Y),G=a(1663),W=a(248),K=a(48);a(1662);function Q(e){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function X(e,t,a,n,i,r,o){try{var s=e[r](o),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Z(e){return function(){var t=this,a=arguments;return new Promise(function(n,i){var r=e.apply(t,a);function o(e){X(r,n,i,o,s,"next",e)}function s(e){X(r,n,i,o,s,"throw",e)}o(void 0)})}}function ee(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function te(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){oe(e,t,a[t])})}return e}function ae(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var se=A.a.Item,le=N.a.TextArea,ce=k.a.Group,ue=[{label:"原创",value:"1"},{label:"转载",value:"2"}],pe="",me=1,de=!1,fe=function(t){function a(t){var n,i,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i=this,r=ne(a).call(this,t),n=!r||"object"!==Q(r)&&"function"!=typeof r?ie(i):r,oe(ie(n),"enterIconLoading",function(){n.setState({iconLoading:!0})}),oe(ie(n),"insertState",function(e){e.map(function(e){n.state[e+"fileList"]=[],n.state[e+"Img"]=""})}),oe(ie(n),"routerWillLeave",function(){return"离开页面可能会导致编辑内容丢失, 是否确认离开?"}),oe(ie(n),"saveArticle",function(e){var t=n.props.form,a=null,i=te({},a=1===parseInt(n.state.subject)?{pc_subject:n.state.pcSubjectImg,m_subject:n.state.mSubjectImg,pc_hot_subject:n.state.pcHotSubjectImg,m_hot_subject:n.state.mHotSubjectImg}:{},{tags:n.state.tags.join(","),original:n.state.original,subject:n.state.subject,content:n.state.newsContent,audio:JSON.stringify(n.state.audioDefalutArr),video:n.state.videofileList[0]&&n.state.videofileList[0].fileUrl?JSON.stringify(n.state.videofileList):"[]",author:t.getFieldValue("author"),hotCounts:t.getFieldValue("hotCounts"),synopsis:t.getFieldValue("synopsis"),title:t.getFieldValue("title"),source:t.getFieldValue("source"),advertised:t.getFieldValue("advertised"),subTitle:t.getFieldValue("subTitle"),keyTags:t.getFieldValue("keyTags"),originalUrl:t.getFieldValue("originalUrl"),originalTitle:t.getFieldValue("originalTitle"),cateId:n.state.cateId,channelId:n.state.channelId,coverPic:JSON.stringify(te({pc_recommend:n.state.pcImg,pc:n.state.Img,wap_small:n.state.mImg,wap_big:n.state.mcImg,video_pc:n.state.videoPcImg,video_m:n.state.videoMImg},a))});localStorage.setItem("articleData",JSON.stringify(i)),e&&e(i)}),oe(ie(n),"fileList",function(e,t){return e[t]&&""!==e[t]?[{uid:0,name:"xxx.png",status:"done",url:e[t]}]:[]}),oe(ie(n),"renderData",function(e){var t=e.content.replace(/<style(.+)<\/style>/,"");n.state.editor.setValue(t);var a=Object(K.G)(e.coverPic)?JSON.parse(e.coverPic):{pc_recommend:"",pc:"",wap_big:"",wap_small:"",video_pc:"",video_m:"",pc_subject:"",m_subject:"",m_hot_subject:"",pc_hot_subject:""},i=n.fileList(a,"pc_recommend"),r=n.fileList(a,"pc_subject"),o=n.fileList(a,"m_subject"),s=n.fileList(a,"m_hot_subject"),l=n.fileList(a,"pc_hot_subject"),c=n.fileList(a,"video_pc"),u=n.fileList(a,"video_m"),p=n.fileList(a,"pc"),m=n.fileList(a,"wap_small"),d=n.fileList(a,"wap_big");n.setState({updateOrNot:!0,videoPcfileList:c,videoMfileList:u,fileList:p,pcfileList:i,mfileList:m,mcfileList:d,pcSubjectfileList:r,mSubjectfileList:o,pcHotSubjectfileList:l,mHotSubjectfileList:s,audioDefalutArr:Object(K.G)(e.audio)?JSON.parse(e.audio):[],videofileList:Object(K.G)(e.video)?JSON.parse(e.video):[],tags:e.tags?e.tags.split(","):[],newsContent:t,Img:a.pc,allImg:a.all,pcImg:a.pc_recommend||"",mImg:a.wap_small,mcImg:a.wap_big,pcSubjectImg:a.pc_subject,mSubjectImg:a.m_subject,pcHotSubjectImg:a.pc_hot_subject,mHotSubjectImg:a.m_hot_subject,videoMImg:a.video_m,videoPcImg:a.video_pc,mp3Url:e.audio||"",videoUrl:e.video||"",loading:!1,original:e.original||0,advertised:e.advertised||0,subject:e.subject||0,cateId:e.cateId})}),oe(ie(n),"channelIdChange",function(e){n.setState({channelId:e.target.value})}),oe(ie(n),"cateIdChange",function(e){var t=n.props.form;"1"===e.target.value?t.setFieldsValue({source:"MarsBit"}):t.setFieldsValue({source:""}),n.setState({cateId:e.target.value})}),oe(ie(n),"handleClose",function(e){var t=n.state.tags.filter(function(t){return t!==e});n.setState({tags:t})}),oe(ie(n),"showInput",function(){n.setState({inputVisible:!0},function(){return n.input.focus()})}),oe(ie(n),"handleInputChange",function(e){n.setState({inputValue:e.target.value})}),oe(ie(n),"handleInputConfirm",function(){var e=n.state,t=e.inputValue,a=e.tags;t&&-1===a.indexOf(t)&&(a=[].concat(ee(a),[t.slice(0,8)])),n.setState({tags:a,inputVisible:!1,inputValue:""})}),oe(ie(n),"saveInputRef",function(e){n.input=e}),oe(ie(n),"handleCancel",function(){return n.setState({previewVisible:!1})}),oe(ie(n),"handlePreview",function(e){if(e.hasOwnProperty("target")){var t=e.target.getAttribute("data-type");""!==n.state[t]?n.setState({previewImage:n.state[t],previewVisible:!0}):O.a.info("请先上传图片")}else n.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})}),oe(ie(n),"file",function(e){return new Promise(function(t){var a=new FileReader,n=new Image;a.readAsDataURL(e),a.onload=function(e){var t=e.target.result;n.src=t},t(n)})}),oe(ie(n),"image",function(e){return new Promise(function(t){e.onload=function(){var a=e.width,n=e.height;t(a<=800&&n<=800)}})}),oe(ie(n),"beforeUpload",function(){var e=Z(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.file(t).then(function(e){return n.image(e)}).then(function(e){return e});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),oe(ie(n),"handleChange",function(){var e=Z(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.file,i=t.fileList,"removed"!==a.status){e.next=5;break}n.setState({Img:""}),e.next=11;break;case 5:return e.next=7,n.beforeUpload(a.originFileObj);case 7:if(e.sent){e.next=11;break}return O.a.warning("单张图片上传尺寸不能大于 800 * 800, 请重新选择图片或使用统一上传!"),e.abrupt("return",!1);case 11:n.setState({fileList:i}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({Img:a.response.obj}),"error"===a.status&&(O.a.error("网络错误，上传失败！"),n.setState({Img:"",fileList:[]})));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),oe(ie(n),"handleVideoPcChange",function(e){var t=e.file,a=e.fileList;n.setState({videoPcfileList:a}),"removed"===t.status&&n.setState({videoPcImg:""}),t.response&&(1===t.response.code&&"done"===t.status&&n.setState({videoPcImg:t.response.obj}),"error"===t.status&&(O.a.error("网络错误，上传失败！"),n.setState({videoPcImg:"",videoPcfileList:[]})))}),oe(ie(n),"handleVideoMChange",function(e){var t=e.file,a=e.fileList;n.setState({videoMfileList:a}),"removed"===t.status&&n.setState({videoMImg:""}),t.response&&(1===t.response.code&&"done"===t.status&&n.setState({videoMImg:t.response.obj}),"error"===t.status&&(O.a.error("网络错误，上传失败！"),n.setState({videoMImg:"",videoMfileList:[]})))}),oe(ie(n),"handlePcChange",function(){var e=Z(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.file,i=t.fileList,"removed"!==a.status){e.next=5;break}n.setState({pcImg:""}),e.next=11;break;case 5:return e.next=7,n.beforeUpload(a.originFileObj);case 7:if(e.sent){e.next=11;break}return O.a.warning("单张图片上传尺寸不能大于 800 * 800, 请重新选择图片或使用统一上传!"),e.abrupt("return",!1);case 11:n.setState({pcfileList:i}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({pcImg:a.response.obj}),"error"===a.status&&(O.a.error("网络错误，上传失败！"),n.setState({pcImg:"",pcfileList:[]})));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),oe(ie(n),"handleMobileChange",function(){var e=Z(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.file,i=t.fileList,"removed"!==a.status){e.next=5;break}n.setState({mImg:""}),e.next=11;break;case 5:return e.next=7,n.beforeUpload(a.originFileObj);case 7:if(e.sent){e.next=11;break}return O.a.warning("单张图片上传尺寸不能大于 800 * 800, 请重新选择图片或使用统一上传!"),e.abrupt("return",!1);case 11:n.setState({mfileList:i}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({mImg:a.response.obj}),"error"===a.status&&(O.a.error("网络错误，上传失败！"),n.setState({mImg:"",mfileList:[]})));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),oe(ie(n),"handleMobileCommentChange",function(){var e=Z(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.file,i=t.fileList,"removed"!==a.status){e.next=5;break}n.setState({mcImg:""}),e.next=11;break;case 5:return e.next=7,n.beforeUpload(a.originFileObj);case 7:if(e.sent){e.next=11;break}return O.a.warning("单张图片上传尺寸不能大于 800 * 800, 请重新选择图片或使用统一上传!"),e.abrupt("return",!1);case 11:n.setState({mcfileList:i}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({mcImg:a.response.obj}),"error"===a.status&&(O.a.error("网络错误，上传失败！"),n.setState({mcImg:"",mcfileList:[]})));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),oe(ie(n),"handlePcSubjectChange",function(){var e=Z(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.file,i=t.fileList,e.next=3,n.beforeUpload(a.originFileObj);case 3:if(e.sent){e.next=7;break}return O.a.warning("图片尺寸不能大于 800 * 800, 请重新选择!"),e.abrupt("return",!1);case 7:n.setState({pcSubjectfileList:i}),"removed"===a.status&&n.setState({pcSubjectImg:""}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({pcSubjectImg:a.response.obj}),"error"===a.status&&(O.a.error("网络错误，上传失败！"),n.setState({pcSubjectImg:"",pcSubjectfileList:[]})));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),oe(ie(n),"handleMSubjectChange",function(){var e=Z(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.file,i=t.fileList,e.next=3,n.beforeUpload(a.originFileObj);case 3:if(e.sent){e.next=7;break}return O.a.warning("图片尺寸不能大于 800 * 800, 请重新选择!"),e.abrupt("return",!1);case 7:n.setState({mSubjectfileList:i}),"removed"===a.status&&n.setState({mSubjectImg:""}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({mSubjectImg:a.response.obj}),"error"===a.status&&(O.a.error("网络错误，上传失败！"),n.setState({mSubjectImg:"",mSubjectfileList:[]})));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),oe(ie(n),"handlePcHotSubjectChange",function(){var e=Z(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.file,i=t.fileList,e.next=3,n.beforeUpload(a.originFileObj);case 3:if(e.sent){e.next=7;break}return O.a.warning("图片尺寸不能大于 800 * 800, 请重新选择!"),e.abrupt("return",!1);case 7:n.setState({pcHotSubjectfileList:i}),"removed"===a.status&&n.setState({pcHotSubjectImg:""}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({pcHotSubjectImg:a.response.obj}),"error"===a.status&&(O.a.error("网络错误，上传失败！"),n.setState({pcHotSubjectImg:"",pcHotSubjectfileList:[]})));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),oe(ie(n),"handleMHotSubjectChange",function(){var e=Z(regeneratorRuntime.mark(function e(t){var a,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.file,i=t.fileList,e.next=3,n.beforeUpload(a.originFileObj);case 3:if(e.sent){e.next=7;break}return O.a.warning("图片尺寸不能大于 800 * 800, 请重新选择!"),e.abrupt("return",!1);case 7:n.setState({mHotSubjectfileList:i}),"removed"===a.status&&n.setState({mHotSubjectImg:""}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({mHotSubjectImg:a.response.obj}),"error"===a.status&&(O.a.error("网络错误，上传失败！"),n.setState({mHotSubjectImg:"",mHotSubjectfileList:[]})));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),oe(ie(n),"handleMp3",function(e){var t=e.file,a=e.fileList;t.response&&(1===t.response.code&&n.setState({mp3fileList:a},function(){}),"error"===t.status&&O.a.error("网络错误，上传失败！"))}),oe(ie(n),"handleUpload",function(){var e=n.state.videoList[0],t=e.size,a=Math.ceil(t/2097152),i=new FormData;i.append("fileName",e.name),i.append("blockCount",a),i.append("currIndex",me),i.append("uploadId",pe),i.append("uploadFile",null),i.append("type","video"),n.setState({uploading:!0}),n.UploadPost(e,i,t,a,2097152)}),oe(ie(n),"UploadPost",function(e,t,a,i,r){if(!de)try{var o=(me-1)*r,s=Math.min(a,o+r),l=e.slice(o,s);t.set("uploadFile",l),t.set("currIndex",me),t.set("uploadId",pe),Object(K.l)("post","/file/upload",t,function(o){if(1===o.code){1===me&&(pe=o.obj);var s=me/i*100;me+1===i&&(s=100),n.setState({progressNum:parseFloat(s.toFixed(2))}),me<i&&(me+=1,n.UploadPost(e,t,a,i,r))}else if(o.code<0)pe="",me=1,O.a.error(o.msg);else if(2===o.code){pe="",me=1;var l=n.state.videofileList,c=[];l.map(function(e,t){c.push({uid:e.uid,fileName:e.name,name:e.name,fileUrl:o.obj})}),n.setState({videoList:[],videofileList:c,uploading:!1}),O.a.success("文件上传成功!")}})}catch(e){console.log(e)}}),oe(ie(n),"newsVisibleHide",function(){n.setState({newsVisible:!1})}),oe(ie(n),"newsVisibleShow",function(){n.setState({newsVisible:!0})}),oe(ie(n),"normFile",function(e){return Array.isArray(e)?e:e&&e.fileList}),oe(ie(n),"delAudio",function(e){var t=n.state.audioDefalutArr;t.map(function(a,n){a.uid.toString()===e.toString()&&t.splice(n,1)}),n.setState({audioDefalutArr:t})}),oe(ie(n),"delMiniApp",function(){pe="",me=1,n.setState({videoList:[],videofileList:[],uploading:!1})}),oe(ie(n),"uploadAllImg",function(t){var a=t.file,i=t.fileList,r=ie(n);if(a.size/1048576>=2)return O.a.error("图片大小超过 2M , 请重新选择!"),n.setState({allfilelist:[],allImg:""}),!1;n.setState({allfileList:i}),"removed"===a.status&&(n.setState({allfilelist:[],allImg:""}),n.state.cropImgRule.map(function(e,t){var a;r.setState((oe(a={},e.coverName,""),oe(a,e.coverList,[]),a))})),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({allImg:a.response.obj,uploadAllImgModal:!0,focusImg:-1},function(){var t=document.querySelector("#croppedImg");t.src=a.thumbUrl,r.setState({cropper:new H.a(t,{aspectRatio:n.state.ratio,viewMode:1,crop:function(t){var a=this.cropper.getCroppedCanvas().toDataURL("image/jpeg"),n=e(".crop-preview-item"),i=r.state.focusImg;-1===i?n.each(function(t,n){e(this).children("img").attr("src",a)}):n.eq(i).children("img").attr("src",a)}})})}),"error"===a.status&&(O.a.error("网络错误，上传失败！"),n.setState({allImg:"",allfileList:[]})))}),oe(ie(n),"sureCropImg",function(){var t=ie(n);n.setState({uploadAllImgModal:!1,loading:!0}),O.a.warning("上传中，请稍候！"),n.state.cropper.destroy(),e(".crop-preview-item").each(function(a,n){var i,r=e(this).data("type"),o=e(this).data("list");t.setState((oe(i={},r,""),oe(i,o,[]),i));var s=e(this),l=s.outerWidth(!1),c=s.outerHeight(!1),u={scale:1.5,canvas:document.createElement("canvas"),logging:!1,width:l,height:c};U()(e(this).get(0),u).then(function(n){n.toBlob(function(n){var i=new FormData;i.append("uploadFile",n),e.ajax("".concat(K.a,"/pic/upload"),{headers:{"Sign-Param":Object(K.A)()},method:"POST",data:i,processData:!1,timeout:4e4,contentType:!1,success:function(e){var n;0===a&&(t.setState({loading:!1}),O.a.success("上传完毕！")),t.setState((oe(n={},r,e.obj),oe(n,o,[{uid:0,name:"xxx.png",status:"done",url:e.obj}]),n),function(){})},error:function(e,a){t.setState({loading:!1}),"timeout"===a?O.a.error("上传超时, 请检查网络后重新上传！"):O.a.error("网络故障, 请尝试重新上传！"),e.abort()}})})})})}),oe(ie(n),"uploadAllImgCancel",function(){n.setState({uploadAllImgModal:!1}),n.state.cropper.destroy()}),oe(ie(n),"handleSubmit",function(t){t.preventDefault(),n.enterIconLoading();var a=t.target.getAttribute("data-status"),i=n.state.updateOrNot&&(n.props.location.query.id||n.props.location.query.url);if(!i&&n.saveArticle(),e(".simditor").find("img.uploading").length>0)return O.a.warning("编辑器中图片正在上传, 请稍候提交!"),n.setState({iconLoading:!1}),!1;if(n.state.uploading)return O.a.warning("视频正在上传, 请稍候提交!"),n.setState({iconLoading:!1}),!1;var r=Date.parse(n.props.form.getFieldValue("publishTime").format("YYYY-MM-DD HH:mm:ss")),o=Date.parse(new Date);if("3"===a&&r<=o)return n.setState({iconLoading:!1}),O.a.warning("预发布新闻时间应 大于 当前时间，请重新设置!"),!1;if("1"===a&&r>o)return n.setState({iconLoading:!1}),O.a.warning("直接发布新闻的时间应 小于等于 当前时间，请重新设置!"),!1;var s=n.state.audioDefalutArr;n.state.mp3fileList.map(function(e,t){s.push({uid:e.uid,fileName:e.name,fileUrl:e.response.obj})}),n.setState({audioDefalutArr:s},function(){var e=this,t=null;t=1===parseInt(this.state.subject)?{pc_subject:this.state.pcSubjectImg,m_subject:this.state.mSubjectImg,pc_hot_subject:this.state.pcHotSubjectImg,m_hot_subject:this.state.mHotSubjectImg}:{},this.props.form.setFieldsValue(te({},t,{tags:this.state.tags.join(","),original:this.state.original,advertised:this.state.advertised,subject:this.state.subject,content:this.state.newsContent,pc_recommend:this.state.pcImg,pc:this.state.Img,wap_small:this.state.mImg,wap_big:this.state.mcImg,audio:JSON.stringify(this.state.audioDefalutArr),video:this.state.videofileList[0]&&this.state.videofileList[0].fileUrl?JSON.stringify(this.state.videofileList):"[]"})),this.props.form.validateFieldsAndScroll(function(t,n){t?e.setState({iconLoading:!1}):(e.setState({loading:!0}),n.publishTime=Date.parse(n.publishTime.format("YYYY-MM-DD HH:mm:ss")),n.coverPic=JSON.stringify({pc_recommend:n.pc_recommend||"",pc:n.pc,wap_big:n.wap_big,wap_small:n.wap_small,video_pc:e.state.videoPcImg,video_m:e.state.videoMImg,pc_subject:n.pc_subject||"",m_subject:n.m_subject||"",pc_hot_subject:n.pc_hot_subject||"",m_hot_subject:n.m_hot_subject||""}),delete n.pc,delete n.pc_recommend,delete n.wap_big,delete n.wap_small,delete n.video_pc,delete n.video_m,delete n.pc_subject,delete n.m_subject,delete n.m_hot_subject,delete n.pc_hot_subject,delete n.alignLeft,delete n.wordBreak,delete n.watermark,n.id=e.props.location.query.id||"",n.status=a||1,(!e.state.updateOrNot||!e.props.location.query.id)&&delete n.id,Object(K.i)("post","".concat(e.state.updateOrNot&&e.props.location.query.id?"/miniapp/update":"/news/add"),n,function(t){e.setState({loading:!1}),t.code&&1===t.code?(O.a.success(i?"修改成功！":"添加成功！"),!i&&localStorage.removeItem("articleData"),D.hashHistory.push("/miniNews-list")):(e.setState({iconLoading:!1}),O.a.error(t.msg))}))})})}),oe(ie(n),"sendPost",function(e){var t=n.state,a=t.wordBreak,i=t.alignLeft,r='<style type="text/css"> .details .details-cont p, p {word-break: '.concat(a?"break-all !important":"normal","; text-align: ").concat(i?"left !important":"unset","} p img {text-align: center !important;} </style>"),o={newsTitle:e.postTitle||"",newsContent:"<div class=".concat(i?"simditorSupport":"",">").concat(r).concat(e.postContent,"</div>")||!1};n.setState(te({},n.state,o))}),oe(ie(n),"createMarkup",function(e){return{__html:e}}),oe(ie(n),"CropperImgCroped",function(e){console.log(e)}),oe(ie(n),"FormItem",function(e){var t=n.state.updateOrNot,a=n.props.form.getFieldDecorator,i=T.a.createElement("div",null,T.a.createElement(C.a,{type:"plus"}),T.a.createElement("div",{className:"ant-upload-text"},"上传图片"));return T.a.createElement(se,$({},{labelCol:{span:1},wrapperCol:{span:15,offset:1}},{label:e.label}),T.a.createElement("div",{className:"dropbox"},a(e.imgName,{initialValue:t&&e.newsInfo?e.fileList:"",rules:[{required:e.require,message:"请上传".concat(e.label,"封面！")}]})(T.a.createElement(L.a,{headers:{"Sign-Param":Object(K.A)()},action:"".concat(K.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:e.fileList,onPreview:n.handlePreview,onChange:e.changeEvent},e.fileList.length>=1?null:i)),e.noBtn?"":T.a.createElement(I.a,{"data-type":e.imgUrl,onClick:n.handlePreview,className:"img-preview",type:"primary"},"预览"),T.a.createElement("span",{className:"cover-img-tip"},"用于 ",e.label," 的封面展示, 建议尺寸: ",T.a.createElement("font",{style:{color:"red"}},e.size))))}),n.state={editor:"",updateOrNot:!1,tags:[],mp3fileList:[],videofileList:[],videoList:[],audioDefalutArr:[],inputVisible:!1,inputValue:"",isLogin:!1,channelId:"1",newsVisible:!1,cateId:"1",previewVisible:!1,previewImage:"",newsTitle:"",newsContent:"",mp3Url:"",videoUrl:"",uploading:!1,progressNum:0,loading:!0,original:0,advertised:0,subject:0,uploadAllImgModal:!1,cropper:null,focusImg:-1,ratio:2,cropImgRule:[{coverName:"mcImg",coverList:"mcfileList",width:"640px",height:"320px",ratio:2,intro:"M端推荐新闻的滚动:640 * 320"},{coverName:"pcImg",coverList:"pcfileList",width:"400px",height:"251px",ratio:532/335,intro:"PC端推荐位新闻封面:532 * 335"},{coverName:"Img",coverList:"fileList",width:"220px",height:"160px",ratio:1.375,intro:"PC 端新闻封面:220 * 160"},{coverName:"mImg",coverList:"mfileList",width:"164px",height:"124px",ratio:290/220,intro:"M端新闻封面:164 * 124"}],width:0,height:0,wordBreak:0,alignLeft:0,iconLoading:!1,interval:0},n}var n,r,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(a,M["Component"]),n=a,(r=[{key:"componentWillMount",value:function(){J.a.set("watermark",0),this.insertState(["mHotSubject","pcHotSubject","mSubject","pcSubject","videoPc","videoM","all","","pc","m","mc"])}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.dispatch,n=t.location;a(Object(W.f)()),n.query.id?a(Object(G.c)({id:n.query.id},function(t){e.renderData(t)})):(localStorage.getItem("articleData")?setTimeout(function(){a(Object(G.b)({},function(t){e.renderData(t)}))},500):this.setState({loading:!1}),this.setState({interval:setInterval(function(){e.saveArticle(),console.log("已存储！")},5e3)}))}},{key:"componentWillUnmount",value:function(){var e=this.state.interval;this.setState({interval:clearInterval(e)})}},{key:"changeActiveImg",value:function(e,t,a){var n=this;if(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),a===this.state.focusImg)return!1;this.setState({ratio:t.ratio,focusImg:a},function(){n.state.cropper.setAspectRatio(t.ratio)})}},{key:"render",value:function(){var e=this,t=this.state.updateOrNot&&(this.props.location.query.id||this.props.location.query.url),a=this,n=this.props.form.getFieldDecorator,r=this.props.newsInfo,s=this.state,c=s.cateId,p=s.focusImg,d=s.allfileList,g=s.uploadAllImgModal,b=s.progressNum,y=s.videoPcfileList,w=s.videoMfileList,j=s.videofileList,E=s.uploading,_=s.previewVisible,x=s.previewImage,k=s.fileList,P=s.pcfileList,V=s.mfileList,M=s.mcfileList,F=s.tags,q=s.inputVisible,U=s.inputValue,H=s.newsContent,B=s.updateOrNot,Y=s.newsVisible,G=s.mp3fileList,W={labelCol:{span:1},wrapperCol:{span:20,offset:1}},Q={action:"/file/upload",onRemove:this.delMiniApp,beforeUpload:function(t){return e.setState({videoList:[t],videofileList:[t]}),!1},fileList:this.state.videofileList},X=T.a.createElement("div",null,T.a.createElement(C.a,{type:"plus"}),T.a.createElement("div",{className:"ant-upload-text"},"上传图片"));return console.log(r),T.a.createElement("div",{className:"miniApp-send"},T.a.createElement(i.a,{spinning:this.state.loading,size:"large"},T.a.createElement(A.a,{onSubmit:this.handleSubmit},T.a.createElement(se,$({},W,{label:"作者: "}),n("author",{initialValue:B&&r?"".concat(r.author):"",rules:[{required:!0,message:"请输入作者！"}]})(T.a.createElement(N.a,{ref:function(t){e.authorInput=t},className:"news-author",placeholder:"请输入作者"}))),T.a.createElement(se,$({},W,{label:"是否独家: "}),n("original",{initialValue:!(!B||!r.original)&&1===parseInt(r.original),valuePropName:"checked"})(T.a.createElement(S.a,{onChange:function(t){e.setState({original:t?1:0})},checkedChildren:"是",unCheckedChildren:"否"}))),T.a.createElement(se,$({},W,{label:"是否推广: "}),n("advertised",{initialValue:!(!B||!r.original)&&1===parseInt(r.original),valuePropName:"checked"})(T.a.createElement(S.a,{onChange:function(t){e.setState({original:t?1:0})},checkedChildren:"是",unCheckedChildren:"否"}))),0!==this.props.channelList.length&&T.a.createElement(se,$({},W,{label:"频道: "}),n("channelId",{initialValue:B&&r?"".concat(r.channelId||"1"):"1"})(T.a.createElement(ce,{options:this.props.channelList,onChange:this.channelIdChange,setFieldsValue:this.state.channelId}))),T.a.createElement(se,$({},W,{label:"类别: "}),n("cateId",{initialValue:B&&r?"".concat(r.cateId||"2"):"1"})(T.a.createElement(ce,{disabled:this.props.location.query.url,options:ue,onChange:this.cateIdChange,setFieldsValue:this.state.cateId}))),T.a.createElement(se,$({},W,{label:"来源: "}),n("source",{initialValue:B&&r?"".concat(r.source||"MarsBit"):"MarsBit",rules:[{required:!0,message:"请输入新闻来源！"}]})(T.a.createElement(N.a,{disabled:1===parseInt(c),className:"news-source",placeholder:"请输入新闻来源"}))),(2===parseInt(c)||this.props.location.query.url)&&T.a.createElement("div",{className:"reprint"},T.a.createElement(se,$({},W,{label:"原文标题: "}),n("originalTitle",{initialValue:B&&r?"".concat(r.originalTitle||""):"",rules:[{required:!0,message:"请输入原文标题！"}]})(T.a.createElement(N.a,{className:"news-source",placeholder:"请输入原文标题"}))),T.a.createElement(se,$({},W,{label:"原文链接: "}),n("originalUrl",{initialValue:B&&r?"".concat(r.originalUrl||""):"",rules:[{required:!1,message:"请输入原文链接！"}]})(T.a.createElement(N.a,{className:"news-source",placeholder:"请输入原文链接"})))),T.a.createElement(se,$({},W,{label:"发布日期: "}),n("publishTime",{rules:[{required:!0,message:"请选择新闻发布时间！"}],initialValue:B&&r&&0!==r.status?z()(Object(K.w)(r.publishTime||Date.parse(new Date)),"YYYY-MM-DD HH:mm:ss"):z()()})(T.a.createElement(v.a,{showTime:!0,format:"YYYY-MM-DD HH:mm:ss"}))),T.a.createElement(se,$({},W,{label:"热度: "}),n("hotCounts",{initialValue:B&&r&&r.hotCounts||0,rules:[{required:!0,pattern:/^[0-9]+$/,message:"请输入新闻热度值(正整数)！"}]})(T.a.createElement(N.a,{className:"news-source",placeholder:"请输入新闻热度值"}))),T.a.createElement(se,$({},W,{label:"标题: "}),n("title",{initialValue:B&&r?"".concat(r.title):"",rules:[{required:!0,message:"请输入新闻标题！"}]})(T.a.createElement(N.a,{placeholder:"新闻标题"}))),T.a.createElement(se,$({},W,{label:"副标题: "}),n("subTitle",{initialValue:B&&r?"".concat(r.subTitle||""):"",rules:[{required:!1,message:"请输入新闻副标题！"}]})(T.a.createElement(N.a,{placeholder:"副标题, 用于官网SEO优化"}))),T.a.createElement(se,$({},W,{label:"核心关键词: "}),n("keyTags",{initialValue:B&&r?"".concat(r.keyTags||""):"",rules:[{required:!1,message:"请输入核心关键词！"}]})(T.a.createElement(N.a,{placeholder:"核心关键词"}))),T.a.createElement(se,$({},W,{label:"音频"}),n("audio",{valuePropName:"mp3fileList",getValueFromEvent:this.normFile})(T.a.createElement(L.a,{headers:{"Sign-Param":Object(K.A)()},defaultFileList:this.state.mp3fileList,action:"".concat(K.a,"/audio/upload"),name:"uploadFile",filelist:G,onChange:this.handleMp3},T.a.createElement(I.a,null,T.a.createElement(C.a,{type:"upload"})," 点击上传音频"))),T.a.createElement("ul",null,this.state.audioDefalutArr.map(function(e,t){return T.a.createElement("li",{key:t},e.fileName,T.a.createElement("span",{style:{marginLeft:"10px",cursor:"pointer"},onClick:function(){a.delAudio(e.uid)}},"删除"))}))),T.a.createElement(se,$({},W,{label:"视频"}),n("video")(T.a.createElement(L.a,$({},Q,{name:"uploadFile"}),T.a.createElement(I.a,null,T.a.createElement(C.a,{type:"upload"})," 选择视频"))),0===j.length?"":j[0].fileName?T.a.createElement("p",null,T.a.createElement("span",null,j[0].fileName),T.a.createElement("span",{onClick:e.delMiniApp,style:{marginLeft:15,color:"#52b8fc",cursor:"pointer"}},"删除")):void 0,T.a.createElement(I.a,{style:{marginTop:16},className:"upload-demo-start",type:"primary",onClick:this.handleUpload,disabled:0===this.state.videoList.length,loading:E},E?"上传中":"开始上传"),E&&T.a.createElement(h.a,{strokeWidth:5,style:{width:300,display:"block"},percent:b,status:"active"})),j[0]&&j[0].fileUrl?T.a.createElement("div",{className:"miniApp-cover"},this.FormItem({imgName:"video_pc",label:"视频PC封面",imgUrl:"",newsInfo:r,fileList:y,changeEvent:this.handleVideoPcChange,size:"280px * 205px",noBtn:!1,require:!0}),this.FormItem({imgName:"video_m",label:"视频 M 端封面",imgUrl:"",newsInfo:r,fileList:w,changeEvent:this.handleVideoMChange,size:"280px * 205px",noBtn:!1,require:!0})):"",T.a.createElement(se,$({},W,{label:"文章左对齐: "}),n("alignLeft",{initialValue:!1,valuePropName:"checked"})(T.a.createElement(S.a,{onChange:function(t){e.setState({alignLeft:t?1:0},function(){e.sendPost({postTitle:e.state.newsTitle,postContent:e.state.editor.getValue()})})},checkedChildren:"是",unCheckedChildren:"否"}))),T.a.createElement(se,$({},W,{label:"英文强制换行: "}),n("wordBreak",{initialValue:!1,valuePropName:"checked"})(T.a.createElement(S.a,{onChange:function(t){e.setState({wordBreak:t?1:0},function(){e.sendPost({postTitle:e.state.newsTitle,postContent:e.state.editor.getValue()})})},checkedChildren:"是",unCheckedChildren:"否"}))),T.a.createElement(se,$({},W,{label:"图片加水印: "}),n("watermark",{initialValue:!1,valuePropName:"checked"})(T.a.createElement(S.a,{onChange:function(e){e?J.a.set("watermark",1):J.a.set("watermark",0)},checkedChildren:"是",unCheckedChildren:"否"}))),T.a.createElement(se,$({},W,{label:"内容: "}),n("content",{initialValue:B&&r?H:"",rules:[{required:!0,message:"请输入新闻内容！"}]})(T.a.createElement(N.a,{className:"news",style:{display:"none"}})),T.a.createElement(R.a,{setSimditor:function(t){e.setState({editor:t})},subSend:function(t){return e.sendPost(t)}})),T.a.createElement(se,$({},W,{label:"摘要: "}),n("synopsis",{initialValue:B&&r?"".concat(r.synopsis):"",rules:[{max:120,required:!0,message:"请输入新闻内容摘要, 最多120字！"}]})(T.a.createElement(le,{className:"news-summary",placeholder:"新闻摘要, 最多120字"}))),T.a.createElement(se,$({},W,{label:"标签: "}),n("tags",{initialValue:this.state.tags.join(","),rules:[{required:!0,message:"至少输入一个标签！"}]})(T.a.createElement(N.a,{className:"tag-item",style:{display:"none"}})),T.a.createElement("div",null,F.map(function(t,a){var n=t.length>8,i=T.a.createElement(f.a,{color:"blue",key:t,closable:-1!==a,afterClose:function(){return e.handleClose(t)}},n?"".concat(t.slice(0,8)):t);return n?T.a.createElement(m.a,{title:t,key:t},i):i}),q&&T.a.createElement(N.a,{ref:this.saveInputRef,type:"text",size:"small",style:{width:120},value:U,onChange:this.handleInputChange,onBlur:this.handleInputConfirm,onPressEnter:this.handleInputConfirm}),!q&&F.length<20&&T.a.createElement(f.a,{onClick:this.showInput,style:{background:"#fff",borderStyle:"dashed"}},T.a.createElement(C.a,{type:"plus"})," New Tag"),T.a.createElement("span",null,"每个标签最多",T.a.createElement("font",{style:{color:"red"}}," 8 "),"个字"))),T.a.createElement(se,$({},W,{label:"统一上传图片: "}),T.a.createElement("div",{className:"dropbox"},T.a.createElement(L.a,{headers:{"Sign-Param":Object(K.A)()},action:"".concat(K.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:d,onPreview:this.handlePreview,onChange:this.uploadAllImg},d.length>=1?null:X),T.a.createElement("span",{className:"cover-img-tip all-img"},"统一上传所有尺寸图片，自动剪裁适配尺寸"))),this.FormItem({imgName:"pc",label:"PC-缩略图",imgUrl:"Img",newsInfo:r,fileList:k,changeEvent:this.handleChange,size:"220px * 160px",noBtn:!1,require:!0}),this.FormItem({imgName:"pc_recommend",label:"PC-推荐位",imgUrl:"pcImg",newsInfo:r,fileList:P,changeEvent:this.handlePcChange,size:"532px * 335px",noBtn:!1,require:!0}),this.FormItem({imgName:"wap_small",label:"M-缩略图",imgUrl:"mImg",newsInfo:r,fileList:V,changeEvent:this.handleMobileChange,size:"164px * 124px",noBtn:!1,require:!0}),this.FormItem({imgName:"wap_big",label:"M-轮播图",imgUrl:"mcImg",newsInfo:r,fileList:M,changeEvent:this.handleMobileCommentChange,size:"640px * 320px",noBtn:!1,require:!0}),T.a.createElement(se,{wrapperCol:{span:12,offset:2}},T.a.createElement(I.a,{type:"primary",onClick:this.newsVisibleShow,className:"preview",style:{marginRight:"10px",marginBottom:10}},"新闻内容预览"),T.a.createElement(I.a,{loading:this.state.iconLoading,type:"primary","data-status":"1",onClick:this.handleSubmit,style:{marginRight:"10px"}},"发表"),T.a.createElement(I.a,{type:"primary","data-status":"3",onClick:this.handleSubmit,style:{marginRight:"10px"}},"定时发表"),T.a.createElement(I.a,{type:"primary","data-status":"0",onClick:this.handleSubmit,style:{marginRight:"10px"}},"存为草稿"),T.a.createElement(I.a,{type:"primary",className:"cancel",onClick:function(){D.hashHistory.goBack()}},"取消")),T.a.createElement(u.a,{height:"700px",width:"1400px",style:{top:"50px"},visible:g,onOk:this.sureCropImg,maskClosable:!1,onCancel:this.uploadAllImgCancel},T.a.createElement("div",{className:"croper-wrap clearfix"},T.a.createElement("div",{className:"crop-img",id:"cropImgWrap"},T.a.createElement("img",{id:"croppedImg",src:"",alt:"Picture"})),T.a.createElement("div",{onClick:function(t){t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),e.setState({focusImg:-1})},className:"crop-preview"},this.state.cropImgRule.map(function(e,t){return T.a.createElement("div",{key:t,onClick:function(n){a.changeActiveImg(n,e,t)},className:"cropper-intro"},T.a.createElement("div",{className:"cropper-item-wrap ".concat(p===t?"active":"")},T.a.createElement("div",{"data-type":e.coverName,"data-list":e.coverList,className:"crop-preview-item",style:{fontSize:0,width:e.width,height:e.height}},T.a.createElement("img",{src:"",alt:"",style:{width:"100%",height:"100%"}}))),T.a.createElement("span",null,e.intro))})))),T.a.createElement(u.a,{visible:Y,footer:null,className:"newsModal",onCancel:this.newsVisibleHide,width:1e3},T.a.createElement(o.a,null,T.a.createElement(l.a,{className:"previewNews simditor"},T.a.createElement("p",{className:"simditor-body",style:{padding:10},dangerouslySetInnerHTML:this.createMarkup(H)})))),T.a.createElement(u.a,{visible:_,footer:null,onCancel:this.handleCancel},T.a.createElement("img",{alt:"example",style:{width:"100%"},src:x}))),!t&&T.a.createElement(I.a,{onClick:function(){e.saveArticle(),O.a.success("本地保存成功!")},title:"存一下",className:"fix-button",type:"primary",shape:"circle",icon:"download",size:"large"})))}}])&&ae(n.prototype,r),s&&ae(n,s),a}();t.default=Object(F.connect)(function(e){return{userInfo:e.miniAppInfo.userInfo,newsInfo:e.miniAppInfo.info,channelList:e.channelListInfo}})(A.a.create()(fe))}.call(this,a(97))},1650:function(e,t,a){"use strict";a(184);var n=a(1378),i=a.n(n),r=a(0),o=a.n(r),s=a(246),l=a(97),c=a.n(l),u=a(1399),p=a.n(u),m=(a(1640),a(1622)),d=a.n(m),f=(a(1651),a(48));a(1623);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var S=i.a.TextArea,w="",I=function(e){function t(e){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=b(this,v(t).call(this,e));var n=e.info,i=e.toolBar;return a.state={postContent:n&&n.postContent?n.postContent:""},a.EDITTOOLBAR=i||["title","bold","italic","underline","strikethrough","fontScale","color","ol","ul","blockquote","code","table","link","image","hr","indent","outdent","alignment","clearhtml"],a}var a,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,r["Component"]),a=t,(n=[{key:"componentDidMount",value:function(){var e=this;(w=new p.a({pasteImage:!0,textarea:c()(".editor"),defaultImage:d.a,toolbar:this.EDITTOOLBAR,upload:{pasteImage:!0,url:"".concat(f.a,"/picture/upload"),params:{type:"news"},fileKey:"uploadFile",connectionCount:1,headers:{"Sign-Param":Object(f.A)()},leaveConfirm:"正在上传文件",success:function(e){this.editor.opts.upload.headers["Sign-Param"]=Object(f.A)();var t="",a="";return 1!==e.code?(t=e.msg||this._t("uploadFailed"),window.layer.msg(t),a=this.defaultImage):a=e.obj,a}}})).on("focus",function(){var e=c()(".toolbar-menu-title").find("li");e.eq(2).hide(),e.eq(3).hide(),e.eq(6).hide(),e.eq(7).hide();var t=c()(".link-popover").find(".settings-field");t.eq(0).hide(),t.eq(1).find("input").val(""),t.eq(2).hide()}),w.on("pasting",function(e,t){t.each(function(){c()(this).removeAttr("style"),c()(this).find("*").removeAttr("style"),c()(this).removeAttr("class"),c()(this).find("*").removeAttr("class")});var a=c()(t[0]),n=Object(f.G)(a.html())?a.html():[],i=c()(".simditor-body"),r=c()(".simditor");setTimeout(function(){i.children("p").each(function(){var e=c()(this),t=c()(this).html();Object(f.G)(t)&&t.indexOf("signTime")>-1&&t.indexOf("imgSrc")>-1&&e.remove()})},10);0!==n.length&&(r.find(".simditorModal").length>0?c()(".simditorModal").show():r.append('<div class="simditorModal" style="position:absolute;top: 0;left: 0;z-index: 6; width:100%;height:100%;box-sizing:border-box;padding-top:40px;text-align: center;line-height: 150%;font-size: 1.2rem;background-color: rgba(255,255,255,0.5);">图片上传中</div>'),Object(f.i)("POST","/pic/url_upload",{data:n},function(e){1===e.code&&(c.a.each(e.obj,function(e,t){var a="pasteUploadingImg"+t.signTime;c()("img[src="+a+"]").attr("src",t.imgSrc)}),c()(".simditorModal").hide(),w.setValue(i.html()))}))}),this.props.setSimditor&&this.props.setSimditor(w);var t=this.props.info;t&&t.postContent&&w.setValue(t.postContent),w.on("valuechanged ",function(t){e.setState({postContent:w.getValue()}),e.sendPost()})}},{key:"sendPost",value:function(){(0,this.props.subSend)(this.state)}},{key:"clearContent",value:function(){w.setValue(""),this.setState({postContent:""})}},{key:"render",value:function(){return o.a.createElement("div",{className:"editor-post-content"},o.a.createElement(S,{className:"editor",autosize:!0}))}}])&&h(a.prototype,n),i&&h(a,i),t}();t.a=Object(s.connect)(function(e){return{query:e.postInfo.query}})(I)},1651:function(e,t,a){var n=a(1652);"string"==typeof n&&(n=[[e.i,n,""]]);var i={transform:void 0};a(186)(n,i);n.locals&&(e.exports=n.locals)},1652:function(e,t,a){(e.exports=a(185)(!1)).push([e.i,"",""])},1662:function(e,t,a){var n=a(1680);"string"==typeof n&&(n=[[e.i,n,""]]);var i={transform:void 0};a(186)(n,i);n.locals&&(e.exports=n.locals)},1663:function(e,t,a){"use strict";(function(e){a.d(t,"f",function(){return c}),a.d(t,"d",function(){return u}),a.d(t,"c",function(){return p}),a.d(t,"b",function(){return m}),a.d(t,"e",function(){return d}),a.d(t,"a",function(){return g}),a.d(t,"i",function(){return h}),a.d(t,"g",function(){return b}),a.d(t,"h",function(){return v});a(361);var n=a(20),i=a.n(n),r=a(48),o=a(2);function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){l(e,t,a[t])})}return e}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c=function(e){return{type:o.xb,data:e}},u=function(e,t,a){return function(e){Object(r.i)("post","/miniapp/getlist",t?s({},t,{createrType:0}):{},function(t){if(1===t.code){var n=t.obj;e(f({list:n.inforList})),e(v({totalCount:n.recordCount,pageSize:n.pageSize,currPage:n.currentPage})),a&&a(n)}else i.a.error(t.msg)})}},p=function(e,t){return function(a){Object(r.i)("post","/news/getbyid",s({},e),function(e){if(1===e.code){var n=e.obj;a(f({info:n})),t&&t(n)}else i.a.error(e.msg)})}},m=function(e,t){return function(e){var a=localStorage.getItem("articleData");if(!a)return!1;e(f({info:JSON.parse(a)})),t&&t(JSON.parse(a))}},d=function(e,t){return function(a){Object(r.i)("post","/news/setorder",s({},e),function(a){1===a.code?(0===parseInt(e.topOrder)?i.a.success("取消置顶成功！"):i.a.success("置顶成功！"),t&&t()):i.a.error(a.msg)})}},f=function(e){return{type:o.cb.ADD_DATA,data:e}},g=function(e,t){return{type:o.cb.EDIT_LIST_ITEM,data:e,index:t}},h=function(e){return{type:o.cb.SET_SEARCH_QUERY,data:e}},b=function(e){return{type:o.cb.SET_FILTER_DATA,data:e}},v=function(e){return{type:o.cb.SET_PAGE_DATA,data:e}}}).call(this,a(97))},1680:function(e,t,a){(e.exports=a(185)(!1)).push([e.i,"",""])}}]);