(window.webpackJsonp=window.webpackJsonp||[]).push([[94,42],{1434:function(e,t,n){"use strict";n.r(t);n(675);var a=n(676),r=n.n(a),i=(n(1385),n(1386)),c=n.n(i),o=(n(247),n(183)),l=n.n(o),s=(n(361),n(20)),u=n.n(s),p=(n(677),n(362)),f=n.n(p),d=(n(184),n(1378)),m=n.n(d),h=(n(1379),n(1380)),y=n.n(h),b=(n(678),n(363)),g=n.n(b),v=(n(1376),n(1377)),E=n.n(v),O=n(0),k=n.n(O),j=n(246),S=(n(1611),n(10)),w=n(1625),C=n(1621),P=n(248),A=n(48);function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){M(e,t,n[t])})}return e}function _(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=E.a.confirm,H=g.a.Group,q=y.a.Item,F=m.a.TextArea,z=f.a.Option,V=[],G={labelCol:{sm:{span:6}},wrapperCol:{sm:{span:16}}},J=function(e){function t(){var e,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=x(t).call(this),e=!a||"object"!==T(a)&&"function"!=typeof a?N(n):a,M(N(e),"cancelModal",function(){e.props.form.resetFields(),e.setState({visible:!1})}),M(N(e),"handleChange",function(t){e.setState({apiAdd:t}),e.doSearch("init",{currentPage:1,apiAdd:t})}),M(N(e),"terminalChange",function(t){e.setState({terminal:t.join(",")})}),M(N(e),"handleRecommend",function(t){var n=e.props.dispatch,a=N(e);R({title:"提示",content:"".concat(1===t.recCreaterType?"确认要撤回吗":"确认要推荐吗"," "),onOk:function(){var e={livesId:t.id,status:1===t.recCreaterType?0:1};Object(A.i)("POST","/lives/changeRecCreaterType",I({},e),function(e){1===e.code?(u.a.success("".concat(1===t.recCreaterType?"撤回成功":"推荐成功"," ")),a.doSearch("init"),n(Object(w.f)({type:"init"}))):u.a.error(e.msg)})}})}),e.state={visible:!1,loading:!0,terminal:"1, 2",apiAdd:""},e}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,O["Component"]),n=t,(a=[{key:"channelName",value:function(e){var t="";return this.props.flashTypeList.map(function(n,a){parseInt(n.value)===e&&(t=n.label)}),t}},{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.search;n(Object(P.k)()),this.doSearch(a.type?a.type:"init");V=[{title:"快讯标题",key:"title",width:250,render:function(e,t){return k.a.createElement("div",{className:"flash-info clearfix"},k.a.createElement("div",null,k.a.createElement("h3",null,1===parseInt(t.apiAdd)?k.a.createElement("span",{className:"hint"},"爬虫"):2===parseInt(t.apiAdd)?k.a.createElement("span",{className:"hint"},"算法"):"",t.title?"【".concat(t.title,"】"):(n=t.content,"【".concat(n.split("【")[1].split("】")[0],"】")))));var n}},{title:"内容",key:"content",render:function(t,n){return k.a.createElement("div",{className:"flash-info clearfix"},k.a.createElement("div",null,k.a.createElement("h3",{title:Object(A.y)(n.content),dangerouslySetInnerHTML:e.createMarkup(Object(A.q)(Object(A.y)(n.content),300))})))}},{title:"频道",dataIndex:"channelId",width:70,key:"channelId",render:function(t){return e.channelName(t)}},{title:"利好",dataIndex:"upCounts",key:"upCounts",width:45},{title:"利空 ",dataIndex:"downCounts",key:"downCounts",width:45},{title:"发表时间",width:80,key:"createdTime",render:function(t){return k.a.createElement("div",{style:{textAlign:"center"},dangerouslySetInnerHTML:e.createMarkup(Object(A.w)(t.createdTime,"-",!0))})}},{title:"操作",key:"action",width:100,render:function(t){return k.a.createElement("div",{className:"btns"},k.a.createElement("p",null,k.a.createElement(S.Link,{className:"mr10 opt-btn",to:{pathname:"/flash-detail",query:{id:t.id}},style:{background:"#108ee9"}},"详情")),k.a.createElement("p",null,k.a.createElement(S.Link,{className:"mr10 opt-btn",to:{pathname:"/flash-edit",query:{id:t.id}},style:{background:"#e35ba3"}},"编辑")),k.a.createElement("p",null,k.a.createElement("a",{onClick:function(){return e.delFlash(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#d73435"}},"删除")),k.a.createElement("p",null,k.a.createElement("a",{onClick:function(){return e.handleRecommend(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#1048ae",padding:"2px 6px"}},1===t.recCreaterType?"从首页撤回":"推至首页")),k.a.createElement("p",null,k.a.createElement("a",{onClick:function(){e.setState({visible:!0}),n(Object(w.d)(t))},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#f9b724"}},"一键推送")))}}]}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"doSearch",value:function(e,t){var n=this,a=this.props,r=a.dispatch,i=a.pageData,c={title:a.search.title,currentPage:i.currPage,apiAdd:this.state.apiAdd};this.setState({loading:!0}),c=I({},c,t),r(Object(w.b)(e,c,function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.props.dispatch;this.doSearch("init",{currentPage:1,apiAdd:this.state.apiAdd}),e(Object(w.e)({currPage:1}))}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.props,n=t.dispatch,a=t.search;n(Object(w.e)({currPage:e})),this.doSearch(a.type,{currentPage:e,apiAdd:this.state.apiAdd})}},{key:"delFlash",value:function(e){var t=this.props.dispatch,n=this;R({title:"提示",content:"确认要删除吗 ?",onOk:function(){var a={id:e.id,status:-1};Object(A.i)("POST","/lives/status",I({},a),function(e){1===e.code?(u.a.success("删除成功"),n.doSearch("init"),t(Object(w.f)({type:"init"}))):u.a.error(e.msg)})}})}},{key:"submitAccount",value:function(){var e=this.props,t=e.dispatch,n=e.form,a=e.selectedData,r=this;n.validateFields(function(e,i){if(i.type="flash",i.id=a.id,i.terminal="1",i.content=i.notifyContent,i.createTime=Date.parse(new Date),e)return!1;R({title:"提示",content:"确认要推送本条快讯吗 ?",onOk:function(){t(Object(C.a)(i,function(){r.setState({visible:!1}),n.resetFields(),r.doSearch("init")}))}})})}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,a=t.pageData,i=t.search,o=t.dispatch,s=t.form,u=t.selectedData,p=s.getFieldDecorator;return k.a.createElement("div",{className:"flash-index"},k.a.createElement("span",{style:{marginLeft:15}},"发布状态："),k.a.createElement(f.a,{defaultValue:"",style:{width:100,marginBottom:10},onChange:this.handleChange},k.a.createElement(z,{value:""},"全部"),k.a.createElement(z,{value:"1"},"爬虫发布"),k.a.createElement(z,{value:"2"},"算法发布"),k.a.createElement(z,{value:"0"},"人工发布")),k.a.createElement("span",{style:{marginLeft:15}},"快讯标题/内容："),k.a.createElement(m.a,{onPressEnter:function(){e._search()},value:i.title,style:{width:150,marginRight:15},onChange:function(e){return o(Object(w.f)({title:e.target.value}))},placeholder:"请输入要搜索的内容"}),k.a.createElement(l.a,{type:"primary",style:{marginRight:15},onClick:function(){e._search()}},"搜索"),k.a.createElement(l.a,{type:"primary",onClick:function(){S.hashHistory.push("/flash-edit")}},"新增快讯"),k.a.createElement("div",{style:{marginTop:15}},k.a.createElement(r.a,{spinning:this.state.loading,size:"large"},k.a.createElement(c.a,{dataSource:n.map(function(e,t){return I({},e,{key:t})}),columns:V,bordered:!0,pagination:{current:a.currPage,total:a.totalCount,pageSize:a.pageSize,onChange:function(t){return e.changePage(t)}}}))),k.a.createElement(E.a,{title:"添加推送信息",visible:this.state.visible,onOk:function(){return e.submitAccount()},onCancel:this.cancelModal,footer:[k.a.createElement(l.a,{key:"back",onClick:this.cancelModal},"取消"),k.a.createElement(l.a,{key:"submit",type:"primary",onClick:function(){e.submitAccount()}},"确定")]},k.a.createElement(y.a,null,k.a.createElement(q,D({},G,{label:"推送类型"}),"快讯"),k.a.createElement(q,D({},G,{label:"目标用户"}),p("pastDays",{initialValue:"3",rules:[{required:!0,message:"请选择目标用户类型！"}]})(k.a.createElement(H,null,k.a.createElement(g.a,{value:"3"},"3日活跃"),k.a.createElement(g.a,{value:"7"},"7日活跃"),k.a.createElement(g.a,{value:"14"},"14日活跃"),k.a.createElement(g.a,{value:"0"},"全部"))),k.a.createElement("div",{style:{color:"rgb(255, 79, 62)"}},"推荐使用3日活跃，推送的目标用户过多会导致推送无法到达")),k.a.createElement(q,D({},G,{label:"快讯ID: "}),u.id?u.id:""),k.a.createElement(q,D({},G,{label:"推送标题: "}),p("title",{initialValue:u.id?Object(A.C)(u.content,!0):"",rules:[{required:!0,message:"请输入推送标题！"}]})(k.a.createElement(m.a,{placeholder:"推送标题"}))),k.a.createElement(q,D({},G,{label:"推送描述: "}),p("notifyContent",{initialValue:u.id?Object(A.D)(u.content):"",rules:[{required:!0,message:"请输入推送描述！"},{max:200,message:"推送描述保持在200字以内！"}]})(k.a.createElement(F,{rows:6,placeholder:"推送描述",maxLength:200}))))))}}])&&_(n.prototype,a),i&&_(n,i),t}();t.default=Object(j.connect)(function(e){return{selectedData:e.flashInfo.selectedData,flashInfo:e.flashInfo,list:e.flashInfo.list,search:e.flashInfo.search,pageData:e.flashInfo.pageData,flashTypeList:e.flashTypeListInfo}})(y.a.create()(J))},1621:function(e,t,n){"use strict";n.d(t,"b",function(){return s}),n.d(t,"a",function(){return u}),n.d(t,"d",function(){return f}),n.d(t,"c",function(){return d});n(361);var a=n(20),r=n.n(a),i=n(48),c=n(2);function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){l(e,t,n[t])})}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=function(e,t,n){return function(a){var c="init"===e?"/lives/publish/getrecordList":"/post/search";Object(i.i)("get",c,t?o({},t):{},function(e){if(1===e.code){var t=e.obj;a(p({list:t.inforList})),a(d({totalCount:t.recordCount,pageSize:t.pageSize,currPage:t.currentPage})),n&&n(t)}else r.a.error(e.msg)})}},u=function(e,t){return function(n){Object(i.i)("post","/lives/publish",o({},e),function(e){1===e.code?(r.a.success("推送成功！"),t&&t()):r.a.error(e.msg)})}},p=function(e){return{type:c.H.ADD_DATA,data:e}},f=function(e){return{type:c.H.SET_SEARCH_QUERY,data:e}},d=function(e){return{type:c.H.SET_PAGE_DATA,data:e}}}}]);