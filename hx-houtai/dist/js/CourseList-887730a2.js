(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{1508:function(e,t,n){"use strict";n.r(t);n(184);var r=n(1378),a=n.n(r),o=(n(675),n(676)),c=n.n(o),s=(n(1385),n(1386)),i=n.n(s),u=(n(1381),n(1382)),l=n.n(u),p=(n(1383),n(1384)),d=n.n(p),f=(n(247),n(183)),m=n.n(f),h=(n(361),n(20)),g=n.n(h),b=(n(1379),n(1380)),y=n.n(b),v=(n(677),n(362)),O=n.n(v),E=(n(1376),n(1377)),S=n.n(E),k=n(0),w=n.n(k),j=n(246),I=(n(1686),n(10)),P=n(1688),T=n(48),N=n(11),_=n.n(N);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(){return(D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){B(e,t,n[t])})}return e}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=S.a.confirm,q=O.a.Option,F=y.a.Item,H={labelCol:{xs:{span:2},sm:{span:4}},wrapperCol:{xs:{span:4},sm:{span:16}}},V=[],J=function(e){function t(){var e,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=L(t).call(this),e=!r||"object"!==C(r)&&"function"!=typeof r?M(n):r,B(M(e),"disabledDate",function(e){return e&&e<_()().endOf("hours")}),B(M(e),"handleChange",function(t){(0,e.props.dispatch)(Object(P.e)({status:t})),e.setState({newsStatus:t}),e.doSearch("init",{currentPage:1,status:t})}),B(M(e),"handleChange1",function(t){(0,e.props.dispatch)(Object(P.e)({recommend:t})),e.doSearch("init",{currentPage:1,recommend:t})}),B(M(e),"handleChange2",function(t){(0,e.props.dispatch)(Object(P.e)({ingOrEnd:t})),e.doSearch("init",{currentPage:1,ingOrEnd:t})}),e.state={loading:!0,newsStatus:null,courseId:""},e}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(t,k["Component"]),n=t,(r=[{key:"channelName",value:function(e){var t="";return this.props.lecturerList.map(function(n,r){parseInt(n.lecturerId)===e&&(t=n.name)}),t}},{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.search,r=t.filter;this.doSearch("init",x({},r,{title:n.title})),V=[].concat([{title:"标题",width:200,key:"name",render:function(t,n){return n&&w.a.createElement("div",{className:"course-info clearfix"},w.a.createElement("div",null,w.a.createElement("h4",{title:n.title,dangerouslySetInnerHTML:e.createMarkup(Object(T.q)(n.title,50))}),parseInt(n.recommend)?w.a.createElement("div",{style:{display:"inline-block",verticalAlign:"middle"}},w.a.createElement("span",{className:"org-bg mr10"},"推荐")):"",1!==n.mark?"":w.a.createElement("span",{className:"green-bg mr10"},"精品"),n.topOrder&&0!==parseInt(n.topOrder)?w.a.createElement("div",{style:{display:"inline-block",verticalAlign:"middle"},className:"news-top clearfix"},w.a.createElement("span",{className:"top-bg"},"置顶(",n.topOrder,")")):"",n.resType&&1===parseInt(n.resType)?w.a.createElement("span",{style:{background:"#6ac3ea"},className:"mr10"},"音频"):w.a.createElement("span",{style:{background:"#4382ea"},className:"mr10"},"视频")))}},{title:"状态",key:"status",width:80,render:function(e){return e&&2===e.status?w.a.createElement("span",{className:"course-status recommend-btn"},"推荐"):e&&1===e.status?w.a.createElement("span",{className:"course-status"},"上架"):e&&-1===e.status?w.a.createElement("span",{className:"course-status pre-publish"},"下架"):w.a.createElement("span",{className:"course-status will-publish"},"暂无")}},{title:"讲师",width:80,dataIndex:"lecturer",key:"lecturer"},{title:"课程信息",key:"message",width:100,render:function(e){return w.a.createElement("div",{className:"message"},w.a.createElement("p",null,"售价：",e.money," 元"),w.a.createElement("p",null,"时长：",e.duration?"".concat(parseInt(e.duration/60)," 分 ").concat(e.duration%60," 秒"):"0 秒"),w.a.createElement("p",null,"章节数：",e.chapterNums),w.a.createElement("p",null,"已售数：",e.buyNums))}},{title:"简介",key:"brief",width:220,render:function(t){return w.a.createElement("h4",{title:t.brief,dangerouslySetInnerHTML:e.createMarkup(Object(T.q)(t.brief,80))})}},{title:"创建时间",key:"createTime",width:80,render:function(t){return w.a.createElement("div",{style:{textAlign:"center"},dangerouslySetInnerHTML:e.createMarkup(Object(T.w)(t.createTime,"-",!0))})}}],[{title:"推荐",key:"option",width:110,render:function(t){return w.a.createElement("div",{className:"btns"},w.a.createElement("p",null,w.a.createElement("a",{className:"mr10 recommend-btn opt-btn ".concat(-1===t.status?"disabled":""),href:"javascript:void(0)",onClick:function(){return e.isRecommend(t)},disabled:-1===t.status&&!0},1===t.recommend?"取消推荐":"推荐到轮播")))}},{title:"操作",key:"action",width:130,render:function(t){return w.a.createElement("div",{className:"btns"},w.a.createElement("p",null,w.a.createElement(I.Link,{className:"mr10 opt-btn",to:{pathname:"/college-courseSend",query:{id:t.resourceId}},style:{background:"#e35ba3"}},"编辑")),w.a.createElement("p",null,w.a.createElement("a",{disabled:1!==t.status&&0!==t.status,className:"mr10 opt-btn",href:"javascript:void(0)",onClick:function(){return e._isPublish(t)},style:{background:"#00a854"}},1===t.status||2===t.status?"下架":-1===t.status?"上架":"不可操作")),w.a.createElement("p",null,w.a.createElement(I.Link,{className:"mr10 opt-btn",to:{pathname:"/college-chapterList",query:{id:t.resourceId}},style:{background:"#58b1ea"}},"章节列表")))}}])}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e(Object(P.g)({type:"init",nickName:""})),e(Object(P.f)({pageSize:20,totalCount:0}))}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"cancelTop",value:function(e){var t=this.props.dispatch,n=this;R({title:"提示",content:"确认要取消置顶吗 ?",onOk:function(){var r={id:e,topOrder:0};Object(T.i)("POST","/course/settoporder",x({},r),function(e){1===e.code?(g.a.success("取消置顶成功"),n.doSearch("init"),t(Object(P.g)({type:"init"}))):g.a.error(e.msg)})}})}},{key:"showToTopModal",value:function(e,t){var n=this.props.dispatch;this.setState({courseId:e,topIsShow:!0}),n(Object(P.d)(t))}},{key:"setNewsTop",value:function(){var e=this,t=this.props.form,n=this;t.validateFields(function(r,a){r||(e.setState({topIsShow:!1}),Object(T.i)("post","/course/settoporder",{id:e.state.courseId,topOrder:a.order},function(e){1===e.code?(g.a.success("操作成功！"),n.doSearch("init")):g.a.error(e.msg)}),t.resetFields())})}},{key:"changeTopValue",value:function(e,t){var n=this.props.dispatch,r=e.target.value;0!==parseInt(r)?n(Object(P.a)({topOrder:r},t.key)):g.a.warning("置顶权重值不能为0！")}},{key:"_editTopValue",value:function(e,t){var n=e.target.value,r=t.id;n?/^\d+$/.test(n)?this.newsIsToTop({id:r,topOrder:n}):g.a.warning("置顶权重值必须是整数！"):g.a.warning("请输入置顶权重值！")}},{key:"doSearch",value:function(e,t){var n=this,r=this.props,a=r.dispatch,o=r.pageData,c=x({},r.filter,{pageSize:20,currentPage:o.currPage});this.setState({loading:!0}),c=x({},c,t),a(Object(P.c)("init",c,function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.props,t=e.dispatch,n=e.search,r="init";r=(n.nickName||n.title,"init"),this.doSearch(r,{currentPage:1}),t(Object(P.g)({type:r})),t(Object(P.f)({currPage:1}))}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.props,n=t.dispatch,r=t.search,a=t.filter;n(Object(P.f)({currPage:e})),this.doSearch(r.type,x({currentPage:e},a))}},{key:"delCourse",value:function(e){var t=this.props.dispatch,n=this;R({title:"提示",content:"确认要删除吗 ?",onOk:function(){var r={id:e.id,status:-1};Object(T.i)("POST","/course/status",x({},r),function(e){1===e.code?(g.a.success("删除成功"),n.doSearch("init"),t(Object(P.g)({type:"init"}))):g.a.error(e.msg)})}})}},{key:"_isPublish",value:function(e){var t=this.props.dispatch,n=this;R({title:"提示",content:"确认要".concat(1===e.status?"下架":"上架","吗 ?"),onOk:function(){n.setState({loading:!0});var r={resourceId:e.resourceId,status:-1===e.status?1:-1};Object(T.i)("POST","/college/lesson/update",x({},r),function(r){n.setState({loading:!1}),1===r.code?(g.a.success("".concat(1===e.status?"下架":"上架","成功")),n.doSearch("init"),t(Object(P.g)({type:"init"}))):g.a.error(r.msg)})}})}},{key:"isRecommend",value:function(e){var t=this;R({title:"提示",content:"确认要".concat(2===e.status?"撤销推荐（从轮播位撤回）":"推荐到轮播位","吗 ?"),onOk:function(){t.setState({loading:!0});var n={resourceId:e.resourceId,status:2===e.status?1:2};Object(T.i)("POST","/college/lesson/update",n,function(e){t.setState({loading:!1}),1===e.code?(g.a.success("操作成功"),t.doSearch("init")):g.a.error(e.msg)})}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,r=t.pageData,o=t.filter,s=t.form,u=t.selectedData,p=s.getFieldDecorator;return w.a.createElement("div",{className:"course-index"},w.a.createElement(l.a,null,w.a.createElement(d.a,null,w.a.createElement("span",null,"未发布/已发布："),w.a.createElement(O.a,{defaultValue:"".concat(o.status),style:{width:100,marginBottom:10},onChange:this.handleChange},w.a.createElement(q,{value:""},"全部"),w.a.createElement(q,{value:"1"},"上架"),w.a.createElement(q,{value:"-1"},"下架"),w.a.createElement(q,{value:"2"},"推荐")),w.a.createElement(m.a,{type:"primary",style:{margin:"0 0 0 15px"},onClick:function(){I.hashHistory.push("/college-courseSend")}},"新增"))),w.a.createElement("div",{className:"mt10"},w.a.createElement(c.a,{spinning:this.state.loading,size:"large"},w.a.createElement(i.a,{dataSource:n.map(function(e,t){return x({},e,{key:t})}),columns:V,bordered:!0,pagination:{current:r.currPage,total:r.totalCount,pageSize:r.pageSize,onChange:function(t){return e.changePage(t)}}}))),w.a.createElement(S.a,{title:"置顶权重",visible:this.state.topIsShow,onOk:function(){return e.setNewsTop()},onCancel:function(){e.setState({topIsShow:!1}),s.resetFields()}},w.a.createElement(y.a,null,w.a.createElement(F,D({},H,{label:"置顶权重"}),p("order",{rules:[{required:!0,message:"请输入置顶权重!"},{pattern:/^[1-9]\d*$/,message:"设置权重必须大于0!"}],initialValue:0===u.topOrder?1:u.topOrder})(w.a.createElement(a.a,{min:1}))))))}}])&&A(n.prototype,r),o&&A(n,o),t}();t.default=Object(j.connect)(function(e){return{courseInfo:e.courseInfo,list:e.courseInfo.list,search:e.courseInfo.search,filter:e.courseInfo.filter,pageData:e.courseInfo.pageData,selectedData:e.courseInfo.selectedData,lecturerList:e.lecturerInfo.list}})(y.a.create()(J))},1686:function(e,t,n){var r=n(1687);"string"==typeof r&&(r=[[e.i,r,""]]);var a={transform:void 0};n(186)(r,a);r.locals&&(e.exports=r.locals)},1687:function(e,t,n){(e.exports=n(185)(!1)).push([e.i,"",""])},1688:function(e,t,n){"use strict";n.d(t,"d",function(){return u}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return p}),n.d(t,"a",function(){return f}),n.d(t,"g",function(){return m}),n.d(t,"e",function(){return h}),n.d(t,"f",function(){return g});n(361);var r=n(20),a=n.n(r),o=n(48),c=n(2);function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){i(e,t,n[t])})}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(e){return{type:c.xb,data:e}},l=function(e,t,n){return function(r){var c="init"===e?"/college/lesson/list":"/post/search";Object(o.i)("get",c,t?s({},t):{},function(e){if(1===e.code){var t=e.obj;r(d({list:t.inforList})),r(g({totalCount:t.recordCount,pageSize:t.pageSize,currPage:t.currentPage})),n&&n(t)}else e.msg&&a.a.error(e.msg)})}},p=function(e,t){return function(n){Object(o.i)("post","/college/lesson/getById",s({},e),function(e){if(1===e.code){var r=e.obj;n(d({info:r})),t&&t(r)}else a.a.error(e.msg)})}},d=function(e){return{type:c.B.ADD_DATA,data:e}},f=function(e,t){return{type:c.B.EDIT_LIST_ITEM,data:e,index:t}},m=function(e){return{type:c.B.SET_SEARCH_QUERY,data:e}},h=function(e){return{type:c.B.SET_FILTER_DATA,data:e}},g=function(e){return{type:c.B.SET_PAGE_DATA,data:e}}}}]);