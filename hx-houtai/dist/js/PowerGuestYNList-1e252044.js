(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{1555:function(e,t,a){"use strict";a.r(t);a(675);var n=a(676),r=a.n(n),i=(a(1385),a(1386)),o=a.n(i),l=(a(1381),a(1382)),s=a.n(l),u=(a(1383),a(1384)),c=a.n(u),p=(a(247),a(183)),m=a.n(p),d=(a(184),a(1378)),g=a.n(d),f=(a(361),a(20)),h=a.n(f),y=(a(1376),a(1377)),b=a.n(y),v=(a(677),a(362)),w=a.n(v),S=a(0),E=a.n(S),C=a(246),O=(a(1388),a(1389)),k=a.n(O),j=(a(1390),a(1391)),P=a.n(j),I=(a(1387),a(50)),V=a.n(I),N=(a(678),a(363)),_=a.n(N),U=(a(1379),a(1380)),T=a.n(U),x=a(48);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(){return(L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function H(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var z=T.a.Item,F=_.a.Group,A=function(e){function t(e){var a,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=M(t).call(this,e),a=!r||"object"!==q(r)&&"function"!=typeof r?D(n):r,R(D(a),"handleCancel",function(){return a.setState({previewVisible:!1})}),R(D(a),"handlePreview",function(e){a.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})}),R(D(a),"handleChange",function(e){var t=e.file,n=e.fileList;a.setState({fileList:n}),"removed"===t.status&&a.setState({imgUrl:""}),t.response&&(1===t.response.code&&"done"===t.status&&(a.setState({imgUrl:t.response.obj}),a.props.getImgData(t.response.obj)),"error"===t.status&&(h.a.error("网络错误，上传失败！"),a.setState({imgUrl:"",fileList:[]})))}),R(D(a),"onCancel",function(){a.setState({previewVisible:!0})}),a.state={previewVisible:!1,previewImage:"",fileList:[],imgUrl:"",loading:!0},a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,S["Component"]),a=t,(n=[{key:"componentWillMount",value:function(){var e=[{uid:"-1",name:"xxx.png",status:"done",url:this.props.data.guestHeadUrl}];this.setState({fileList:this.props.data.guestHeadUrl?e:[]})}},{key:"guestSubmit",value:function(){var e=this,t=this;this.props.form.validateFields(function(a,n){if(a)return!1;var r=e.state.imgUrl||e.props.data.guestHeadUrl,i=e.props.data.id?"/power4/updateGuest":"/power4/addGuest";Object(x.i)("POST",i,{id:e.props.data.id,guestName:n.guestName,guestCompany:n.guestCompany,guestIntroduce:n.guestIntroduce,guestSeq:n.guestSeq,guestHeadUrl:r,guestType:n.guestType},function(a){1===a.code&&(e.props.onCancel(),location.reload(),t.setState({loading:!1}))})})}},{key:"render",value:function(){var e=this,t=this.props,a=t.visible,n=t.onCancel,r=t.form,i=t.loading,o=t.data,l=r.getFieldDecorator,s={labelCol:{span:4},wrapperCol:{span:18,offset:1}},u=E.a.createElement("div",null,E.a.createElement(V.a,{type:"plus"}),E.a.createElement("div",{className:"ant-upload-text"},"上传图片"));return E.a.createElement(b.a,{visible:a,title:"添加/编辑 本期嘉宾",okText:"确定",onCancel:n,onOk:function(){e.guestSubmit()},confirmLoading:i},E.a.createElement(T.a,null,E.a.createElement(z,L({},s,{label:"嘉宾姓名"}),l("guestName",{initialValue:o.id?o.guestName:"",rules:[{required:!0,message:"请输入嘉宾姓名！"}]})(E.a.createElement(g.a,null))),E.a.createElement(z,L({},s,{className:"collection-create-form_last-form-item",label:"嘉宾公司"}),l("guestCompany",{initialValue:o.id?o.guestCompany:""})(E.a.createElement(g.a,null))),E.a.createElement(z,L({},s,{label:"嘉宾介绍"}),l("guestIntroduce",{initialValue:o.id?o.guestIntroduce:"",rules:[{required:!0,message:'请输入嘉宾介绍"！'}]})(E.a.createElement(g.a,{rows:4,type:"textarea"}))),E.a.createElement(z,L({},s,{label:"选择类型"}),l("guestType",{initialValue:o.id?o.guestType:0,rules:[{required:!0,message:"请选择类型！"}]})(E.a.createElement(F,null,E.a.createElement(_.a,{value:0},"本期嘉宾"),E.a.createElement(_.a,{value:1},"往期嘉宾")))),E.a.createElement(z,L({},s,{className:"collection-create-form_last-form-item",label:"排序权重"}),l("guestSeq",{initialValue:o.id?o.guestSeq:0,rules:[{required:!0,message:"请输入排序权重！"}]})(E.a.createElement(P.a,{placeholder:"权重越大排序越靠前"}))),E.a.createElement(z,L({},s,{label:"头像",className:"upload-div"}),E.a.createElement("div",{className:"dropbox"},l("guestHeadUrl",{initialValue:o.id?o.guestHeadUrl:"",rules:[{required:!0,message:"请上传嘉宾头像！"}]})(E.a.createElement(k.a,{headers:{"Sign-Param":Object(x.A)()},action:"".concat(x.a,"/picture/upload"),name:"uploadFile",data:{type:"news"},listType:"picture-card",fileList:this.state.fileList,onPreview:this.handlePreview,onChange:this.handleChange},this.state.fileList.length>=1?null:u)),E.a.createElement(b.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancel},E.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage})),E.a.createElement("span",{className:"cover-img-tip",style:{display:"inline-block",marginTop:"70px",position:"absolute"}},"用于直播页面头像展示, 长宽比例: ",E.a.createElement("font",{style:{color:"red"}},"1 : 1"))))))}}])&&H(a.prototype,n),r&&H(a,r),t}(),J=T.a.create()(A),W=(a(1629),a(1630));function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){$(e,t,a[t])})}return e}function K(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(e,t){return(Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ee=w.a.Option,te=b.a.confirm,ae=[],ne=function(e){function t(){var e,a,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,n=Q(t).call(this),e=!n||"object"!==Y(n)&&"function"!=typeof n?X(a):n,$(X(e),"getOrderNum",function(t){e.setState({order:t})}),$(X(e),"showModal",function(){e.setState({data:{visible:!0}})}),$(X(e),"handleCancel",function(){e.setState({data:{visible:!1}})}),$(X(e),"getImgUrl",function(t){e.setState({imgUrl:t})}),$(X(e),"handleChange",function(t){e.setState({typeVal:t}),e.doSearch("",1,t)}),$(X(e),"handleImgModalCancel",function(){return e.setState({previewVisible:!1})}),$(X(e),"handlePreview",function(t){e.setState({previewImage:t.target.getAttribute("src"),previewVisible:!0})}),$(X(e),"handleCompile",function(t){console.log(t),e.setState({data:{id:t.id,visible:!0,guestName:t.guestName,guestCompany:t.guestCompany,guestIntroduce:t.guestIntroduce,guestSeq:t.guestSeq,guestHeadUrl:t.guestHeadUrl,guestType:t.guestType}})}),e.state={loading:!0,typeVal:"0",data:{visible:!1,id:"",guestName:"",guestCompany:"",guestIntroduce:"",guestSeq:"",guestHeadUrl:"",guestType:""},searchVal:"",imgUrl:"",previewVisible:!1,previewImage:"",order:1,confirmLoading:!1},e}var a,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z(e,t)}(t,S["Component"]),a=t,(n=[{key:"componentWillMount",value:function(){var e=this;this.doSearch("",1,0),ae=[{title:"嘉宾名",key:"guestName",render:function(t,a){return E.a.createElement("h4",{title:a.guestName,dangerouslySetInnerHTML:e.createMarkup(Object(x.q)(a.guestName,30))})}},{title:"公司",key:"guestCompany",render:function(e){return e.guestCompany?E.a.createElement("h4",{title:e.guestCompany},e.guestCompany):"无"}},{title:"头像 ",dataIndex:"guestHeadUrl",key:"guestHeadUrl",render:function(t){return E.a.createElement("img",{className:"shrinkPic",key:t,src:t,onClick:e.handlePreview})}},{title:"嘉宾简介",key:"guestIntroduce",render:function(e){return e.guestIntroduce?E.a.createElement("h4",{title:e.guestIntroduce},e.guestIntroduce):"无"}},{title:"排序",key:"guestSeq",render:function(e){return E.a.createElement("p",null,e.guestSeq)}},{title:"操作",key:"action",render:function(t){return E.a.createElement("div",null,E.a.createElement("p",null,E.a.createElement("a",{onClick:function(){e.handleCompile(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#108ee9"}},"编辑")),E.a.createElement("p",{style:{marginTop:10}},E.a.createElement("a",{onClick:function(){return e.delIco(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#d73435"}},"删除")))}}]}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"doSearch",value:function(e,t,a){var n=this;this.setState({loading:!0});var r={guestType:a,keyword:e,pageSize:20,currentPage:t};(0,this.props.dispatch)(Object(W.d)(r,function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.state.searchVal;this.doSearch(e,1,this.state.typeVal)}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.state.searchVal;this.doSearch(t,e,this.state.typeVal)}},{key:"delIco",value:function(e){var t=this.props.pageData,a=this;te({title:"提示",content:"确认要删除吗 ?",onOk:function(){var n={id:e.id};Object(x.i)("POST","/power4/delete/guest",B({},n),function(e){1===e.code?(h.a.success("删除成功"),a.doSearch("",t.page)):h.a.error(e.msg)})}})}},{key:"searchValue",value:function(e){var t=e.target.value;this.setState({searchVal:t})}},{key:"render",value:function(){var e=this,t=this.props,a=t.list,n=t.pageData;return E.a.createElement("div",{className:"powerGuest-index"},E.a.createElement(s.a,null,E.a.createElement(c.a,null,E.a.createElement("span",null,"选择类型："),E.a.createElement(w.a,{defaultValue:"0",onChange:this.handleChange,style:{width:100,marginRight:15}},E.a.createElement(ee,{value:"0"},"本期嘉宾"),E.a.createElement(ee,{value:"1"},"往期嘉宾")),E.a.createElement(g.a,{style:{width:200,marginRight:"10px"},placeholder:"嘉宾姓名",onChange:function(t){e.searchValue(t)},onPressEnter:function(){e._search()}}),E.a.createElement(m.a,{type:"primary",onClick:function(){e._search()},style:{marginRight:"20px"}},"搜索"),E.a.createElement(m.a,{type:"primary",onClick:this.showModal},"新增嘉宾"))),E.a.createElement("div",{className:"mt30"},E.a.createElement(r.a,{spinning:this.state.loading,size:"large"},E.a.createElement(o.a,{dataSource:a.map(function(e,t){return B({},e,{key:t})}),columns:ae,bordered:!0,pagination:{current:n.page,total:n.recordCount,pageSize:n.pageSize,onChange:function(t){return e.changePage(t)}}}))),E.a.createElement(b.a,{className:"pre-Modal",visible:this.state.previewVisible,footer:null,onCancel:this.handleImgModalCancel},E.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage})),this.state.data.visible&&E.a.createElement(J,{loading:this.state.confirmLoading,visible:this.state.data.visible,data:this.state.data,onCancel:this.handleCancel,getImgData:function(t){e.getImgUrl(t)}}))}}])&&K(a.prototype,n),i&&K(a,i),t}();t.default=Object(C.connect)(function(e){return{list:e.powerYNGuestList.list,pageData:e.powerYNGuestList.pageData}})(ne)}}]);