(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{1563:function(e,t,n){"use strict";n.r(t);n(675);var a=n(676),r=n.n(a),o=(n(1385),n(1386)),c=n.n(o),i=(n(1381),n(1382)),l=n.n(i),u=(n(1383),n(1384)),s=n.n(u),p=(n(247),n(183)),f=n.n(p),m=(n(361),n(20)),h=n.n(m),d=(n(1379),n(1380)),b=n.n(d),y=(n(678),n(363)),g=n.n(y),v=(n(184),n(1378)),k=n.n(v),E=(n(1376),n(1377)),O=n.n(E),S=n(0),w=n.n(S),I=n(246),A=(n(1805),n(48)),P=n(2);function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){N(e,t,n[t])})}return e}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var C=function(e){return{type:P.xb,data:e}},D=function(e){return{type:P.Z.ADD_DATA,data:e}},_=function(e){return{type:P.Z.SET_SEARCH_QUERY,data:e}},M=function(e){return{type:P.Z.SET_PAGE_DATA,data:e}};function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){Z(e,t,n[t])})}return e}function F(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G=O.a.confirm,H=k.a.TextArea,J=g.a.Group,L={labelCol:{sm:{span:6}},wrapperCol:{sm:{span:16}}},U=[],W=b.a.Item,B=function(e){function t(){var e,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=R(t).call(this),e=!a||"object"!==x(a)&&"function"!=typeof a?q(n):a,Z(q(e),"cancelModal",function(){e.props.form.resetFields(),e.setState({phone:"",authorInfo:{},visible:!1})}),Z(q(e),"checkAuthor",function(){Object(A.i)("post","/account/getaccountinfo",{phoneNumOrNickName:e.state.phone},function(t){1===t.code?(h.a.success("查询成功！"),e.setState({authorInfo:t.obj})):-1===t.code&&h.a.error("未查询到此账号！")})}),Z(q(e),"setPhone",function(t){e.setState({phone:t.target.value,authorInfo:{}})}),e.state={loading:!0,newsStatus:null,editNewsId:"",visible:!1,confirmDirty:!1,phone:"",authorInfo:{}},e}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,S["Component"]),n=t,(a=[{key:"channelName",value:function(e){var t="";return A.p.map(function(n,a){parseInt(n.value)===e&&(t=n.label)}),t}},{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.search,a=t.filter;this.doSearch("init",z({},a,{value:n.value})),U=[{title:"昵称",key:"nickName",render:function(t,n){return n&&w.a.createElement("div",{className:"managerAccount-info clearfix"},w.a.createElement("div",null,w.a.createElement("h3",{title:n.title,dangerouslySetInnerHTML:e.createMarkup(Object(A.q)(n.nickName,30))})))}},{title:"身份",dataIndex:"role",key:"role",render:function(e){return 3===e?"超级管理员":2===e?"后台管理员":5===e?"MarsBit中国行管理":6===e?"广告数据管理":4===e?"推送管理员":7===e?"实习编辑":void 0}},{title:"登陆名/手机号 ",dataIndex:"phoneNum",key:"phoneNum",render:function(e){return e||"--"}},{title:"账号 ID ",dataIndex:"passportId",key:"passportId"},{with:100,title:"备注",key:"remarks",render:function(e){return e&&e.remarks?w.a.createElement("span",null,e.remarks):w.a.createElement("span",null)}},{width:120,title:"用户实名认证",key:"realAuth",render:function(e){return e&&1===e.realAuth?w.a.createElement("span",{className:"news-status"},"已实名认证"):e&&-1===e.realAuth?w.a.createElement("span",{className:"news-status cont-publish"},"实名认证未通过"):e&&0===e.realAuth?w.a.createElement("span",{className:"news-status pre-publish"},"待审核"):w.a.createElement("span",{className:"news-status not-publish"},"未提交审核")}},{width:120,title:"操作",key:"action",render:function(t){return w.a.createElement("div",{className:"btns"},w.a.createElement("p",null,w.a.createElement("a",{onClick:function(){return e.updManagerAccount(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#199ede"}},"修改管理员")),w.a.createElement("p",{style:{marginTop:10}},w.a.createElement("a",{disabled:3===t.role,onClick:function(){return e.delManagerAccount(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"".concat(3!==t.role?"#d73435":"#5d555c")}},"取消管理员")))}}]}},{key:"componentWillUnmount",value:function(){(0,this.props.dispatch)(M({pageSize:20,totalCount:0}))}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"doSearch",value:function(e,t){var n=this,a=this.props,r=a.dispatch,o=a.pageData,c=a.search,i=z({},a.filter,{value:c.value,pageSize:20,currentPage:o.currPage});r(function(e,t,n){return function(a){var r="init"===e?"/account/editor/list":"/post/search";Object(A.i)("get",r,t?j({},t):{},function(e){if(1===e.code){var t=e.obj;a(D({list:t.inforList})),a(M({totalCount:t.recordCount,pageSize:t.pageSize,currPage:t.currentPage})),n&&n(t)}else h.a.error(e.msg)})}}(e,i=z({},i,t),function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.props.dispatch;this.doSearch("init",{currentPage:1}),e(_({type:"init"})),e(M({currPage:1}))}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.props,n=t.dispatch,a=t.search,r=t.filter;n(M({currPage:e})),this.doSearch(a.type,z({currentPage:e},r))}},{key:"delManagerAccount",value:function(e){var t=this.props.dispatch,n=this;G({title:"提示",content:"确认要取消 ".concat(e.nickName," 的管理员权限吗 ?"),onOk:function(){var a={role:1,passportId:e.passportId};Object(A.i)("POST","/account/editor/updaterole",z({},a),function(e){1===e.code?(h.a.success("操作成功"),n.doSearch("init"),t(_({type:"init"}))):h.a.error(e.msg)})}})}},{key:"updManagerAccount",value:function(e){(0,this.props.dispatch)(C(e)),this.setState({visible:!0,authorInfo:e})}},{key:"submitAccount",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.form;a.validateFields(function(t,r){if(t)return!1;console.log(r.role);var o={passportId:e.state.authorInfo.passportId,role:r.role,remarks:r.remarks};n(function(e,t){return function(n){Object(A.i)("post","/account/editor/updaterole",j({},e),function(e){1===e.code?(h.a.success("添加成功！"),t&&t()):h.a.error(e.msg)})}}(o,function(){e.setState({phone:"",authorInfo:{},visible:!1}),a.resetFields(),e.doSearch("init")}))})}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,a=t.pageData,o=t.dispatch,i=t.form,u=t.selectedData,p=i.getFieldDecorator;return w.a.createElement("div",{className:"managerAccount-index"},w.a.createElement(l.a,null,w.a.createElement(s.a,null,w.a.createElement(f.a,{type:"primary",style:{margin:0},onClick:function(){e.setState({visible:!0}),o(C({}))}},"新增/修改管理员"))),w.a.createElement("div",{className:"mt30"},w.a.createElement(r.a,{spinning:this.state.loading,size:"large"},w.a.createElement(c.a,{dataSource:n.map(function(e,t){return z({},e,{key:t})}),columns:U,bordered:!0,pagination:{current:a.currPage,total:a.totalCount,pageSize:a.pageSize,onChange:function(t){return e.changePage(t)}}}))),w.a.createElement(O.a,{title:"添加/修改管理员",visible:this.state.visible,onOk:function(){return e.submitAccount()},onCancel:this.cancelModal,footer:[w.a.createElement(f.a,{key:"back",onClick:this.cancelModal},"取消"),w.a.createElement(f.a,{disabled:!this.state.authorInfo.passportId,key:"submit",type:"primary",onClick:function(){e.submitAccount()}},"确定")]},w.a.createElement(b.a,null,w.a.createElement(W,T({},L,{label:"手机号/昵称"}),p("phoneNumOrNickName",{rules:[{required:!0,message:"请输入手机号/昵称!"}],initialValue:u.phoneNum||""})(w.a.createElement(k.a,{placeholder:"输入手机号/昵称进行搜索",onPressEnter:this.checkAuthor,type:"tel",style:{width:"75%",marginRight:"4%"},onChange:function(t){e.setPhone(t)}})),w.a.createElement(f.a,{type:"primary",onClick:this.checkAuthor},"查询")),this.state.authorInfo&&void 0!==this.state.authorInfo.nickName?w.a.createElement(W,T({},L,{label:"查询结果"}),p("authorInfo")(w.a.createElement("span",null,this.state.authorInfo.nickName))):"",w.a.createElement(W,T({},L,{label:"管理员权限"}),p("role",{initialValue:String(u.role)||"2"})(w.a.createElement(J,null,w.a.createElement(g.a,{disabled:!0,value:"3"},"超级管理员"),w.a.createElement(g.a,{value:"2"},"后台管理员"),w.a.createElement(g.a,{value:"7"},"实习编辑")))),w.a.createElement(W,T({},L,{label:"备注"}),p("remarks",{rules:[{required:!0,message:"备注必须输入，不然就忘了！"}],initialValue:u.remarks||""})(w.a.createElement(H,{rows:4,className:"remarks",placeholder:"识别用户"}))))))}}])&&F(n.prototype,a),o&&F(n,o),t}();t.default=Object(I.connect)(function(e){return{managerAccountInfo:e.managerAccountInfo,list:e.managerAccountInfo.list,search:e.managerAccountInfo.search,filter:e.managerAccountInfo.filter,pageData:e.managerAccountInfo.pageData,selectedData:e.managerAccountInfo.selectedData}})(b.a.create()(B))},1805:function(e,t,n){var a=n(1806);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(186)(a,r);a.locals&&(e.exports=a.locals)},1806:function(e,t,n){(e.exports=n(185)(!1)).push([e.i,"",""])}}]);