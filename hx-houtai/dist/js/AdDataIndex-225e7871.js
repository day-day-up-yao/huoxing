(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{1500:function(e,t,a){"use strict";a.r(t);a(675);var n=a(676),r=a.n(n),i=(a(1385),a(1386)),c=a.n(i),o=(a(247),a(183)),l=a.n(o),s=(a(184),a(1378)),u=a.n(s),p=(a(361),a(20)),d=a.n(p),f=(a(1379),a(1380)),m=a.n(f),h=(a(1376),a(1377)),b=a.n(h),y=a(0),g=a.n(y),v=a(246),k=(a(1706),a(1408)),E=a.n(k),O=a(10),j=a(1707),S=a(48);function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(){return(P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){T(e,t,a[t])})}return e}function I(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var N=b.a.confirm,A=m.a.Item,M=[],q={labelCol:{sm:{span:6}},wrapperCol:{sm:{span:16}}},z=function(e){function t(){var e,a,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,n=C(t).call(this),e=!n||"object"!==w(n)&&"function"!=typeof n?_(a):n,T(_(e),"cancelModal",function(){e.props.form.resetFields(),e.setState({visible:!1})}),T(_(e),"tableExport",function(){var t=e.props.search;N({title:"提示",content:"确定要导出Excel表格么?",onOk:function(){Object(S.i)("post","/statistic/exportExcel",{sortType:1,like:t.like},function(e){1===e.code?(window.open(e.obj),d.a.success("已导出数据, 若没有自动下载, 请检查窗口是否被浏览器拦截~")):d.a.error("请求出错!")})}})}),e.state={visible:!1,loading:!0,sortType:"1",terminal:"1, 2"},e}var a,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,y["Component"]),a=t,(n=[{key:"componentWillMount",value:function(){var e=this,t=this.props,a=t.dispatch,n=t.search;this.doSearch(n.type?n.type:"init"),M=[{title:"链接名称",key:"name",width:280,render:function(e,t){return g.a.createElement("div",{className:"adData-info clearfix"},g.a.createElement("div",null,g.a.createElement("h3",null,t.name)))}},{title:"统计链接",key:"url",render:function(e,t){return g.a.createElement("h3",{className:"adData-info clearfix"},g.a.createElement("a",{target:"_black",href:"".concat(t.url,"?statisticalParameter=").concat(t.statisticId)},"".concat(t.url,"?statisticalParameter=").concat(t.statisticId)))}},{title:"添加时间",key:"createTime",render:function(e,t){return Object(S.w)(t.createTime)}},{title:"点击量(pv)",key:"pv",render:function(e,t){return t.count}},{title:"操作",key:"action",width:100,render:function(t){return g.a.createElement("div",{className:"btns"},g.a.createElement("p",null,g.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){O.hashHistory.push({pathname:"/adData-detail",query:{time:t.createTime,id:t.statisticId}})},style:{background:"#469ded"}},"查看")),g.a.createElement("p",null,g.a.createElement("a",{className:"mr10 opt-btn",style:{background:"#e35ba3"},onClick:function(){e.setState({visible:!0}),a(Object(j.d)(t))}},"修改")),g.a.createElement("p",null,g.a.createElement("a",{onClick:function(){return e.delAdData(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#d73435"}},"删除")))}}]}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"doSearch",value:function(e,t){var a=this,n=this.props,r=n.dispatch,i=n.pageData,c=n.search,o={sortType:this.state.sortType,like:c.like,currentPage:i.currPage};this.setState({loading:!0}),o=D({},o,t),r(Object(j.c)(e,o,function(){a.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.props.dispatch;this.doSearch("init",{currentPage:1}),e(Object(j.e)({currPage:1}))}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.props,a=t.dispatch,n=t.search;a(Object(j.e)({currPage:e})),this.doSearch(n.type,{currentPage:e})}},{key:"delAdData",value:function(e){var t=this.props.dispatch,a=this;N({title:"提示",content:"确认要删除本条记录吗 删除后不可恢复?",onOk:function(){var n={statisticId:e.statisticId};Object(S.i)("POST","/statistic/delete",D({},n),function(e){1===e.code?(d.a.success("删除成功"),a.doSearch("init"),t(Object(j.g)({type:"init"}))):d.a.error(e.msg)})}})}},{key:"submitAccount",value:function(){var e=this,t=this.props,a=t.dispatch,n=t.form,r=t.selectedData,i=this;n.validateFields(function(t,c){if(t)return!1;r.id?N({title:"提示",content:"确认要修改统计项名称吗?",onOk:function(){Object(S.i)("post","/statistic/updateName",{name:c.name,statisticId:r.statisticId},function(e){1===e.code&&(d.a.success("修改成功!"),i.setState({visible:!1}),a(Object(j.d)({})),i.doSearch("init"))})}}):a(Object(j.a)(c,function(t){i.setState({loading:!0}),1===t.code?(i.setState({loading:!1,visible:!1}),N({title:"提示",content:g.a.createElement("div",null,g.a.createElement("p",{style:{wordBreak:"break-all"}},"统计链接",c.url,"?statisticalParameter=$",c.statisticId," 创建成功"),g.a.createElement("p",null,"请先反馈技术添加后方可开始统计。"),g.a.createElement("p",null,"点击 ",g.a.createElement("span",{style:{fontSize:"16px"}}," 确定 "),"可自动复制链接。")),onOk:function(){E()("".concat(c.url,"?statisticalParameter=").concat(c.statisticId)),d.a.success("链接复制成功！")}}),n.resetFields(),e.doSearch("init")):(i.setState({loading:!1}),d.a.error(t.msg||"请求失败，请稍后重试"))}))})}},{key:"render",value:function(){var e=this,t=this.props,a=t.list,n=t.pageData,i=t.search,o=t.dispatch,s=t.form,p=t.selectedData,d=s.getFieldDecorator;return g.a.createElement("div",{className:"adData-index"},g.a.createElement("span",{style:{marginLeft:15}},"标题/内容："),g.a.createElement(u.a,{onPressEnter:function(){e._search()},value:i.like,style:{width:150,marginRight:15},onChange:function(e){return o(Object(j.g)({like:e.target.value}))},placeholder:"请输入要搜索的内容"}),g.a.createElement(l.a,{type:"primary",onClick:function(){e._search()}},"搜索"),g.a.createElement(l.a,{type:"primary",style:{margin:"0 15px"},onClick:function(){e.setState({visible:!0}),o(Object(j.d)({}))}},"新增"),g.a.createElement(l.a,{type:"primary",onClick:this.tableExport},"导出统计项"),g.a.createElement("div",{style:{marginTop:15}},g.a.createElement(r.a,{spinning:this.state.loading,size:"large"},g.a.createElement(c.a,{dataSource:a.map(function(e,t){return D({},e,{key:t})}),columns:M,bordered:!0,pagination:{current:n.currPage,total:n.totalCount,pageSize:n.pageSize,onChange:function(t){return e.changePage(t)}}}))),g.a.createElement(b.a,{title:"添加/修改统计项",visible:this.state.visible,onOk:function(){return e.submitAccount()},onCancel:this.cancelModal,footer:[g.a.createElement(l.a,{key:"back",onClick:this.cancelModal},"取消"),g.a.createElement(l.a,{key:"submit",type:"primary",onClick:function(){e.submitAccount()}},"确定")]},g.a.createElement(m.a,null,g.a.createElement(A,P({},q,{label:"名称/位置说明"}),d("name",{initialValue:p.id?p.name:"",rules:[{required:!0,message:"请填写统计项位置说明！"}]})(g.a.createElement(u.a,{placeholder:"示例: 官网顶部币优下载统计"}))),g.a.createElement(A,P({},q,{label:"链接"}),d("url",{initialValue:p.id?p.url:"",rules:[{required:!0,message:"请填写链接地址！"},{type:"url",message:"请填写正确的链接地址！"}]})(g.a.createElement(u.a,{disabled:!!p.statisticId,placeholder:"请填写完整url地址, 添加成功后不可修改!"}))),g.a.createElement(A,P({},q,{label:"统计项标识"}),d("statisticId",{initialValue:p.id?p.statisticId:"",rules:[{required:!0,message:"请输入统计项唯一标识！"}]})(g.a.createElement(u.a,{disabled:!!p.statisticId,placeholder:"统计项唯一标识, 添加成功后不可修改!"}))))))}}])&&I(a.prototype,n),i&&I(a,i),t}();t.default=Object(v.connect)(function(e){return{selectedData:e.adDataInfo.selectedData,adDataInfo:e.adDataInfo,list:e.adDataInfo.list,search:e.adDataInfo.search,pageData:e.adDataInfo.pageData}})(m.a.create()(z))}}]);