(window.webpackJsonp=window.webpackJsonp||[]).push([[208],{1463:function(e,t,n){"use strict";n.r(t);n(675);var a=n(676),r=n.n(a),c=(n(1385),n(1386)),i=n.n(c),o=(n(1381),n(1382)),s=n.n(o),l=(n(1383),n(1384)),u=n.n(l),p=(n(247),n(183)),m=n.n(p),d=(n(184),n(1378)),f=n.n(d),h=(n(1390),n(1391)),g=n.n(h),y=(n(361),n(20)),b=n.n(y),v=(n(677),n(362)),k=n.n(v),E=(n(1376),n(1377)),O=n.n(E),S=n(0),T=n.n(S),w=n(246),j=(n(1649),n(10)),P=n(1660),C=n(48);function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){z(e,t,n[t])})}return e}function _(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D=O.a.confirm,A=k.a.Option,M=[],R=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=x(t).call(this,e),n=!r||"object"!==N(r)&&"function"!=typeof r?H(a):r,z(H(n),"handleChange",function(e){(0,n.props.dispatch)(Object(P.e)({status:e})),n.setState({status:e}),n.doSearch("init",{currentPage:1,status:e})}),z(H(n),"handleRecSelect",function(e){(0,n.props.dispatch)(Object(P.e)({recommend:e})),n.setState({recommend:e}),n.doSearch("init",{currentPage:1,recommend:e})}),z(H(n),"getOrderNum",function(e){n.setState({order:e})}),z(H(n),"handleCancel",function(){return n.setState({previewVisible:!1})}),z(H(n),"handlePreview",function(e){n.setState({previewImage:e.target.getAttribute("src"),previewVisible:!0})}),n.state={loading:!0,previewVisible:!1,previewImage:"",status:null,order:1,recommend:"",recommendVisible:!1},n}var n,a,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,S["Component"]),n=t,(a=[{key:"componentWillMount",value:function(){var e=this,t=this.props.filter;this.doSearch("init",{status:t.status}),M=[{title:"专题名称",key:"topicName",render:function(t,n){return n&&T.a.createElement("div",{className:"specialTopic-info clearfix"},T.a.createElement("div",null,T.a.createElement("h4",{title:n.topicName,dangerouslySetInnerHTML:e.createMarkup(Object(C.q)(n.topicName,50))}),2!==parseInt(n.status)?"":T.a.createElement("div",{style:{display:"inline-block"}},T.a.createElement("span",{className:"specialTopic-status has-publish mr10"},"首页展示中")),n.recommend?T.a.createElement("div",{style:{display:"inline-block"}},T.a.createElement("span",{className:"specialTopic-status has-recommend mr10"},"推荐中")):""))}},{title:"关键字",key:"tags",render:function(e){return e&&e.tags?T.a.createElement("span",{className:"specialTopic-status pre-publish"},e.tags):T.a.createElement("span",null,"暂无")}},{title:"PC 端封面",dataIndex:"pcImgSrc",key:"pcImgSrc",render:function(t){return T.a.createElement("div",{className:"shrinkPic",key:t,style:{background:"url(".concat(t||"http://static.huoxing24.com/images/2018/03/31/1522470188490129.png",") no-repeat center / cover")},src:t||"http://static.huoxing24.com/images/2018/03/31/1522470188490129.png",onClick:e.handlePreview})}},{title:"重新编辑",key:"option",render:function(e){return T.a.createElement("div",null,T.a.createElement("p",{style:{marginBottom:10}},T.a.createElement(j.Link,{className:"mr10 opt-btn",to:{pathname:"/specialTopic-edit",query:{id:e.id}},style:{background:"#dd274e"}},"修改专题展示")),T.a.createElement("p",null,T.a.createElement(j.Link,{className:"mr10 opt-btn",to:{pathname:"/topicContent-edit",query:{id:e.id}},style:{background:"#007bff"}},"修改专题内容")))}},{title:"首页展示权重",width:100,key:"setTop",render:function(e){return 0===parseInt(e.setTop)&&1===parseInt(e.status)?"无权限":e.setTop}},{title:"操作",key:"action",render:function(t){var n="";switch(t.status){case 1:n=T.a.createElement("p",null,T.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.topicToHome(t)},style:{background:"#00b45a"}},"展示到首页"));break;case 2:n=T.a.createElement("div",null,T.a.createElement("p",{style:{marginTop:10}},T.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.topicToHome(t)},style:{background:"#00b45a"}},"修改首页权重")),T.a.createElement("p",{style:{marginTop:10}},T.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.backFromHome(t)},style:{background:"#e9892f"}},"撤销首页展示")));break;default:n=""}return T.a.createElement("div",null,n,T.a.createElement("p",{style:{marginTop:10}},T.a.createElement("a",{onClick:function(){return e.delSpecialTopic(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#d73435"}},"删除")))}}]}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e(Object(P.g)({type:"init",nickName:""})),e(Object(P.f)({pageSize:20,totalCount:0}))}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"channelName",value:function(e){var t="";return C.S.map(function(n,a){parseInt(n.value)===e&&(t=n.label)}),t}},{key:"doSearch",value:function(e,t){var n=this;this.setState({loading:!0});var a=this.props,r=a.dispatch,c=a.pageData,i=a.filter,o={search:a.search.search,type:4,status:i.status,recommend:i.recommend,pageSize:20,currentPage:c.currentPage};o=I({},o,t),r(Object(P.b)(e,o,function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.props.dispatch;this.doSearch("init",{currentPage:1}),e(Object(P.f)({currentPage:1}))}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.props,n=t.dispatch,a=t.search,r=t.filter;n(Object(P.f)({currentPage:e})),this.doSearch(a.type,I({currentPage:e},r))}},{key:"delSpecialTopic",value:function(e){var t=this;D({title:"提示",content:"确认要删除吗 ?",onOk:function(){var n={id:e.id,status:0};Object(C.i)("POST","/topic/status",I({},n),function(e){1===e.code?(b.a.success("删除成功"),t.doSearch("init")):b.a.error(e.msg)})}})}},{key:"topicToHome",value:function(e){var t=this;(0,this.props.dispatch)(Object(P.c)(4,function(n){D({title:"提示",content:T.a.createElement("div",{className:"modal-input"},T.a.createElement("span",{style:{marginRight:10}},"请输入首页推荐位置的权重：(权重越高越靠前)"),T.a.createElement("p",null,"已被占用的权重：",T.a.createElement("span",null,n.join(", "))),T.a.createElement(g.a,{min:1,defaultValue:e.setTop||1,autoFocus:!0,type:"number",onChange:t.getOrderNum})),onOk:function(){var n=t.state.order;if(""===n.toString().trim())return b.a.error("推荐位的权重值不能为空！"),!1;var a={id:e.id,status:2,type:e.type,setTop:n};-1!==t.props.numArr.indexOf(n)?D({title:"提示",content:T.a.createElement("div",null,T.a.createElement("h3",null,n," 号推荐位置已经被占用！"),T.a.createElement("h3",null,"点击确定原有推荐位将被删除！")),onOk:function(){Object(C.i)("POST","/topic/status",I({},a),function(e){1===e.code?(b.a.success("替换成功"),t.doSearch("init")):b.a.error(e.msg)})}}):Object(C.i)("POST","/topic/status",I({},a),function(e){1===e.code?(b.a.success("操作成功"),t.doSearch("init")):b.a.error(e.msg)})}})}))}},{key:"backFromHome",value:function(e){var t=this;D({title:"提示",content:"确认要撤销在首页的展示吗 ?",onOk:function(){var n={id:e.id,status:1};Object(C.i)("POST","/topic/status",I({},n),function(e){1===e.code?(b.a.success("操作成功"),t.doSearch("init")):b.a.error(e.msg)})}})}},{key:"handleRecommend",value:function(e){var t=this;D({title:"提示",content:"确认要".concat(e.recommend?"取消推荐":"推荐到Banner位","吗 ?"),onOk:function(){var n={id:e.id,recommend:e.recommend?0:1};Object(C.i)("POST","/topic/setrecommend",I({},n),function(e){1===e.code?(b.a.success("操作成功！"),t.doSearch("init")):b.a.error(e.msg)})}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,a=t.pageData,c=t.filter,o=t.search,l=t.dispatch;return T.a.createElement("div",{className:"specialTopic-index"},T.a.createElement(s.a,null,T.a.createElement(u.a,null,T.a.createElement("span",null,"专题筛选："),T.a.createElement(k.a,{defaultValue:"".concat(c.status),style:{width:120},onChange:this.handleChange},C.S.map(function(e){return T.a.createElement(A,{value:e.value,key:e.value},e.label)})),T.a.createElement(f.a,{value:o.search,style:{width:150,margin:"0 15px"},onChange:function(e){return l(Object(P.g)({search:e.target.value}))},placeholder:"请输入标题搜索",onPressEnter:function(){e._search()}}),T.a.createElement(m.a,{type:"primary",onClick:function(){e._search()}},"搜索"),T.a.createElement(m.a,{type:"primary",style:{margin:"0 15px"},onClick:function(){return j.hashHistory.push("/specialTopic-add")}},"新增专题"))),T.a.createElement("div",{className:"mt30"},T.a.createElement(r.a,{spinning:this.state.loading,size:"large"},T.a.createElement(i.a,{dataSource:n.map(function(e,t){return I({},e,{key:t})}),columns:M,bordered:!0,pagination:{current:a.currentPage,total:a.totalCount,pageSize:a.pageSize,onChange:function(t){return e.changePage(t)}}}),T.a.createElement(O.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancel},T.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage})))))}}])&&_(n.prototype,a),c&&_(n,c),t}();t.default=Object(w.connect)(function(e){return{specialTopicInfo:e.specialTopicInfo,list:e.specialTopicInfo.list,search:e.specialTopicInfo.search,filter:e.specialTopicInfo.filter,pageData:e.specialTopicInfo.pageData,numArr:e.specialTopicInfo.numArr}})(R)}}]);