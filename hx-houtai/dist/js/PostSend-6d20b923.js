(window.webpackJsonp=window.webpackJsonp||[]).push([[139,39],{1427:function(e,t,a){"use strict";a.r(t),function(e){a(681);var n=a(682),r=a.n(n),i=(a(680),a(250)),o=a.n(i),s=(a(1396),a(1397)),l=a.n(s),c=(a(1392),a(1393)),u=a.n(c),p=(a(675),a(676)),d=a.n(p),m=(a(1381),a(1382)),f=a.n(m),g=(a(1383),a(1384)),h=a.n(g),b=(a(247),a(183)),v=a.n(b),y=(a(1388),a(1389)),S=a.n(y),w=(a(1387),a(50)),j=a.n(w),I=(a(361),a(20)),E=a.n(I),C=(a(679),a(249)),O=a.n(C),L=(a(1376),a(1377)),k=a.n(L),T=(a(1394),a(1395)),x=a.n(T),_=(a(678),a(363)),P=a.n(_),N=(a(677),a(362)),V=a.n(N),q=(a(184),a(1378)),A=a.n(q),R=(a(1379),a(1380)),D=a.n(R),F=a(0),M=a.n(F),U=a(246),B=a(10),H=a(1614),z=a(1667),J=a(1398),W=(a(1606),a(11)),Y=a.n(W),G=a(1639),Q=a(1624),$=a(248),K=a(1608),X=a(48),Z=(a(1609),a(51)),ee=a.n(Z);function te(e){return(te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ae(){return(ae=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function ne(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function re(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ie(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){de(e,t,a[t])})}return e}function oe(e,t,a,n,r,i,o){try{var s=e[i](o),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,r)}function se(e){return function(){var t=this,a=arguments;return new Promise(function(n,r){var i=e.apply(t,a);function o(e){oe(i,n,r,o,s,"next",e)}function s(e){oe(i,n,r,o,s,"throw",e)}o(void 0)})}}function le(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var me,fe,ge=D.a.Item,he=A.a.TextArea,be=V.a.Option,ve=P.a.Group,ye=x.a.CheckableTag,Se=k.a.confirm,we=O.a.Group,je=[{label:"原创",value:"1"},{label:"转载",value:"2"}],Ie="",Ee=1,Ce=!1,Oe=ee.a.get("hx_passportId"),Le=function(t){function a(t){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),r=this,i=ce(a).call(this,t),n=!i||"object"!==te(i)&&"function"!=typeof i?ue(r):i,de(ue(n),"enterIconLoading",function(){n.setState({iconLoading:!0})}),de(ue(n),"insertState",function(e){e.map(function(e){n.state[e+"fileList"]=[],n.state[e+"Img"]=""})}),de(ue(n),"editorPaste",function(e){n.setState({editorOnPaste:!0});var t=n.state.editor.getContents();(0===t.length()||1===t.length()&&t.ops[0].insert&&""===t.ops[0].insert.replace(/\s+/g,""))&&setTimeout(function(){n.handleSmartTags()},300)}),de(ue(n),"getTopicListData",se(regeneratorRuntime.mark(function e(){var t,a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={type:4,pageSize:999,status:1,currentPage:1},e.next=3,Object($.j)(t);case 3:if(a=e.sent){e.next=8;break}return E.a.info("获取列表错误"),n.setState({loading:!1}),e.abrupt("return");case 8:if(1===a.code){e.next=12;break}return E.a.info(a.msg),n.setState({loading:!1}),e.abrupt("return");case 12:r=a.obj.inforList.map(function(e,t){return ie({},e,{key:e.id})}),n.setState({topicList:r});case 14:case"end":return e.stop()}},e)}))),de(ue(n),"removeHTMLTag",function(e){return e=(e=(e=e.replace(/<\/?[^>]*>/g,"")).replace(/[ | ]*\n/g,"\n")).replace(/ /gi,"")}),de(ue(n),"inquireRepetition",function(e,t){var a={timeStamp:Date.parse(new Date)/1e3,title:e.title,content:n.removeHTMLTag(e.content),media:"新闻"};Object(X.i)("post","/news/dedup/predict",a,function(e){""!==e.obj?n.setState({isRepetition:!0,isRepetitionEdit:"该文章与已有文章高度相似",similarityUrl:e.obj}):""===e.obj&&t&&n.setState({isRepetition:!0,isRepetitionEdit:"文章内容无重复",similarityUrl:""})})}),de(ue(n),"isArticleAudit",function(e,t){var a={title:e.title,content:n.removeHTMLTag(e.content),media:"新闻"};Object(X.i)("post","/news/article/filter",a,function(e){e.code})}),de(ue(n),"isRepetitionOk",function(){n.setState({isRepetition:!1})}),de(ue(n),"isRepetitionCancel",function(){n.setState({isRepetition:!1})}),de(ue(n),"routerWillLeave",function(){return"离开页面可能会导致编辑内容丢失, 是否确认离开?"}),de(ue(n),"saveArticle",function(e){var t=n.props.form,a=n.state,r=a.tags,i=a.original,o=a.channelId,s=a.newsContent,l=a.videofileList,c=a.audioDefalutArr,u=a.cateId,p=a.pcImg,d=a.Img,m=a.mImg,f=a.mcImg,g=a.videoPcImg,h=a.videoMImg,b=a.pcSubjectImg,v=a.mSubjectImg,y=a.mHotSubjectImg,S=a.pcHotSubjectImg,w=null,j=ie({},w=1===parseInt(n.state.subject)?{pc_subject:b,m_subject:v,pc_hot_subject:S,m_hot_subject:y}:{},{tags:r.join(","),original:i,subject:n.state.subject,content:s,audio:JSON.stringify(c),video:l[0]&&l[0].fileUrl?JSON.stringify(l):"[]",author:t.getFieldValue("author"),hotCounts:t.getFieldValue("hotCounts"),synopsis:t.getFieldValue("synopsis"),title:t.getFieldValue("title"),source:1===parseInt(u)?t.getFieldValue("source").label||"MarsBit":t.getFieldValue("sourceTrans"),createdBy:1===parseInt(u)?t.getFieldValue("source").key||"fff9d400cb94444fadaefd429516c276":"",advertised:t.getFieldValue("advertised"),subTitle:t.getFieldValue("subTitle"),keyTags:t.getFieldValue("keyTags"),originalUrl:t.getFieldValue("originalUrl"),originalTitle:t.getFieldValue("originalTitle"),cateId:u,channelId:o,coverPic:JSON.stringify(ie({pc_recommend:p,pc:d,wap_small:m,wap_big:f,video_pc:g,video_m:h},w))});localStorage.setItem("articleData",JSON.stringify(j)),e&&e(j)}),de(ue(n),"fileList",function(e,t){return e[t]&&""!==e[t]?[{uid:0,name:"xxx.png",status:"done",url:e[t]}]:[]}),de(ue(n),"renderData",function(e){var t=e.content.replace(/<style(.+)<\/style>/,"");t=t.replace(/<img[^>]*>/gi,function(e,t){e.replace(/height="(.*)"/gi,"");return e.replace(/width="(.*)"/gi,"")}),n.state.editor.clipboard.dangerouslyPasteHTML(t,"user"),n.state.editor.videoInit();var a=Object(X.G)(e.coverPic)?JSON.parse(e.coverPic):{pc_recommend:"",pc:"",wap_big:"",wap_small:"",video_pc:"",video_m:"",pc_subject:"",m_subject:"",m_hot_subject:"",pc_hot_subject:""},r=n.fileList(a,"pc_recommend"),i=n.fileList(a,"pc_subject"),o=n.fileList(a,"m_subject"),s=n.fileList(a,"m_hot_subject"),l=n.fileList(a,"pc_hot_subject"),c=n.fileList(a,"video_pc"),u=n.fileList(a,"video_m"),p=n.fileList(a,"pc"),d=n.fileList(a,"wap_small"),m=n.fileList(a,"wap_big");n.setState({updateOrNot:!0,videoPcfileList:c,videoMfileList:u,fileList:p,pcfileList:r,mfileList:d,mcfileList:m,pcSubjectfileList:i,mSubjectfileList:o,pcHotSubjectfileList:l,mHotSubjectfileList:s,audioDefalutArr:Object(X.G)(e.audio)?JSON.parse(e.audio):[],videofileList:Object(X.G)(e.video)?JSON.parse(e.video):[],tags:e.tags?e.tags.split(","):[],newsContent:t,Img:a.pc,allImg:a.all,subTitle:e.subTitle,pcImg:a.pc_recommend||"",mImg:a.wap_small,mcImg:a.wap_big,pcSubjectImg:a.pc_subject,mSubjectImg:a.m_subject,pcHotSubjectImg:a.pc_hot_subject,mHotSubjectImg:a.m_hot_subject,videoMImg:a.video_m,videoPcImg:a.video_pc,mp3Url:e.audio||"",videoUrl:e.video||"",loading:!1,original:e.original||0,advertised:e.advertised||0,subject:e.subject||0,cateId:e.cateId,source:e.cateId&&1===parseInt(e.cateId)?{key:e.createdBy||"fff9d400cb94444fadaefd429516c276",label:e.source||"MarsBit"}:e.source,createdBy:e.cateId&&1===parseInt(e.cateId)?e.createdBy||"fff9d400cb94444fadaefd429516c276":""})}),de(ue(n),"closeWindow",function(){n.setState({closeLoading:!0})}),de(ue(n),"channelIdChange",function(e){n.setState({channelId:e.target.value})}),de(ue(n),"cateIdChange",function(e){var t=e.target.value;if("1"===t){n.setState({source:"MarsBit",createdBy:"fff9d400cb94444fadaefd429516c276"});var a=ue(n);(0,n.props.dispatch)(Object(Q.b)("init",{pageSize:1e3,currentPage:1,keyword:a.props.newsInfo.source},function(e){for(var t=e.inforList,n=!0,r=0;r<t.length;r++)if(t[r].nickName===a.props.newsInfo.source){n=!1,a.setState({sourceVal:{key:t[r].passportId,label:t[r].nickName}});break}n&&(a.setState({sourceVal:{key:"",label:""}}),E.a.info("此作者不存在"))}))}else n.setState({source:""});n.setState({cateId:t})}),de(ue(n),"optionChange",function(e){n.setState({source:e.label,createdBy:e.key})}),de(ue(n),"optionSearchChange",function(e){var t=ue(n);(0,n.props.dispatch)(Object(Q.b)("init",{pageSize:1e3,currentPage:1,keyword:e},function(e){var a=e.inforList;t.setState({list:a})}))}),de(ue(n),"handleClose",function(e){var t=n.state.tags.filter(function(t){return t!==e});n.setState({tags:t})}),de(ue(n),"showInput",function(){n.setState({inputVisible:!0},function(){return n.input.focus()})}),de(ue(n),"handleInputChange",function(e){n.setState({inputValue:e.target.value})}),de(ue(n),"handleInputConfirm",function(){var e=n.state,t=e.inputValue,a=e.tags;t&&-1===a.indexOf(t)&&(a=[].concat(re(a),[t.slice(0,20)])),n.setState({tags:a,inputVisible:!1,inputValue:""})}),de(ue(n),"saveInputRef",function(e){n.input=e}),de(ue(n),"handleCancel",function(){return n.setState({previewVisible:!1})}),de(ue(n),"handlePreview",function(e){if(e.hasOwnProperty("target")){var t=e.target.getAttribute("data-type");""!==n.state[t]?n.setState({previewImage:n.state[t],previewVisible:!0}):E.a.info("请先上传图片")}else n.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})}),de(ue(n),"file",function(e){return new Promise(function(t){var a=new FileReader,n=new Image;a.readAsDataURL(e),a.onload=function(e){var t=e.target.result;n.src=t},t(n)})}),de(ue(n),"image",function(e){return new Promise(function(t){e.onload=function(){var a=e.width,n=e.height;t(a<=800&&n<=800)}})}),de(ue(n),"beforeUpload",function(){var e=se(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.file(t).then(function(e){return n.image(e)}).then(function(e){return e});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),de(ue(n),"handleChange",function(){var e=se(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.file,r=t.fileList,"removed"!==a.status){e.next=5;break}n.setState({Img:""}),e.next=11;break;case 5:return e.next=7,n.beforeUpload(a.originFileObj);case 7:if(e.sent){e.next=11;break}return E.a.warning("单张图片上传尺寸不能大于 800 * 800, 请重新选择图片或使用统一上传!"),e.abrupt("return",!1);case 11:n.setState({fileList:r}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({Img:a.response.obj}),"error"===a.status&&(E.a.error("网络错误，上传失败！"),n.setState({Img:"",fileList:[]})));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),de(ue(n),"handleVideoPcChange",function(e){var t=e.file,a=e.fileList;n.setState({videoPcfileList:a}),"removed"===t.status&&n.setState({videoPcImg:""}),t.response&&(1===t.response.code&&"done"===t.status&&n.setState({videoPcImg:t.response.obj}),"error"===t.status&&(E.a.error("网络错误，上传失败！"),n.setState({videoPcImg:"",videoPcfileList:[]})))}),de(ue(n),"handleVideoMChange",function(e){var t=e.file,a=e.fileList;n.setState({videoMfileList:a}),"removed"===t.status&&n.setState({videoMImg:""}),t.response&&(1===t.response.code&&"done"===t.status&&n.setState({videoMImg:t.response.obj}),"error"===t.status&&(E.a.error("网络错误，上传失败！"),n.setState({videoMImg:"",videoMfileList:[]})))}),de(ue(n),"handlePcChange",function(){var e=se(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.file,r=t.fileList,"removed"!==a.status){e.next=5;break}n.setState({pcImg:""}),e.next=11;break;case 5:return e.next=7,n.beforeUpload(a.originFileObj);case 7:if(e.sent){e.next=11;break}return E.a.warning("单张图片上传尺寸不能大于 800 * 800, 请重新选择图片或使用统一上传!"),e.abrupt("return",!1);case 11:n.setState({pcfileList:r}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({pcImg:a.response.obj}),"error"===a.status&&(E.a.error("网络错误，上传失败！"),n.setState({pcImg:"",pcfileList:[]})));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),de(ue(n),"handleMobileChange",function(){var e=se(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.file,r=t.fileList,"removed"!==a.status){e.next=5;break}n.setState({mImg:""}),e.next=11;break;case 5:return e.next=7,n.beforeUpload(a.originFileObj);case 7:if(e.sent){e.next=11;break}return E.a.warning("单张图片上传尺寸不能大于 800 * 800, 请重新选择图片或使用统一上传!"),e.abrupt("return",!1);case 11:n.setState({mfileList:r}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({mImg:a.response.obj}),"error"===a.status&&(E.a.error("网络错误，上传失败！"),n.setState({mImg:"",mfileList:[]})));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),de(ue(n),"handleMobileCommentChange",function(){var e=se(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.file,r=t.fileList,"removed"!==a.status){e.next=5;break}n.setState({mcImg:""}),e.next=11;break;case 5:return e.next=7,n.beforeUpload(a.originFileObj);case 7:if(e.sent){e.next=11;break}return E.a.warning("单张图片上传尺寸不能大于 800 * 800, 请重新选择图片或使用统一上传!"),e.abrupt("return",!1);case 11:n.setState({mcfileList:r}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({mcImg:a.response.obj}),"error"===a.status&&(E.a.error("网络错误，上传失败！"),n.setState({mcImg:"",mcfileList:[]})));case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),de(ue(n),"handlePcSubjectChange",function(){var e=se(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.file,r=t.fileList,e.next=3,n.beforeUpload(a.originFileObj);case 3:if(e.sent){e.next=7;break}return E.a.warning("图片尺寸不能大于 800 * 800, 请重新选择!"),e.abrupt("return",!1);case 7:n.setState({pcSubjectfileList:r}),"removed"===a.status&&n.setState({pcSubjectImg:""}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({pcSubjectImg:a.response.obj}),"error"===a.status&&(E.a.error("网络错误，上传失败！"),n.setState({pcSubjectImg:"",pcSubjectfileList:[]})));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),de(ue(n),"handleMSubjectChange",function(){var e=se(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.file,r=t.fileList,e.next=3,n.beforeUpload(a.originFileObj);case 3:if(e.sent){e.next=7;break}return E.a.warning("图片尺寸不能大于 800 * 800, 请重新选择!"),e.abrupt("return",!1);case 7:n.setState({mSubjectfileList:r}),"removed"===a.status&&n.setState({mSubjectImg:""}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({mSubjectImg:a.response.obj}),"error"===a.status&&(E.a.error("网络错误，上传失败！"),n.setState({mSubjectImg:"",mSubjectfileList:[]})));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),de(ue(n),"handlePcHotSubjectChange",function(){var e=se(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.file,r=t.fileList,e.next=3,n.beforeUpload(a.originFileObj);case 3:if(e.sent){e.next=7;break}return E.a.warning("图片尺寸不能大于 800 * 800, 请重新选择!"),e.abrupt("return",!1);case 7:n.setState({pcHotSubjectfileList:r}),"removed"===a.status&&n.setState({pcHotSubjectImg:""}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({pcHotSubjectImg:a.response.obj}),"error"===a.status&&(E.a.error("网络错误，上传失败！"),n.setState({pcHotSubjectImg:"",pcHotSubjectfileList:[]})));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),de(ue(n),"handleMHotSubjectChange",function(){var e=se(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.file,r=t.fileList,e.next=3,n.beforeUpload(a.originFileObj);case 3:if(e.sent){e.next=7;break}return E.a.warning("图片尺寸不能大于 800 * 800, 请重新选择!"),e.abrupt("return",!1);case 7:n.setState({mHotSubjectfileList:r}),"removed"===a.status&&n.setState({mHotSubjectImg:""}),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({mHotSubjectImg:a.response.obj}),"error"===a.status&&(E.a.error("网络错误，上传失败！"),n.setState({mHotSubjectImg:"",mHotSubjectfileList:[]})));case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),de(ue(n),"handleMp3",function(e){var t=e.file,a=e.fileList;t.response&&(1===t.response.code&&n.setState({mp3fileList:a},function(){}),"error"===t.status&&E.a.error("网络错误，上传失败！"))}),de(ue(n),"handleUpload",function(){var e=n.state.videoList[0],t=e.size,a=Math.ceil(t/2097152),r=new FormData;r.append("fileName",e.name),r.append("blockCount",a),r.append("currIndex",Ee),r.append("uploadId",Ie),r.append("uploadFile",null),r.append("type","video"),n.setState({uploading:!0}),n.UploadPost(e,r,t,a,2097152)}),de(ue(n),"UploadPost",function(e,t,a,r,i){if(!Ce)try{var o=(Ee-1)*i,s=Math.min(a,o+i),l=e.slice(o,s);t.set("uploadFile",l),t.set("currIndex",Ee),t.set("uploadId",Ie),Object(X.l)("post","/file/upload",t,function(o){if(1===o.code){1===Ee&&(Ie=o.obj);var s=Ee/r*100;Ee+1===r&&(s=100),n.setState({progressNum:parseFloat(s.toFixed(2))}),Ee<r&&(Ee+=1,n.UploadPost(e,t,a,r,i))}else if(o.code<0)Ie="",Ee=1,E.a.error(o.msg);else if(2===o.code){Ie="",Ee=1;var l=n.state.videofileList,c=[];l.map(function(e,t){c.push({uid:e.uid,fileName:e.name,name:e.name,fileUrl:o.obj})}),n.setState({videoList:[],videofileList:c,uploading:!1}),E.a.success("文件上传成功!")}})}catch(e){console.log(e)}}),de(ue(n),"newsVisibleHide",function(){n.setState({newsVisible:!1})}),de(ue(n),"newsVisibleShow",function(){n.setState({newsVisible:!0})}),de(ue(n),"normFile",function(e){return Array.isArray(e)?e:e&&e.fileList}),de(ue(n),"delAudio",function(e){var t=n.state.audioDefalutArr;t.map(function(a,n){a.uid.toString()===e.toString()&&t.splice(n,1)}),n.setState({audioDefalutArr:t})}),de(ue(n),"delPost",function(){Ie="",Ee=1,n.setState({videoList:[],videofileList:[],uploading:!1})}),de(ue(n),"uploadAllImg",function(t){var a=t.file,r=t.fileList,i=ue(n);if(a.size/1048576>=2)return E.a.error("图片大小超过 2M , 请重新选择!"),n.setState({allfileList:[],allImg:""}),!1;n.setState({allfileList:r}),"removed"===a.status&&(n.setState({allfileList:[],allImg:""}),n.state.cropImgRule.map(function(e,t){var a;i.setState((de(a={},e.coverName,""),de(a,e.coverList,[]),a))})),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({allImg:a.response.obj,uploadAllImgModal:!0,focusImg:-1},function(){var t=document.querySelector("#croppedImg");t.src=a.thumbUrl,i.setState({cropper:new J.a(t,{aspectRatio:n.state.ratio,viewMode:1,crop:function(t){var a=this.cropper,n=i.state.focusImg,r=i.state.cropImgRule[-1===n?0:n],o=a.getCroppedCanvas({width:2*parseInt(r.width),height:2*parseInt(r.height),imageSmoothingQuality:"high"}).toDataURL("image/jpeg",1),s=e(".crop-preview-item");-1===n?s.each(function(t,a){e(this).children("img").attr("src",o)}):s.eq(n).children("img").attr("src",o)}})})}),"error"===a.status&&(E.a.error("网络错误，上传失败！"),n.setState({allImg:"",allfileList:[]})))}),de(ue(n),"sureCropImg",function(){var t=ue(n),a=0;n.setState({loading:!0,uploadAllImgModal:!1,confirmLoading:!0}),E.a.warning("上传中，请稍候！"),n.state.cropper.destroy(),e(".crop-preview-item").each(function(n,r){var i=this;setTimeout(function(){var n,r=e(i).data("type"),o=e(i).data("list");t.setState((de(n={},r,""),de(n,o,[]),n));var s=Object(X.r)(e(i).find("img").prop("src")),l=new FormData;l.append("uploadFile",s),e.ajax("".concat(X.a,"/pic/upload"),{headers:{"Sign-Param":Object(X.A)()},method:"POST",data:l,processData:!1,timeout:3e4,contentType:!1,success:function(e){var n;1===e.code?a+=1:400===e.code&&console.log("上传失败"),2===a&&(t.setState({loading:!1,confirmLoading:!1}),E.a.success("上传完毕！")),t.setState((de(n={},r,e.obj),de(n,o,[{uid:0,name:"xxx.png",status:"done",url:e.obj}]),n),function(){})},error:function(e,a){t.setState({confirmLoading:!1,loading:!1}),"timeout"===a?E.a.error("上传超时, 请检查网络后重新上传！"):E.a.error("网络故障, 请尝试重新上传！"),e.abort()}})},2e3*n)})}),de(ue(n),"uploadAllImgCancel",function(){n.setState({uploadAllImgModal:!1}),n.state.cropper.destroy()}),de(ue(n),"handleSubmit",function(e){e.preventDefault();var t=ue(n);n.enterIconLoading();var a=e.target.getAttribute("data-status"),r=n.state.updateOrNot&&(n.props.location.query.id||n.props.location.query.url);if(!r&&n.saveArticle(),n.state.editor.mediaUploading())return E.a.warning("编辑器中图片或视频正在上传, 请稍候提交!"),!1;if(n.state.uploading)return E.a.warning("视频正在上传, 请稍候提交!"),n.setState({iconLoading:!1}),!1;var i=Date.parse(n.props.form.getFieldValue("publishTime")||new Date),o=Date.parse(new Date);if("3"===a&&i<=o)return n.setState({iconLoading:!1}),E.a.warning("预发布新闻时间应 大于 当前时间，请重新设置!"),!1;if("1"===a&&i>o)return n.setState({iconLoading:!1}),E.a.warning("直接发布新闻的时间应 小于等于 当前时间，请重新设置!"),!1;var s=n.state.audioDefalutArr;n.state.mp3fileList.map(function(e,t){s.push({uid:e.uid,fileName:e.name,fileUrl:e.response.obj})}),n.setState({audioDefalutArr:s},function(){var e=this,n=null;n=1===parseInt(this.state.subject)?{pc_subject:this.state.pcSubjectImg,m_subject:this.state.mSubjectImg,pc_hot_subject:this.state.pcHotSubjectImg,m_hot_subject:this.state.mHotSubjectImg}:{},this.props.form.setFieldsValue(ie({},n,{tags:"",original:1===this.state.original,advertised:1===this.state.advertised,subject:1===this.state.subject,content:this.state.newsContent,pc_recommend:this.state.pcImg,pc:this.state.Img,wap_small:this.state.mImg,wap_big:this.state.mcImg,subTitle:this.state.newsAssist,audio:JSON.stringify(this.state.audioDefalutArr),video:this.state.videofileList[0]&&this.state.videofileList[0].fileUrl?JSON.stringify(this.state.videofileList):"[]"})),this.props.form.validateFieldsAndScroll(function(n,i){var o=i.content.replace(/(<\/?iframe.*?>)/g,"").replace("<p><br></p>","");i.content=o.replace('<p class="ql-align-justify"><br></p>',""),i.synopsis=e.state.abstractinfo;var s=i.strategyCat;if(1!==i.cateId||""!==i.source.key){var l,c=(l=s.join(",").replace(/,/g,"|"),new Function("return "+l)());if(n)e.setState({iconLoading:!1});else{if(e.setState({loading:!0}),1===parseInt(e.state.cateId)?(i.createdBy=""===t.state.reprintAuthorId?i.source.key:t.state.reprintAuthorId,i.source=i.source.label):(i.source=i.sourceTrans,i.createdBy="fff9d400cb94444fadaefd429516c276"),i.publishTime=!e.state.dateDisabled||e.props.location.query.id?Date.parse(i.publishTime.format("YYYY-MM-DD HH:mm:ss")):Date.parse(new Date),i.coverPic=JSON.stringify({pc_recommend:i.pc_recommend||"",pc:i.pc,wap_big:i.wap_big,wap_small:i.wap_small,video_pc:e.state.videoPcImg,video_m:e.state.videoMImg,pc_subject:i.pc_subject||"",m_subject:i.m_subject||"",pc_hot_subject:i.pc_hot_subject||"",m_hot_subject:i.m_hot_subject||""}),delete i.pc,delete i.pc_recommend,delete i.wap_big,delete i.wap_small,delete i.video_pc,delete i.video_m,delete i.pc_subject,delete i.m_subject,delete i.m_hot_subject,delete i.pc_hot_subject,delete i.alignLeft,delete i.wordBreak,delete i.watermark,delete i.smartTags,i.id=e.props.location.query.id||"",i.status=a||1,i.original=i.original?1:0,i.advertised=i.advertised?1:0,i.strategyCat=c,0===i.tagsV2.length)i.tagsV2="";else{var u=[];i.tagsV2.forEach(function(e){u.push(ie({name:e.label},JSON.parse(e.key)))}),i.tagsV2=JSON.stringify(u)}"tactics"!==e.props.location.query.from&&"twitter"!==e.props.location.query.from||(i.fromWorkbench=e.props.location.query.newsid),(!e.state.updateOrNot||!e.props.location.query.id)&&delete i.id,i.topicValue&&(i.topicId=i.topicValue.key,delete i.topicValue),Object(X.i)("post","".concat(e.state.updateOrNot&&e.props.location.query.id?"/news/update":"/news/add"),i,function(n){if(t.setState({loading:!1}),n.code&&1===n.code){var o=(e.props.location.query.from,"新闻"),s=i.tags.length>0?i.tags.split(","):[],l=e.props.location.query.newsid?e.props.location.query.newsid:n.obj;t.dataGather(l,o,s,i.tagsV2,n.currentTime),E.a.success(r?"修改成功！":"添加成功！"),t.setState({interval:clearInterval(e.state.interval)}),!r&&localStorage.removeItem("articleData"),B.hashHistory.push("/post-list"),"1"===a&&Object(X.i)("post","/caster/mars/content/sent",{newsId:i.id,title:i.title,synopsis:e.state.abstractinfo,coverPic:i.coverPic,createdBy:i.createdBy})}else e.setState({iconLoading:!1}),E.a.error(n.msg)})}}else E.a.error("来源不能为空")})})}),de(ue(n),"isRepetition",function(){var t={content:e(n.state.editor.root).text(),title:e(".ant-input-lg.title-input").val()};n.inquireRepetition(t,"edit"),n.isArticleAudit(t,"edit")}),de(ue(n),"dataGather",function(e,t,a,r,i){var o={event_type:"COMMIT_ARTICLE",event_info:{article:{id:e,type:t},algo_tags:n.state.oldTags,edit_tags:r,algo_category:"其他",edit_category:"其他"},timestamp:i};Object(X.i)("post","/passport/account/recommend/gather",{data:JSON.stringify(o)})}),de(ue(n),"sendPost",function(e){var t=n.state,a=t.wordBreak,r=t.alignLeft,i='<style type="text/css"> .details .details-cont p, p {word-break: '.concat(a?"break-all !important":"normal","; text-align: ").concat(r?"left !important":"unset","} p img {text-align: center !important;} </style>"),o={newsTitle:e.postTitle||"",newsContent:"<div class=".concat(r?"simditorSupport":"",">").concat(i).concat(e.postContent,"</div>")||!1};n.setState(ie({},n.state,o))}),de(ue(n),"createMarkup",function(e){return{__html:e}}),de(ue(n),"CropperImgCroped",function(e){console.log(e)}),de(ue(n),"FormItem",function(e){var t=n.state.updateOrNot,a=n.props.form.getFieldDecorator,r=M.a.createElement("div",null,M.a.createElement(j.a,{type:"plus"}),M.a.createElement("div",{className:"ant-upload-text"},e.label));return M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:15,offset:1}},M.a.createElement("div",{className:"dropbox"},a(e.imgName,{initialValue:t&&e.newsInfo?e.fileList:"",rules:[{required:e.require,message:"请上传相应封面"}]})(M.a.createElement(S.a,{headers:{"Sign-Param":Object(X.A)()},action:"".concat(X.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:e.fileList,onPreview:n.handlePreview,onChange:e.changeEvent},e.fileList.length>=1?null:r)),e.noBtn?"":M.a.createElement(v.a,{"data-type":e.imgUrl,onClick:n.handlePreview,className:"img-preview",type:"primary"},"预览"),M.a.createElement("p",{className:"cover-img-tip"},M.a.createElement("span",{style:{color:"#249aef"}},e.size))))}),de(ue(n),"handleTagsChange",function(e,t){e.map(function(e){e.title=Object(X.R)(JSON.parse(e.key).type,e.label)}),n.setState({value:e})}),de(ue(n),"handleBlur",function(){n.setState({searchText:""})}),de(ue(n),"handleSelect",function(e,t){e.type=t.props.dataType}),de(ue(n),"handleDeselect",function(e,t){var a=n.state.selectedTags.filter(function(t){return JSON.parse(t).id!==JSON.parse(e.key).id});n.setState({selectedTags:a})}),de(ue(n),"judgeExist",function(e,t){0===(t&&0!==t.length?t.filter(function(t){return t.name===e}):[]).length&&0!==t.length?n.setState({noCurrResult:!0}):n.setState({noCurrResult:!1})}),de(ue(n),"getTagList",function(e){me&&(clearTimeout(me),me=null),fe=e;me=setTimeout(function(){n.setState({searching:!0,data:[]}),Object(X.i)("post","/tagmgr/like",{name:e},function(t){if(n.setState({searching:!1}),n.judgeExist(fe,t.obj),0===t.obj.length&&""!==e.trim()?n.setState({searchText:M.a.createElement("div",null,M.a.createElement("span",null,"未查询到相关标签, 是否创建?"),M.a.createElement(v.a,{type:"primary",loading:n.state.tagsIconLoading,style:{margin:"0 10px"},onClick:n.addNewTag,size:"small"},"是"),M.a.createElement(v.a,{type:"primary",size:"small",onClick:function(){n.setState({searchText:""})}},"否")),noCurrResult:!1}):n.setState({searchText:""}),fe===e){var a=t.obj.filter(function(e){return 1!==e.type});n.setState({data:a})}})},500)}),de(ue(n),"addNewTag",function(e){e.target.disabled=!0;var t=n.props.form;n.setState({tagsIconLoading:!0}),Object(X.i)("post","/tagmgr/addSimpleTag",{name:fe,creator:ee.a.get("hx_passportId")},function(e){n.setState({searchText:"",tagsIconLoading:!1,noCurrResult:!1});var a=[{title:"".concat(e.obj.name,"-聚合"),key:JSON.stringify({id:e.obj.id,type:e.obj.type}),type:e.obj.type,label:e.obj.name}];t.setFieldsValue({tagsV2:[].concat(re(t.getFieldValue("tagsV2")),a)})})}),de(ue(n),"transTags",function(e){var t=[];return e.forEach(function(e){t.push({title:"".concat(Object(X.R)(e.type,e.name)),label:e.name,key:JSON.stringify({id:e.id,type:e.type})})}),t}),de(ue(n),"handleTagsSelect",function(e,t){var a=JSON.parse(e),r=n.state.selectedTags,i=n.props.form.getFieldValue("tagsV2"),o=t?[].concat(re(r),[e]):r.filter(function(t){return t!==e}),s=(a.name,ne(a,["name"])),l=[{title:"".concat(a.name,"-行情"),key:JSON.stringify(s),type:a.type,label:a.name}],c=!1;i.forEach(function(e){e.key===l[0].key&&(c=!0)}),n.props.form.setFieldsValue({tagsV2:t?c?re(i):[].concat(re(i),l):i.filter(function(e){return e.key!==l[0].key})}),n.setState({selectedTags:o})}),de(ue(n),"handleSmartTags",function(){var t=e(n.state.editor.root).text(),a=e(".ant-input-lg.title-input").val(),r=(n.props.location.query.from,"新闻"),i=n.props.form.getFieldValue("tagsV2");if(""===t.trim())return E.a.error("新闻内容不能为空!"),!1;n.setState({tagsLoading:!0}),Object(X.i)("post","/news/tags/predict",{content:t,title:n.props.location.query.from?n.state.tagTitle:a,media:r,passportId:Oe},function(e){var t=[],a={};n.setState({oldTags:e.obj}),e.obj.forEach(function(e){i.map(function(a){if(e.name===a.label){var n=JSON.stringify({id:e.id,type:e.type,name:e.name});t.push(n)}})}),console.log(t);var r=[].concat(re(i),[]).reduce(function(e,t){return a[t.key]?a[t.key]=!0:(a[t.key]=!0,e.push(t)),e},[]);n.props.form.setFieldsValue({tagsV2:r}),n.setState({selectedTags:t,smartTags:e.obj,smartTagsStatus:!0,tagsLoading:!1}),0===e.obj.length&&E.a.error("未匹配到合适的关键词，请手动添加")})}),de(ue(n),"handleSmartTagsCancel",function(){n.setState({smartTags:[],smartTagsStatus:!1})}),de(ue(n),"handleAigetdesc",function(){n.setState({ailoading:!0});var e=Object(X.B)(n.state.newsContent).replace(".details .details-cont p, p {word-break: normal; text-align: unset} p img {text-align: center !important;}","");Object(X.i)("post","/news/getSummaryByAI",{txt:e},function(e){if(n.setState({ailoading:!1}),1===e.code&&-1!==e.obj){var t=e.obj.answer.replace(/\n/gi,"");n.setState({aiflag:!0,abstractinfo:"【GPT】"+t})}else E.a.error(e.msg)},{"Sign-Param":Object(X.A)(),"Content-Type":"application/json"})}),de(ue(n),"handleWhitter",function(e){var t=e.target.value.replace("【GPT】","");n.setState({aiflag:!1,abstractinfo:t})}),de(ue(n),"reset",function(){Se({title:"提示",content:"确认要清空当前页面内容吗? 清空后不可恢复!",onOk:function(){n.state.editor.root.innerHTML="",n.props.form.resetFields()}})}),de(ue(n),"dateChange",function(e){n.setState({dateDisabled:!e.target.value})}),de(ue(n),"seleceOnBlur",function(){n.setState({sourceVal:n.props.newsInfo.id?{key:n.props.newsInfo.createdBy,label:n.props.newsInfo.source}:{key:"",label:""}})}),n.state={confirmLoading:!1,editor:"",editorOnPaste:!1,updateOrNot:!1,tags:[],smartTags:[],smartTagsStatus:!1,selectedTags:[],tagsLoading:!1,source:"",createdBy:"",mp3fileList:[],videofileList:[],videoList:[],audioDefalutArr:[],inputVisible:!1,inputValue:"",isLogin:!1,channelId:"1",newsVisible:!1,cateId:"1",previewVisible:!1,previewImage:"",newsTitle:"",newsContent:"",mp3Url:"",videoUrl:"",uploading:!1,progressNum:0,loading:!0,original:0,advertised:0,subject:0,uploadAllImgModal:!1,cropper:null,focusImg:-1,ratio:2,cropImgRule:[{coverName:"Img",coverList:"fileList",width:"220px",height:"160px",ratio:1.375,intro:"PC 端新闻封面:220 * 160"},{coverName:"mImg",coverList:"mfileList",width:"164px",height:"109px",ratio:164/109,intro:"M端新闻封面:164 * 109"}],width:0,height:0,wordBreak:0,alignLeft:0,iconLoading:!1,interval:0,value:"",searching:!1,data:[],searchText:"",tagsIconLoading:!1,noCurrResult:!1,dateDisabled:!0,list:n.props.list?n.props.list:[],reprintAuthorId:"",sourceVal:{key:"fff9d400cb94444fadaefd429516c276",label:"MarsBit"},oldTags:[],tagTitle:"",isRepetition:!1,isRepetitionEdit:!1,similarityUrl:"",topicValue:{key:"",label:""},topicList:[],newsAssist:"",abstractinfo:"",aiflag:!1,ailoading:!1},n}var n,i,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(a,F["Component"]),n=a,(i=[{key:"componentWillMount",value:function(){ee.a.set("watermark",1),this.insertState(["mHotSubject","pcHotSubject","mSubject","pcSubject","videoPc","videoM","all","","pc","m","mc"]);var e=this.props.dispatch,t=this;e(Object(K.a)("post",{pageSize:20,status:1,currentPage:1},function(){t.setState({loading:!1})}))}},{key:"componentDidUpdate",value:function(e,t){e.newsInfo.id!==this.props.newsInfo.id&&this.setState({sourceVal:this.props.newsInfo.id?{key:this.props.newsInfo.createdBy,label:this.props.newsInfo.source}:{key:"fff9d400cb94444fadaefd429516c276",label:"MarsBit"}})}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.dispatch,n=t.location;this.getTopicListData(),a(Object($.f)()),a(Object(Q.b)("init",{pageSize:1e3,currentPage:1})),n.query.id||n.query.url||n.query.from?n.query.id?(this.setState({loading:!0}),a(Object(G.d)({id:n.query.id},function(t){t.code,e.setState({loading:!1}),e.renderData(t),e.setState({oldTags:t.tagsV2,abstractinfo:t.synopsis})}))):n.query.url?a(Object(G.c)({url:n.query.url,webName:n.query.webName,title:n.query.title,publishTime:n.query.publishTime,coverPic:n.query.coverPic,synopsis:n.query.synopsis,author:n.query.author},function(t){e.renderData(t),e.setState({oldTags:t.tagsV2})})):"twitter"===n.query.from?a(Object(G.g)({url:decodeURIComponent(n.query.urls),id:n.query.newsid},function(t){e.setState({loading:!0}),t?(e.setState({loading:!1,tagTitle:t.title}),e.renderData(t),e.handleSmartTags(),e.inquireRepetition(t),e.isArticleAudit(t)):(E.a.error("此新闻源暂不支持导入功能！"),e.setState({loading:!1}))})):"tactics"===n.query.from&&(this.setState({loading:!0}),a(Object(G.f)({url:decodeURIComponent(n.query.urls),id:n.query.newsid},function(t){t?(e.renderData(t),e.setState({loading:!1,tagTitle:t.title}),e.handleSmartTags(),e.inquireRepetition(t),e.isArticleAudit(t)):(E.a.error("此新闻源暂不支持导入功能！"),e.setState({loading:!1}))}))):(localStorage.getItem("articleData")?setTimeout(function(){a(Object(G.b)({},function(t){e.renderData(t)}))},500):this.setState({loading:!1}),this.setState({interval:setInterval(function(){e.saveArticle(),console.log("已存储！")},5e3)}))}},{key:"componentWillUnmount",value:function(){var e=this.state.interval;this.setState({interval:clearInterval(e)})}},{key:"changeActiveImg",value:function(e,t,a){var n=this;if(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),a===this.state.focusImg)return!1;this.setState({ratio:t.ratio,focusImg:a},function(){n.state.cropper.setAspectRatio(t.ratio)})}},{key:"onDetailValueChange",value:function(e){var t,a=e.replace(/<br>+/g,"").replace(/ style=""+/,"").match(/<p(?:(?!<\/p>).|\n)*?<\/p>/gm);t=a?a.join(""):a,this.setState({newsAssist:t})}},{key:"render",value:function(){var e=this,t=this.state.updateOrNot&&(this.props.location.query.id||this.props.location.query.url||"twitter"===this.props.location.query.from),a=this,n=this.props.form.getFieldDecorator,i=this.props,s=i.newsInfo,c=i.classifyList,p=this.state,m=p.selectedTags,g=p.cateId,b=p.focusImg,y=p.allfileList,w=p.uploadAllImgModal,I=p.pcSubjectfileList,C=p.mSubjectfileList,L=p.pcHotSubjectfileList,T=p.mHotSubjectfileList,_=p.progressNum,N=p.videoPcfileList,q=p.videoMfileList,R=p.videofileList,F=p.uploading,U=p.previewVisible,J=p.previewImage,W=p.fileList,G=p.mfileList,Q=p.tags,$=p.inputVisible,K=p.inputValue,Z=p.newsContent,te=p.updateOrNot,ne=p.newsVisible,re=p.mp3fileList,ie=p.list,oe=p.sourceVal,se=p.topicValue,le=p.topicList,ce=p.abstractinfo,ue={labelCol:{span:1},wrapperCol:{span:18}};console.log(s);var pe=[];c.map(function(e){1===e.status&&15!==e.id&&pe.push({label:e.strategyCatName,value:e.strategyCat})});var de=[];s.strategyCat&&pe.map(function(e){(s.strategyCat&e.value)===e.value&&de.push(e.value.toString())});var me={action:"/file/upload",onRemove:this.delPost,beforeUpload:function(t){return e.setState({videoList:[t],videofileList:[t]}),!1},fileList:this.state.videofileList},fe=M.a.createElement("div",null,M.a.createElement(j.a,{type:"plus"}),M.a.createElement("div",{className:"ant-upload-text"},"上传图片")),Se=[{label:"MarsBit",value:"fff9d400cb94444fadaefd429516c276"}];0!==ie.length&&ie.map(function(e){return Se.push({label:e.nickName,value:e.passportId}),Se});var Ie=this.state.data.map(function(e){return M.a.createElement(be,{title:Object(X.R)(e.type,e.name),dataType:e.type,className:"tagType-".concat(e.type),value:JSON.stringify({id:e.id,type:e.type}),key:e.id},e.name)});return M.a.createElement("div",{className:"post-send"},M.a.createElement(d.a,{spinning:this.state.loading,size:"large"},M.a.createElement(D.a,{onSubmit:this.handleSubmit},M.a.createElement(f.a,null,M.a.createElement(h.a,{span:24},M.a.createElement(ge,ae({},ue,{label:"标题: "}),n("title",{initialValue:te&&s?"".concat(s.title):"",rules:[{required:!0,message:"请输入新闻标题！"}]})(M.a.createElement(A.a,{className:"title-input",autoFocus:!0,placeholder:"新闻标题"}))))),M.a.createElement(f.a,{style:{maxWidth:1200}},M.a.createElement(h.a,{span:6},M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:12},label:"作者: "},n("author",{initialValue:te&&s?"".concat(s.author):"",rules:[{required:!0,message:"请输入作者！"}]})(M.a.createElement(A.a,{ref:function(t){e.authorInput=t},className:"news-author",placeholder:"请输入作者"})))),M.a.createElement(h.a,{span:5},0!==Se.length&&1===parseInt(g)?M.a.createElement(ge,{className:"labelWidth60",labelCol:{span:1},wrapperCol:{span:16},label:"来源"},n("source",{initialValue:this.props.newsInfo.id?{key:this.props.newsInfo.createdBy,label:this.props.newsInfo.source}:oe,rules:[{required:!0,message:"请选择新闻来源！"}]})(M.a.createElement(V.a,{labelInValue:!0,showSearch:!0,style:{width:"100%"},placeholder:"选择新闻来源",defaultActiveFirstOption:!1,notFoundContent:this.state.searching?M.a.createElement(d.a,{size:"small"}):"未查询到相关内容",showArrow:!0,optionFilterProp:"children",filterOption:!0,onChange:this.optionChange,onSearch:this.optionSearchChange,onBlur:this.seleceOnBlur,allowClear:!0},0!==Se.length&&Se.map(function(e){return M.a.createElement(be,{key:e.value},e.label)})))):M.a.createElement(ge,{className:"labelWidth60",labelCol:{span:1},wrapperCol:{span:16},label:"来源: "},n("sourceTrans",{initialValue:te&&s&&2===s.cateId||this.props.location.query.url?"".concat(s.source||""):"",rules:[{required:!0,message:"请输入新闻来源！"}]})(M.a.createElement(A.a,{onChange:this.optionSearchChange,className:"news-source",placeholder:"请输入新闻来源"})))),M.a.createElement(h.a,{span:7},M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:15},label:"所属专题: "},n("topicValue",{initialValue:se,rules:[{required:!1,message:"请输入核心关键词！"}]})(M.a.createElement(V.a,{labelInValue:!0,showSearch:!0,style:{width:"100%"},placeholder:"选择所属专题",defaultActiveFirstOption:!1,notFoundContent:this.state.loading?M.a.createElement(d.a,{size:"small"}):"未查询到相关内容",showArrow:!0,optionFilterProp:"children",filterOption:!0,allowClear:!0},0!==le.length&&le.map(function(e){return M.a.createElement(be,{key:e.id},e.topicName)}))))),M.a.createElement(h.a,{span:5},M.a.createElement(ge,{className:"labelWidth60",labelCol:{span:1},wrapperCol:{span:16},label:"类别: "},n("cateId",{initialValue:te&&s?"".concat(s.cateId||"2"):"1",rules:[{required:!0,message:"请选择类别！"}]})(M.a.createElement(ve,{options:je,onChange:this.cateIdChange,setFieldsValue:this.state.cateId}))))),M.a.createElement(f.a,null,M.a.createElement(h.a,null,(2===parseInt(g)||this.props.location.query.url)&&M.a.createElement("div",{className:"reprint"},M.a.createElement(h.a,{span:12},M.a.createElement(ge,ae({},ue,{label:"原文标题: "}),n("originalTitle",{initialValue:te&&s?"".concat(s.originalTitle||""):"",rules:[{required:!0,message:"请输入原文标题！"}]})(M.a.createElement(A.a,{className:"news-source",placeholder:"请输入原文标题"})))),M.a.createElement(h.a,{span:12},M.a.createElement(ge,ae({},ue,{label:"原文链接: "}),n("originalUrl",{initialValue:te&&s?"".concat(s.originalUrl||""):"",rules:[{required:!1,message:"请输入原文链接！"}]})(M.a.createElement(A.a,{className:"news-source",placeholder:"请输入原文链接"}))))))),0!==this.props.channelList.length&&M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:20},label:"频道: "},n("channelId",{initialValue:te&&s?"".concat(s.channelId||"87"):"87",rules:[{required:!0,message:"请选择频道！"}]})(M.a.createElement(ve,{options:this.props.channelList.filter(function(e){return!e.disabled}),onChange:this.channelIdChange,setFieldsValue:this.state.channelId}))),M.a.createElement("div",{style:{display:"none"}},0!==c.length&&M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:20},label:"策略分类: "},n("strategyCat",{initialValue:te&&s?de:[],rules:[{required:!1,message:"请选择策略名称！"}]})(M.a.createElement(we,null,M.a.createElement(f.a,null,pe.map(function(e,t){return M.a.createElement(h.a,{span:2,key:t},M.a.createElement(O.a,{value:"".concat(e.value)},e.label))})))))),M.a.createElement(f.a,{style:{maxWidth:1200}},M.a.createElement(h.a,{span:6},M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:15},label:"发布日期: "},n("publishTime",{rules:[{required:!0,message:"请选择新闻发布时间！"}],initialValue:te&&s&&0!==s.status?Y()(Object(X.w)(s.publishTime||Date.parse(new Date)),"YYYY-MM-DD HH:mm:ss"):Y()()})(M.a.createElement(u.a,{disabled:this.state.dateDisabled,showTime:!0,format:"YYYY-MM-DD HH:mm:ss"})),M.a.createElement(ve,{onChange:this.dateChange,defaultValue:this.state.dateDisabled?0:1},M.a.createElement(P.a,{value:0},"实时"),M.a.createElement(P.a,{value:1},"修改")))),M.a.createElement(h.a,{span:5},M.a.createElement(ge,{className:"labelWidth60",labelCol:{span:1},wrapperCol:{span:16},label:"热度: "},n("hotCounts",{initialValue:te&&s&&s.hotCounts||0,rules:[{required:!0,pattern:/^[0-9]+$/,message:"请输入新闻热度值(正整数)！"}]})(M.a.createElement(A.a,{className:"news-source",placeholder:"请输入新闻热度值"})))),M.a.createElement(h.a,{span:6},M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:15},label:"核心关键词: "},n("keyTags",{initialValue:te&&s?"".concat(s.keyTags||""):"",rules:[{required:!1,message:"请输入核心关键词！"}]})(M.a.createElement(A.a,{placeholder:"核心关键词"}))))),M.a.createElement(f.a,{style:{width:900}},M.a.createElement(h.a,{span:4},M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:8},label:"文章左对齐: "},n("alignLeft",{initialValue:!1,valuePropName:"checked"})(M.a.createElement(l.a,{onChange:function(t){e.setState({alignLeft:t?1:0},function(){e.sendPost({postTitle:e.state.newsTitle,postContent:e.state.editor.root.innerHTML})})},checkedChildren:"是",unCheckedChildren:"否"})))),M.a.createElement(h.a,{span:4},M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:8},label:"英文强制换行: "},n("wordBreak",{initialValue:!1,valuePropName:"checked"})(M.a.createElement(l.a,{onChange:function(t){e.setState({wordBreak:t?1:0},function(){e.sendPost({postTitle:e.state.newsTitle,postContent:e.state.editor.root.innerHtml})})},checkedChildren:"是",unCheckedChildren:"否"})))),M.a.createElement(h.a,{span:4},M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:8},label:"图片加水印: "},n("watermark",{initialValue:!0,valuePropName:"checked"})(M.a.createElement(l.a,{onChange:function(e){e?ee.a.set("watermark",1):ee.a.set("watermark",0)},checkedChildren:"是",unCheckedChildren:"否"})))),M.a.createElement(h.a,{span:3},M.a.createElement(ge,{className:"labelWidth40",labelCol:{span:1},wrapperCol:{span:10},label:"独家: "},n("original",{initialValue:!(!te||!s.original)&&1===parseInt(s.original),valuePropName:"checked"})(M.a.createElement(l.a,{onChange:function(t){e.setState({original:t?1:0})},checkedChildren:"是",unCheckedChildren:"否"})))),M.a.createElement(h.a,{span:3},M.a.createElement(ge,{className:"labelWidth40",labelCol:{span:1},wrapperCol:{span:10},label:"推广: "},n("advertised",{initialValue:!(!te||!s.advertised)&&1===parseInt(s.advertised),valuePropName:"checked"})(M.a.createElement(l.a,{onChange:function(t){e.setState({advertised:t?1:0})},checkedChildren:"是",unCheckedChildren:"否"}))))),M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:20},style:{maxWidth:1200},label:"辅助信息"},n("subTitle",{initialValue:te&&s?"".concat(s.subTitle):"",rule:[{max:1024,required:!1,message:"选填"}]})(M.a.createElement(he,{style:{whiteSpace:"pre-line",display:"none"},className:"news-summary",placeholder:"可填写原文作者、原文标题、编译人员等信息"})),M.a.createElement(z.a,{onValueChange:function(t){e.onDetailValueChange(t)},info:te&&s?s.subTitle:""})),M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:20},label:"内容: "},n("content",{initialValue:te&&s?Z:"",rules:[{required:!0,message:"请输入新闻内容！"}]})(M.a.createElement(A.a,{className:"news",style:{display:"none"}})),M.a.createElement("div",{className:"media-quill-editor"},M.a.createElement(H.a,{paste:this.editorPaste,setEditor:function(t){e.setState({editor:t})},subSend:function(t){return e.sendPost(t)}}))),M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:20},style:{maxWidth:1200},label:"摘要: "},M.a.createElement(he,{rows:4,value:ce,onChange:function(t){e.handleWhitter(t)},className:"news-summary",placeholder:"新闻摘要, 最多120字"}),M.a.createElement(v.a,{size:"small",loading:this.state.ailoading,type:"primary",onClick:this.handleAigetdesc},ce&&ce.indexOf("【GPT】")>-1?"AI重新生成":"AI生成摘要")),M.a.createElement(ge,ae({},ue,{style:{display:"none"},label:"标签: "}),n("tags",{initialValue:this.state.tags.join(","),rules:[{required:!1,message:"至少输入一个标签！"}]})(M.a.createElement(A.a,{className:"tag-item",style:{display:"none"}})),M.a.createElement("div",null,Q.map(function(t,a){var n=t.length>20,r=M.a.createElement(x.a,{color:"blue",key:t,closable:-1!==a,afterClose:function(){return e.handleClose(t)}},n?"".concat(t.slice(0,20)):t);return n?M.a.createElement(o.a,{title:t,key:t},r):r}),$&&M.a.createElement(A.a,{ref:this.saveInputRef,type:"text",size:"small",style:{width:120},value:K,onChange:this.handleInputChange,onBlur:this.handleInputConfirm,onPressEnter:this.handleInputConfirm}),!$&&Q.length<20&&M.a.createElement(x.a,{onClick:this.showInput,style:{background:"#fff",borderStyle:"dashed"}},M.a.createElement(j.a,{type:"plus"})," New Tag"),M.a.createElement("span",null,"每个标签最多",M.a.createElement("font",{style:{color:"red"}}," 20 "),"个字"))),M.a.createElement(ge,ae({},ue,{label:"智能标签: "}),n("smartTags",{initialValue:this.state.tags.join(","),rules:[{required:!1,message:"至少输入一个标签！"}]})(M.a.createElement(A.a,{className:"tag-item",style:{display:"none"}})),this.state.smartTagsStatus?M.a.createElement("div",null,0!==this.state.smartTags.length?this.state.smartTags.map(function(t){var a=JSON.stringify({id:t.id,type:t.type,name:t.name});return M.a.createElement(ye,{style:{border:"1px dashed #108ee9"},key:a,checked:m.indexOf(a)>-1,onChange:function(t){return e.handleTagsSelect(a,t)}},t.name)}):"未匹配到合适的关键词，请手动添加",0!==this.state.smartTags.length&&"(点击选择/取消需要关联的标签)",M.a.createElement(v.a,{loading:this.state.tagsLoading,style:{margin:"0 10px"},size:"small",type:"primary",onClick:this.handleSmartTags},"重新生成"),M.a.createElement(v.a,{size:"small",type:"primary",onClick:this.handleSmartTagsCancel},"取消")):M.a.createElement("div",null,"点击",M.a.createElement(v.a,{loading:this.state.tagsLoading,style:{margin:"0 10px"},size:"small",type:"primary",onClick:this.handleSmartTags},"此处"),"根据内容智能生成行情(币)标签")),M.a.createElement(f.a,{style:{maxWidth:1200}},M.a.createElement(h.a,{span:18},M.a.createElement(ge,ae({},ue,{label:"新版标签："}),n("tagsV2",{initialValue:te&&s&&s.tagsV2&&0!==JSON.parse(s.tagsV2).length?this.transTags(JSON.parse(s.tagsV2)):[],rules:[{required:!0,message:"请选择相关标签！"}]})(M.a.createElement(V.a,{mode:"multiple",showSearch:!0,labelInValue:!0,notFoundContent:this.state.searching?M.a.createElement(d.a,{size:"small"}):this.state.searchText,filterOption:!1,optionFilterProp:"children",style:{width:"100%"},onSearch:this.getTagList,onSelect:this.handleSelect,onDeselect:this.handleDeselect,onChange:this.handleTagsChange,onBlur:this.handleBlur},Ie)),this.state.noCurrResult&&M.a.createElement("p",{style:{position:"absolute",right:"-160px",bottom:0}},M.a.createElement("span",null,"未找到结果?"),M.a.createElement(v.a,{type:"primary",loading:this.state.tagsIconLoading,style:{margin:"0 10px"},onClick:this.addNewTag,size:"small"},"创建"),M.a.createElement("span",null,"一个"))))),M.a.createElement(f.a,{style:{width:900}},M.a.createElement(h.a,{span:6},M.a.createElement(ge,{labelCol:{span:1},wrapperCol:{span:14},label:"图片自动剪裁: "},M.a.createElement("div",{className:"dropbox"},M.a.createElement(S.a,{headers:{"Sign-Param":Object(X.A)()},action:"".concat(X.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:y,onPreview:this.handlePreview,onChange:this.uploadAllImg},y.length>=1?null:fe)))),M.a.createElement(h.a,{span:4},this.FormItem({imgName:"pc",label:"PC-缩略图",imgUrl:"Img",newsInfo:s,fileList:W,changeEvent:this.handleChange,size:"220px * 160px",noBtn:!0,require:!0})),M.a.createElement(h.a,{span:4},this.FormItem({imgName:"wap_small",label:"M-缩略图",imgUrl:"mImg",newsInfo:s,fileList:G,changeEvent:this.handleMobileChange,size:"164px * 109px",noBtn:!0,require:!0}))),M.a.createElement(f.a,{style:{maxWidth:1e3}},M.a.createElement(h.a,{span:9,style:{display:"none"}},M.a.createElement(ge,ae({},ue,{label:"添加视频"}),n("video")(M.a.createElement(S.a,ae({},me,{name:"uploadFile"}),M.a.createElement(v.a,null,M.a.createElement(j.a,{type:"upload"})," 选择视频"))),0===R.length?"":R[0].fileName?M.a.createElement("p",null,M.a.createElement("span",null,R[0].fileName),M.a.createElement("span",{onClick:e.delPost,style:{marginLeft:15,color:"#52b8fc",cursor:"pointer"}},"删除")):void 0,M.a.createElement(v.a,{style:{position:"absolute",left:120,top:0},className:"upload-demo-start",type:"primary",onClick:this.handleUpload,disabled:0===this.state.videoList.length,loading:F},F?"上传中":"开始上传"),F&&M.a.createElement(r.a,{strokeWidth:5,style:{width:300,display:"block"},percent:_,status:"active"}))),M.a.createElement(h.a,{span:12},M.a.createElement(ge,ae({},ue,{label:"添加音频"}),n("audio",{valuePropName:"mp3fileList",getValueFromEvent:this.normFile})(M.a.createElement(S.a,{headers:{"Sign-Param":Object(X.A)()},defaultFileList:this.state.mp3fileList,action:"".concat(X.a,"/audio/upload"),name:"uploadFile",filelist:re,onChange:this.handleMp3},M.a.createElement(v.a,null,M.a.createElement(j.a,{type:"upload"})," 点击上传音频"))),M.a.createElement("ul",null,this.state.audioDefalutArr.map(function(e,t){return M.a.createElement("li",{key:t},e.fileName,M.a.createElement("span",{style:{marginLeft:"10px",cursor:"pointer"},onClick:function(){a.delAudio(e.uid)}},"删除"))}))))),R[0]&&R[0].fileUrl?M.a.createElement(f.a,{className:"post-cover",style:{marginLeft:80}},M.a.createElement(h.a,{span:4},this.FormItem({imgName:"video_pc",label:"视频PC封面",imgUrl:"",newsInfo:s,fileList:N,changeEvent:this.handleVideoPcChange,size:" 280px * 205px",noBtn:!0,require:!0})),M.a.createElement(h.a,{span:4},this.FormItem({imgName:"video_m",label:"视频 M 端封面",imgUrl:"",newsInfo:s,fileList:q,changeEvent:this.handleVideoMChange,size:" 280px * 205px",noBtn:!0,require:!0}))):"",M.a.createElement(ge,ae({style:{display:"none"}},ue,{label:"是否专题: "}),n("subject",{initialValue:!!te&&1===parseInt(this.state.subject),valuePropName:"checked"})(M.a.createElement(l.a,{onChange:function(t){e.setState({subject:t?1:0})},checkedChildren:"是",unCheckedChildren:"否"}))),1!==parseInt(this.state.subject)?"":M.a.createElement("div",null,this.FormItem({imgName:"pc_subject",label:"专题 pc 端",imgUrl:"",newsInfo:s,fileList:I,changeEvent:this.handlePcSubjectChange,size:"580 * 285",noBtn:!0,require:!0}),this.FormItem({imgName:"pc_hot_subject",label:"专题 pc 推荐",imgUrl:"",newsInfo:s,fileList:L,changeEvent:this.handlePcHotSubjectChange,size:"580 * 400",noBtn:!0,require:!0}),this.FormItem({imgName:"m_subject",label:"专题 M 端",imgUrl:"",newsInfo:s,fileList:C,changeEvent:this.handleMSubjectChange,size:"500 * 280",noBtn:!0,require:!0}),this.FormItem({imgName:"m_hot_subject",label:"专题 M 推荐",imgUrl:"",newsInfo:s,fileList:T,changeEvent:this.handleMHotSubjectChange,size:"500 * 280",noBtn:!0,require:!0})),M.a.createElement(ge,{style:{maxWidth:1e3},wrapperCol:{span:12,offset:2}},M.a.createElement(v.a,{type:"primary",className:"preview",onClick:this.isRepetition,style:{marginRight:"10px",marginBottom:10}},"检测重复"),M.a.createElement(v.a,{type:"primary","data-status":"1",onClick:this.handleSubmit,style:{marginRight:"10px"}},"发表"),M.a.createElement(v.a,{type:"primary","data-status":"3",onClick:this.handleSubmit,style:{marginRight:"10px"}},"定时发表"),M.a.createElement(v.a,{type:"primary","data-status":"0",onClick:this.handleSubmit,style:{marginRight:"10px"}},"存为草稿"),M.a.createElement(v.a,{type:"primary",className:"cancel",onClick:function(){B.hashHistory.goBack()}},"取消")),M.a.createElement(k.a,{confirmLoading:this.state.confirmLoading,height:"700px",width:"1400px",style:{top:"50px"},visible:w,onOk:this.sureCropImg,maskClosable:!1,onCancel:this.uploadAllImgCancel},M.a.createElement("div",{className:"croper-wrap post clearfix"},M.a.createElement("div",{className:"crop-img",id:"cropImgWrap"},M.a.createElement("img",{id:"croppedImg",src:"",alt:"Picture"})),M.a.createElement("div",{onClick:function(t){t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),e.setState({focusImg:-1})},className:"crop-preview"},this.state.cropImgRule.map(function(e,t){return M.a.createElement("div",{key:t,onClick:function(n){a.changeActiveImg(n,e,t)},className:"cropper-intro"},M.a.createElement("div",{className:"cropper-item-wrap ".concat(b===t?"active":"")},M.a.createElement("div",{"data-type":e.coverName,"data-list":e.coverList,className:"crop-preview-item",style:{fontSize:0,width:e.width,height:e.height}},M.a.createElement("img",{src:"",alt:"",style:{width:"100%",height:"100%"}}))),M.a.createElement("span",null,e.intro))})))),M.a.createElement(k.a,{visible:ne,footer:null,className:"newsModal",onCancel:this.newsVisibleHide,width:1e3},M.a.createElement(f.a,null,M.a.createElement(h.a,{className:"previewNews simditor"},M.a.createElement("p",{className:"simditor-body",style:{padding:10},dangerouslySetInnerHTML:this.createMarkup(Z)})))),M.a.createElement(k.a,{title:"提示",visible:this.state.isRepetition,onOk:this.isRepetitionOk,onCancel:this.isRepetitionCancel},M.a.createElement("p",{style:{lineHeight:"40px",fontSize:"14px"}},this.state.isRepetitionEdit," ",M.a.createElement("a",{href:this.state.similarityUrl,style:{display:""===this.state.similarityUrl?"none":"inlineBlock"},target:"_blank"},"查看相似文章"))),M.a.createElement(k.a,{visible:U,footer:null,onCancel:this.handleCancel},M.a.createElement("img",{alt:"example",style:{width:"100%"},src:J}))),!t&&M.a.createElement(v.a,{onClick:function(){e.saveArticle(),E.a.success("本地保存成功!")},title:"存一下",className:"fix-button",type:"primary",shape:"circle",icon:"download",size:"large"})))}}])&&le(n.prototype,i),s&&le(n,s),a}();t.default=Object(U.connect)(function(e){return{list:e.postAccountInfo.list,userInfo:e.postInfo.userInfo,newsInfo:e.postInfo.info,channelList:e.channelListInfo,classifyList:e.postTacticsInfo.list}})(D.a.create()(Le))}.call(this,a(97))},1608:function(e,t,a){"use strict";a.d(t,"a",function(){return s});a(361);var n=a(20),r=a.n(n),i=a(48),o=a(2),s=function(e,t,a){return function(n){Object(i.i)(e,"/news/strategyCategory/showStrategyCategorylist",t,function(e){if(1===e.code){var t=e.obj;n({type:o.nb.LIST_POST_TACTICS,data:t}),a&&a(t)}else r.a.error(e.msg)})}}},1609:function(e,t,a){var n=a(1613);"string"==typeof n&&(n=[[e.i,n,""]]);var r={transform:void 0};a(186)(n,r);n.locals&&(e.exports=n.locals)},1613:function(e,t,a){(e.exports=a(185)(!1)).push([e.i,"",""])},1614:function(e,t,a){"use strict";a.d(t,"a",function(){return b});var n=a(0),r=a.n(n),i=a(1402),o=a.n(i),s=a(248);a(1615);function l(e,t,a,n,r,i,o){try{var s=e[i](o),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(n,r)}function c(e){return function(){var t=this,a=arguments;return new Promise(function(n,r){var i=e.apply(t,a);function o(e){l(i,n,r,o,s,"next",e)}function s(e){l(i,n,r,o,s,"throw",e)}o(void 0)})}}function u(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var g=o.a.import("delta"),h=function(e){var t=this.quill.getSelection(!0),a=this.quill.getContents(t.index,t.length),n=(new g).retain(t.index+t.length);a.ops=a.ops.map(function(e){if(!e.insert)return e;if("object"!==f(e.insert))return{insert:e.insert};switch(Object.keys(e.insert)[0]){case"LinkBlot":return{insert:e.insert.LinkBlot.text};default:return{insert:e.insert}}}),n=n.concat(a),this.quill.updateContents(n,o.a.sources.USER),this.quill.deleteText(t.index,t.length),this.quill.videoInit()},b=function(e){function t(e){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=p(this,d(t).call(this,e));var n=e.toolbar;return a.toolbarOptions=n||[[{header:[1,2,3,4,!1]}],[{header:2},"bold","italic","underline","strike"],["blockquote"],[{color:[]},{background:[]}],[{align:[]}],[{list:"ordered"},{list:"bullet"}],["link","image","video"],["clean"],["sourceEditor"]],a.state={editor:null,fullscreen:!1},a}var a,i,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(t,n["Component"]),a=t,(i=[{key:"componentDidMount",value:function(){var e=this,t={modules:{toolbar:{container:this.toolbarOptions,handlers:{clean:h}},imageResize:{},clipboard:{imageUpload:function(){var e=c(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,Object(s.p)([{signTime:(new Date).getTime(),imgSrc:t||""}]);case 3:if(!((a=e.sent)&&a.code&&1===a.code&&a.obj[0]&&a.obj[0].imgSrc)){e.next=6;break}return e.abrupt("return",a.obj[0].imgSrc);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),paste:function(t){e.props.state&&e.props.paste(t)},matchVisual:!1},mediaUploader:{imageUpload:function(){var e=c(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,Object(s.c)({type:"news",uploadFile:t});case 3:if(!(a=e.sent)||1!==a.code){e.next=6;break}return e.abrupt("return",a.obj);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),videoUpload:function(){var e=c(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.d)({file:t});case 2:if(!(a=e.sent)){e.next=5;break}return e.abrupt("return",a);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}},placeholder:"请输入文章内容",theme:"snow"},a=new o.a("#editorQuill",t);a.on("text-change",function(t,n,r){e.props.subSend({postContent:a.root.innerHTML})}),this.props.setEditor&&this.props.setEditor(a),this.setState({editor:a});var n=document.createElement("span");n.setAttribute("class","ql-formats ql-fullscreen-formats");var r=document.createElement("button");r.setAttribute("type","button"),r.setAttribute("class","ql-fullscreen"),r.innerHTML='<svg class="ql-fullscreen-svg" viewBox="0 0 1024 1024"><path d="M160 96h192q14.016 0.992 23.008 10.016t8.992 22.496-8.992 22.496T352 160H160v192q0 14.016-8.992 23.008T128 384t-23.008-8.992T96 352V96h64z m0 832H96v-256q0-14.016 8.992-23.008T128 640t23.008 8.992T160 672v192h192q14.016 0 23.008 8.992t8.992 22.496-8.992 22.496T352 928H160zM864 96h64v256q0 14.016-8.992 23.008T896 384t-23.008-8.992T864 352V160h-192q-14.016 0-23.008-8.992T640 128.512t8.992-22.496T672 96h192z m0 832h-192q-14.016-0.992-23.008-10.016T640 895.488t8.992-22.496T672 864h192v-192q0-14.016 8.992-23.008T896 640t23.008 8.992T928 672v256h-64z" p-id="8486"></path></svg>',n.appendChild(r),document.querySelector(".ql-toolbar").appendChild(n),document.addEventListener("click",function(t){var a=t.target.getAttribute("class");a&&a.indexOf("ql-fullscreen")>-1&&e.setState({fullscreen:!e.state.fullscreen})},!1)}},{key:"render",value:function(){return r.a.createElement("div",{className:"editor-quill-box ".concat(this.state.fullscreen?"active":"")},r.a.createElement("div",{className:"editor-quill-cotent"},r.a.createElement("div",{id:"editorQuill"})))}}])&&u(a.prototype,i),l&&u(a,l),t}()},1615:function(e,t,a){var n=a(1616);"string"==typeof n&&(n=[[e.i,n,""]]);var r={transform:void 0};a(186)(n,r);n.locals&&(e.exports=n.locals)},1616:function(e,t,a){(e.exports=a(185)(!1)).push([e.i,"",""])},1624:function(e,t,a){"use strict";a.d(t,"e",function(){return c}),a.d(t,"b",function(){return u}),a.d(t,"d",function(){return p}),a.d(t,"c",function(){return d}),a.d(t,"a",function(){return m}),a.d(t,"h",function(){return g}),a.d(t,"f",function(){return h}),a.d(t,"g",function(){return b});a(361);var n=a(20),r=a.n(n),i=a(48),o=a(2);function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){l(e,t,a[t])})}return e}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c=function(e){return{type:o.xb,data:e}},u=function(e,t,a){return function(n){var o="init"===e?"/account/author/list":"/post/search";Object(i.i)("get",o,t?s({},t):{},function(e){if(1===e.code){var t=e.obj;n(f({list:t.inforList})),n(b({totalCount:t.recordCount,pageSize:t.pageSize,currPage:t.currentPage})),a&&a(t)}else r.a.error(e.msg)})}},p=function(){return Object(i.k)({type:"get",url:"/account/author/list",params:{pageSize:1e4,currentPage:1}})},d=function(e){return Object(i.k)({type:"post",url:"/account/author/importnews",params:{passportId:e}})},m=function(e,t){return function(a){Object(i.i)("post","/account/author/add",s({},e),function(e){t&&t(e),1===e.code?r.a.success("添加成功！"):r.a.error(e.msg)})}},f=function(e){return{type:o.nb.ADD_DATA,data:e}},g=function(e){return{type:o.nb.SET_SEARCH_QUERY,data:e}},h=function(e){return{type:o.nb.SET_FILTER_DATA,data:e}},b=function(e){return{type:o.nb.SET_PAGE_DATA,data:e}}},1639:function(e,t,a){"use strict";(function(e){a.d(t,"i",function(){return c}),a.d(t,"e",function(){return u}),a.d(t,"d",function(){return p}),a.d(t,"b",function(){return d}),a.d(t,"g",function(){return m}),a.d(t,"f",function(){return f}),a.d(t,"c",function(){return g}),a.d(t,"h",function(){return h}),a.d(t,"a",function(){return v}),a.d(t,"l",function(){return y}),a.d(t,"j",function(){return S}),a.d(t,"k",function(){return w});a(361);var n=a(20),r=a.n(n),i=a(48),o=a(2);function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){l(e,t,a[t])})}return e}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c=function(e){return{type:o.xb,data:e}},u=function(e,t,a){return function(n){var o="init"===e?"/news/shownews":"/post/search";Object(i.i)("get",o,t?s({},t,{createrType:0}):{},function(e){if(1===e.code){var t=e.obj;n(b({list:t.inforList})),n(w({totalCount:t.recordCount,pageSize:t.pageSize,currPage:t.currentPage})),a&&a(t)}else r.a.error(e.msg)})}},p=function(e,t){return function(a){Object(i.i)("post","/news/getbyid",s({},e),function(e){if(1===e.code){var n=e.obj;a(b({info:n})),t&&t(n)}else r.a.error(e.msg)})}},d=function(e,t){return function(e){var a=localStorage.getItem("articleData");if(!a)return!1;e(b({info:JSON.parse(a)})),t&&t(JSON.parse(a))}},m=function(e,t){return function(a){Object(i.i)("post","/crawler/social/source/importNewsInfo",s({},e),function(e){if(t&&t(e.obj),1===e.code){console.log(e.obj);var n=e.obj;a(b({info:n}))}else r.a.error(e.msg)})}},f=function(e,t){return function(a){Object(i.i)("post","/crawler/social/source/importStrategyInfo",s({},e),function(e){if(t&&t(e.obj),1===e.code){var n=e.obj;a(b({info:n}))}else r.a.error(e.msg)})}},g=function(e,t){return function(a){Object(i.i)("post","/merge/parseurl",s({},e),function(e){if(t&&t(e.obj),1===e.code){var n=e.obj;a(b({info:n}))}else r.a.error(e.msg)})}},h=function(e,t){return function(a){Object(i.i)("post","/news/setorder",s({},e),function(a){1===a.code?(0===parseInt(e.topOrder)?r.a.success("取消置顶成功！"):r.a.success("置顶成功！"),t&&t()):r.a.error(a.msg)})}},b=function(e){return{type:o.mb.ADD_DATA,data:e}},v=function(e,t){return{type:o.mb.EDIT_LIST_ITEM,data:e,index:t}},y=function(e){return{type:o.mb.SET_SEARCH_QUERY,data:e}},S=function(e){return{type:o.mb.SET_FILTER_DATA,data:e}},w=function(e){return{type:o.mb.SET_PAGE_DATA,data:e}}}).call(this,a(97))},1667:function(e,t,a){"use strict";a(184);var n=a(1378),r=a.n(n),i=a(0),o=a.n(i),s=a(246),l=a(97),c=a.n(l),u=a(1399),p=a.n(u),d=(a(1640),a(1622)),m=a.n(d);a(1668),a(1623);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v(e,t){return(v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=r.a.TextArea,S=function(e){function t(e){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=h(this,b(t).call(this,e))).state={info:{postContent:""}};var n=e.toolBar;return a.EDITTOOLBAR=n||["link"],a}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v(e,t)}(t,i["Component"]),a=t,(n=[{key:"shouldComponentUpdate",value:function(e,t){return JSON.stringify(this.props.info)!==JSON.stringify(e.info)}},{key:"componentDidMount",value:function(){this.editor=new p.a({pasteImage:!0,textarea:c()(".editor"),defaultImage:m.a,placeholder:"可填写原文作者、原文标题、编译人员等信息",toolbar:this.EDITTOOLBAR,cleanPaste:!0,allowedTags:["a","span","p","br"]}),this.bindEditorEvent()}},{key:"bindEditorEvent",value:function(){var e=this;this.editor.on("valuechanged ",function(t){var a=e.editor.getValue();e.setState({info:e.editor.getValue()}),e.props.onValueChange(a)})}},{key:"render",value:function(){if(void 0!==this.editor){var e=this.editor.getValue();this.props.info!==e&&this.editor.setValue(this.props.info)}return o.a.createElement("div",{className:"editor-post-content"},o.a.createElement(y,{className:"editor",autosize:!0}))}}])&&g(a.prototype,n),r&&g(a,r),t}();t.a=Object(s.connect)(function(e){return{query:e.postInfo.query}})(S)},1668:function(e,t,a){var n=a(1669);"string"==typeof n&&(n=[[e.i,n,""]]);var r={transform:void 0};a(186)(n,r);n.locals&&(e.exports=n.locals)},1669:function(e,t,a){(e.exports=a(185)(!1)).push([e.i,"",""])}}]);