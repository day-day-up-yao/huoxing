(window.webpackJsonp=window.webpackJsonp||[]).push([[184],{1467:function(t,e,n){"use strict";n.r(e);n(675);var r=n(676),a=n.n(r),o=(n(1379),n(1380)),i=n.n(o),c=(n(361),n(20)),u=n.n(c),l=n(0),s=n.n(l),f=n(10),p=n(246),d=n(1660),y=n(1675),b=n(48);n(1649);function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function v(t){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function k(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w=function(t){function e(){var t,n,r,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return r=this,a=(t=v(e)).call.apply(t,[this].concat(i)),n=!a||"object"!==h(a)&&"function"!=typeof a?g(r):a,k(g(n),"state",{loading:!0,contentList:[]}),k(g(n),"handleSubmit",function(t){t.preventDefault(),n.props.form.validateFieldsAndScroll(function(t,e){t||(n.setState({loading:!0}),e.topic={id:n.props.location.query.id},e.contentList=n.state.contentList,Object(b.m)("/topic/add",e,function(t){1===t.code?(u.a.success("操作成功！"),f.hashHistory.push("/specialTopic-list")):u.a.error(t.msg)}))})}),k(g(n),"createMarkup",function(t){return{__html:t}}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(e,l["Component"]),n=e,(r=[{key:"componentWillMount",value:function(){this.props.location.query.id?this.doSearch("init",{}):this.setState({loading:!1})}},{key:"doSearch",value:function(t,e){var n=this,r=this.props,a=r.dispatch,o=r.pageData,i={id:r.location.query.id,pageSize:500,currentPage:o.currentPage};i=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){k(t,e,n[e])})}return t}({},i,e),a(Object(d.d)(t,i,function(t){n.setState({loading:!1})}))}},{key:"render",value:function(){var t=this,e=this.props,n=e.list,r=e.location;return s.a.createElement("div",{className:"specialTopic-send"},s.a.createElement(a.a,{spinning:this.state.loading,size:"large"},s.a.createElement(i.a,{onSubmit:this.handleSubmit},this.state.loading?"":s.a.createElement(y.a,{backButton:!0,query:r.query.id,dataList:n,update:!0,getData:function(e){t.setState({contentList:e})}}))))}}])&&m(n.prototype,r),o&&m(n,o),e}();e.default=Object(p.connect)(function(t){return{pageData:t.specialTopicInfo.pageData,list:t.specialTopicInfo.contentList,selectData:t.specialTopicInfo.selectedData}})(i.a.create()(w))},1675:function(t,e,n){"use strict";n.d(e,"a",function(){return P});n(1385);var r=n(1386),a=n.n(r),o=(n(247),n(183)),i=n.n(o),c=(n(1405),n(1406)),u=n.n(c),l=(n(361),n(20)),s=n.n(l),f=(n(184),n(1378)),p=n.n(f),d=n(0),y=n.n(d),b=n(10),h=n(48);n(1676);function m(t){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){j(t,e,n[e])})}return t}function g(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function O(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function w(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(t,e){return(S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function j(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E=[],C=function(t){var e=t.editable,n=t.value,r=t.onChange,a=t.type;return y.a.createElement("div",null,e?y.a.createElement(p.a,{type:a||"text",style:{margin:"-5px 0"},value:n,onChange:function(t){return r(t.target.value)}}):n)},P=function(t){function e(t){var n,r,a;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,a=k(e).call(this,t),n=!a||"object"!==m(a)&&"function"!=typeof a?w(r):a,j(w(n),"handleAdd",function(){var t=n.state,e=t.count,r=t.data,a={editable:!0,key:e,title:"标题".concat(e),url:"http://www.huoxing24.com/",synopsis:"无"};n.setState({data:[a].concat(g(r)),count:e+1})}),j(w(n),"onDelete",function(t,e){var r=g(n.state.data);if(e.id){var a={status:0};a.id=e.id,Object(h.i)("POST","/topic/delcontent",v({},a),function(e){1===e.code?(s.a.success("操作成功！"),n.setState({data:r.filter(function(e){return e.key!==t})}),n.setContentList(r.filter(function(e){return e.key!==t}))):s.a.error(e.msg)})}else n.setState({data:r.filter(function(e){return e.key!==t})}),n.setContentList(r.filter(function(e){return e.key!==t}))}),j(w(n),"setContentList",function(t){var e=[];t.map(function(t,n){var r={};for(var a in t)"key"!==a&&"editable"!==a&&(r[a]=t[a]);e.push(r)}),n.props.getData(e)});var o=n.props,i=o.dataList,c=o.update;n.columns=[{title:"文章标题",dataIndex:"title",width:"30%",render:function(t,e){return n.renderColumns(t,e,"title","text")}},{title:"文章链接(请输入完整的URL地址)",dataIndex:"url",width:"35%",render:function(t,e){return n.renderColumns(t,e,"url","url")}},{title:"备注",dataIndex:"synopsis",width:"15%",render:function(t,e){return n.renderColumns(t,e,"synopsis","text")}},{title:"操作",dataIndex:"operation",render:function(t,e){var r=e.editable;return y.a.createElement("div",{className:"editable-row-operations"},r?y.a.createElement("span",null,y.a.createElement("a",{onClick:function(){return n.save(e.key)}},"保存"),y.a.createElement(u.a,{title:"确定要放弃修改吗？",onConfirm:function(){return n.cancel(e.key)}},y.a.createElement("a",null,"取消"))):y.a.createElement("a",{onClick:function(){return n.edit(e.key)}},"编辑"),n.state.data.length>0?y.a.createElement(u.a,{title:"确定要删除吗？",onConfirm:function(){return n.onDelete(e.key,e)}},y.a.createElement("a",{href:"#"},"删除")):null)}}];var l=[];return c&&i.map(function(t,e){t.key=e,l.push(t)}),n.state=c?{data:l,count:l.length}:{data:E,count:1},n.cacheData=E.map(function(t){return v({},t)}),n}var n,r,o;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}(e,d["Component"]),n=e,(r=[{key:"componentWillUpdate",value:function(){}},{key:"renderColumns",value:function(t,e,n,r){var a=this;return y.a.createElement(C,{type:r,editable:e.editable,value:t,onChange:function(t){return a.handleChange(t,e.key,n)}})}},{key:"handleChange",value:function(t,e,n){var r=g(this.state.data),a=r.filter(function(t){return e===t.key})[0];a&&(a[n]=t,this.setState({data:r}),this.setContentList(r))}},{key:"edit",value:function(t){var e=g(this.state.data),n=e.filter(function(e){return t===e.key})[0];this.cacheData=e.map(function(t){return v({},t)}),n&&(n.editable=!0,this.setState({data:e}))}},{key:"save",value:function(t){var e=this,n=g(this.state.data),r=n.filter(function(e){return t===e.key})[0];if(this.props.query){var a={};for(var o in r)"key"!==o&&"editable"!==o&&(a[o]=r[o]);if(r&&!r.id){var i={topic:{id:this.props.query},contentList:[]};i.contentList.push(a),Object(h.m)("/topic/addcontent",v({},i),function(t){1===t.code?(delete r.editable,r.id=t.obj,s.a.success("操作成功！"),e.setState({data:n}),e.cacheData=n.map(function(t){return v({},t)})):s.a.error(t.msg)})}else a.status=1,delete a.key,Object(h.i)("POST","/topic/updatecontent",v({},a),function(t){1===t.code?(delete r.editable,e.setState({data:n}),e.cacheData=n.map(function(t){return v({},t)}),s.a.success("操作成功！")):s.a.error(t.msg)})}else r&&(delete r.editable,this.setState({data:n}),this.cacheData=n.map(function(t){return v({},t)}),this.setContentList(n))}},{key:"cancel",value:function(t){var e=g(this.state.data),n=e.filter(function(e){return t===e.key})[0];n&&(Object.assign(n,this.cacheData.filter(function(e){return t===e.key})[0]),delete n.editable,this.setState({data:e}))}},{key:"render",value:function(){return y.a.createElement("div",{className:"editable-table"},y.a.createElement(i.a,{className:"editable-add-btn",type:"primary",onClick:this.handleAdd},"新增"),this.props.backButton?y.a.createElement(i.a,{type:"primary",className:"cancel",style:{marginLeft:15},onClick:function(){b.hashHistory.goBack()}},"返回"):"",y.a.createElement(a.a,{pagination:!1,bordered:!0,dataSource:this.state.data,columns:this.columns}))}}])&&O(n.prototype,r),o&&O(n,o),e}()},1676:function(t,e,n){var r=n(1677);"string"==typeof r&&(r=[[t.i,r,""]]);var a={transform:void 0};n(186)(r,a);r.locals&&(t.exports=r.locals)},1677:function(t,e,n){(t.exports=n(185)(!1)).push([t.i,"",""])}}]);