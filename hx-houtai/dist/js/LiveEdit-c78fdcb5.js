(window.webpackJsonp=window.webpackJsonp||[]).push([[108,43],{1459:function(e,t,a){"use strict";a.r(t);a(675);var r=a(676),n=a.n(r),i=(a(247),a(183)),o=a.n(i),l=(a(1376),a(1377)),s=a.n(l),c=(a(1388),a(1389)),u=a.n(c),m=(a(678),a(363)),p=a.n(m),d=(a(1392),a(1393)),f=a.n(d),g=(a(1387),a(50)),v=a.n(g),b=(a(361),a(20)),h=a.n(b),y=(a(184),a(1378)),I=a.n(y),E=(a(677),a(362)),S=a.n(E),w=(a(1379),a(1380)),O=a.n(w),j=a(0),C=a.n(j),L=a(246),P=a(10),T=a(11),U=a.n(T),N=a(1628),k=a(48);a(1648);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}function V(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Y(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var q=O.a.Item,H=S.a.Option,R=I.a.TextArea,M=function(e){function t(){var e,a,r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return r=this,n=(e=x(t)).call.apply(e,[this].concat(o)),a=!n||"object"!==D(n)&&"function"!=typeof n?F(r):n,Y(F(a),"state",{updateOrNot:!1,isLogin:!1,icoVisible:!1,cateId:"1",previewVisible:!1,previewImage:"",fileList:[],mFileList:[],coverImgUrl:"",mCoverImgUrl:"",coverPicImgUrl:"",loading:!0,coverFileList:[],status:"upcoming",radioValue:"1"}),Y(F(a),"cateIdChange",function(e){a.setState({status:e.target.value})}),Y(F(a),"handleCancel",function(){return a.setState({previewVisible:!1})}),Y(F(a),"handlePreview",function(e){a.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})}),Y(F(a),"handleChange",function(e){var t=e.file,r=e.fileList;a.setState({fileList:r}),"removed"===t.status&&a.setState({coverImgUrl:""}),t.response&&(1===t.response.code&&"done"===t.status&&a.setState({coverImgUrl:t.response.obj}),"error"===t.status&&(h.a.error("网络错误，上传失败！"),a.setState({coverImgUrl:"",fileList:[]})))}),Y(F(a),"handleCoverChange",function(e){var t=e.file,r=e.fileList;a.setState({coverFileList:r}),"removed"===t.status&&a.setState({coverPicImgUrl:""}),t.response&&(1===t.response.code&&"done"===t.status&&a.setState({coverPicImgUrl:t.response.obj}),"error"===t.status&&(h.a.error("网络错误，上传失败！"),a.setState({coverPicImgUrl:"",coverFileList:[]})))}),Y(F(a),"mHandleChange",function(e){var t=e.file,r=e.fileList;a.setState({mFileList:r}),"removed"===t.status&&a.setState({mCoverImgUrl:""}),t.response&&(1===t.response.code&&"done"===t.status&&a.setState({mCoverImgUrl:t.response.obj}),"error"===t.status&&(h.a.error("网络错误，上传失败！"),a.setState({mCoverImgUrl:"",mFileList:[]})))}),Y(F(a),"handleSubmit",function(e){e.preventDefault(),a.props.form.setFieldsValue({backImage:a.state.coverImgUrl,coverPic:a.state.coverPicImgUrl,mBackImage:a.state.mCoverImgUrl}),a.props.form.validateFieldsAndScroll(function(e,t){e||(a.setState({loading:!0}),t.id=a.props.location.query.id,t.beginTime="1"===a.state.radioValue?Date.parse(t.beginTime.format("YYYY-MM-DD HH:mm")):null,t.guestId=t.guestId.join(","),t.presenterId=t.presenterId.join(","),!a.state.updateOrNot&&delete t.id,Object(k.i)("post","".concat(a.state.updateOrNot?"/caster/room/update":"/caster/room/add"),t,function(e){1===e.code?(h.a.success(a.state.updateOrNot?"修改成功！":"添加成功！"),P.hashHistory.push("/live-list")):h.a.error(e.msg)}))})}),Y(F(a),"onChangeRadio",function(e){a.setState({radioValue:e.target.value})}),Y(F(a),"createMarkup",function(e){return{__html:e}}),a}var a,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(t,j["Component"]),a=t,(r=[{key:"componentWillMount",value:function(){var e=this,t=this.props,a=t.dispatch,r=t.location;a(Object(N.a)({type:1})),a(Object(N.a)({type:2})),r.query.id?a(Object(N.b)({castId:r.query.id},function(t){e.setState({updateOrNot:!0,fileList:t.backImage?[{uid:0,name:"xxx.png",status:"done",url:t.backImage}]:[],mFileList:t.mBackImage?[{uid:0,name:"xxx.png",status:"done",url:t.mBackImage}]:[],coverFileList:[{uid:0,name:"xxx.png",status:"done",url:t.coverPic}],coverImgUrl:t.backImage,mCoverImgUrl:t.mBackImage,coverPicImgUrl:t.coverPic,loading:!1,radioValue:t.beginTime?"1":"2"})})):this.setState({loading:!1})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=this.props,a=t.liveInfo,r=t.guestList,i=t.zcrList,l=this.state,c=l.previewVisible,m=l.previewImage,d=l.fileList,g=l.updateOrNot,b=l.mFileList,h={labelCol:{span:1},wrapperCol:{span:15,offset:1}},y=C.a.createElement("div",null,C.a.createElement(v.a,{type:"plus"}),C.a.createElement("div",{className:"ant-upload-text"},"上传图片"));return C.a.createElement("div",{className:"live-send"},C.a.createElement(n.a,{spinning:this.state.loading,size:"large"},C.a.createElement(O.a,{onSubmit:this.handleSubmit},C.a.createElement(q,_({className:"liveTitle"},h,{label:"直播标题 "}),e("title",{initialValue:g&&a?"".concat(a.title):"",rules:[{required:!0,message:"请输入直播标题！"}]})(C.a.createElement(I.a,{className:"live-name",placeholder:"请输入直播标题"}))),C.a.createElement(q,_({className:"liveTime"},h,{label:"直播时间: "}),e("beginTime",{rules:[{required:!1,message:"请选择直播开始时间！"}],initialValue:g&&a?a.beginTime?"2"===this.state.radioValue?null:U()(Object(k.w)(a.beginTime),"YYYY-MM-DD HH:mm:ss"):null:"1"===this.state.radioValue?U()():null})(C.a.createElement(f.a,{showTime:!0,format:"YYYY-MM-DD HH:mm:ss",style:{marginRight:15}})),C.a.createElement(p.a.Group,{onChange:this.onChangeRadio,value:this.state.radioValue},C.a.createElement(p.a,{value:"1"},"固定时间"),C.a.createElement(p.a,{value:"2"},"非固定时间"))),C.a.createElement(q,_({className:"inviteName"},h,{label:"直播嘉宾: "}),e("guestId",g&&a?{initialValue:a.guestId.split(","),rules:[{required:!0,message:"请选择直播嘉宾！"}]}:{rules:[{required:!0,message:"请选择直播嘉宾！"}]})(C.a.createElement(S.a,{placeholder:"请选择直播嘉宾！",mode:"multiple"},r.map(function(e,t){return C.a.createElement(H,{key:t,value:e.userId},e.userName)})))),C.a.createElement(q,_({className:"inviteName"},h,{label:"直播主持人: "}),e("presenterId",g&&a?{initialValue:a.presenterId.split(","),rules:[{required:!0,message:"请选择直播主持人！"}]}:{rules:[{required:!0,message:"请选择直播主持人！"}]})(C.a.createElement(S.a,{placeholder:"请选择主持人！",showSearch:!0,mode:"multiple"},i.map(function(e,t){return C.a.createElement(H,{key:t,value:e.userId},e.userName)})))),C.a.createElement(q,_({className:"inviteInfo"},h,{label:"直播简介: "}),e("casterDesc",{initialValue:g&&a?"".concat(Object(k.t)(a.casterDesc)):"",rules:[{required:!0,message:"请输入直播简介！",max:300},{message:"简介最多300字！",max:300}]})(C.a.createElement(R,{rows:4,className:"live-supply",placeholder:"请输入直播简介"}))),C.a.createElement(q,_({},h,{label:"m端直播背景图: ",className:"upload-div"}),C.a.createElement("div",{className:"dropbox"},e("backImage",{initialValue:g&&a?d:"",rules:[{required:!1,message:"请上传直播背景图！"}]})(C.a.createElement(u.a,{headers:{"Sign-Param":Object(k.A)()},action:"".concat(k.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:d,onPreview:this.handlePreview,onChange:this.handleChange},d.length>=1?null:y)),C.a.createElement(s.a,{visible:c,footer:null,onCancel:this.handleCancel},C.a.createElement("img",{alt:"example",style:{width:"100%"},src:m})),C.a.createElement("span",{className:"cover-img-tip"},"用于m端直播页面的背景图展示, 长宽比例: ",C.a.createElement("font",{style:{color:"red"}},"720 * 192")))),C.a.createElement(q,_({},h,{label:"pc端直播背景图: ",className:"upload-div"}),C.a.createElement("div",{className:"dropbox"},e("mBackImage",{initialValue:g&&a?b:"",rules:[{required:!1,message:"请上传直播背景图！"}]})(C.a.createElement(u.a,{headers:{"Sign-Param":Object(k.A)()},action:"".concat(k.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:b,onPreview:this.handlePreview,onChange:this.mHandleChange},b.length>=1?null:y)),C.a.createElement(s.a,{visible:c,footer:null,onCancel:this.handleCancel},C.a.createElement("img",{alt:"example",style:{width:"100%"},src:m})),C.a.createElement("span",{className:"cover-img-tip"},"用于pc端直播页面的背景图展示, 长宽比例: ",C.a.createElement("font",{style:{color:"red"}},"820 * 136")))),C.a.createElement(q,{wrapperCol:{span:12,offset:1}},C.a.createElement(o.a,{type:"primary","data-status":"1",htmlType:"submit",style:{marginRight:"10px"}},"保存"),C.a.createElement(o.a,{type:"primary",className:"cancel",onClick:function(){P.hashHistory.goBack()}},"取消")))))}}])&&V(a.prototype,r),i&&V(a,i),t}();t.default=Object(L.connect)(function(e){return{userInfo:e.liveInfo.userInfo,liveInfo:e.liveInfo.info,selectData:e.liveInfo.selectedData,zcrList:e.liveInfo.zcrList,guestList:e.liveInfo.guestList}})(O.a.create()(M))},1628:function(e,t,a){"use strict";a.d(t,"c",function(){return c}),a.d(t,"a",function(){return u}),a.d(t,"b",function(){return m}),a.d(t,"f",function(){return d}),a.d(t,"d",function(){return f}),a.d(t,"e",function(){return g});a(361);var r=a(20),n=a.n(r),i=a(48),o=a(2);function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),r.forEach(function(t){s(e,t,a[t])})}return e}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c=function(e,t,a){return function(r){var o="init"===e?"/caster/room/list":"/post/search";Object(i.i)("get",o,t?l({},t):{},function(e){if(1===e.code){var t=e.obj;r(p({list:t.inforList})),r(g({totalCount:t.recordCount,pageSize:t.pageSize,currentPage:t.currentPage})),a&&a(t)}else n.a.error(e.msg)})}},u=function(e,t){return function(a){Object(i.i)("get","/caster/usertype/list",e,function(r){if(1===r.code){var i=r.obj;1===parseInt(e.type)?a({type:o.U.GET_GUEST_LIST,actionData:i}):a({type:o.U.GET_ZCR_LIST,actionData:i}),t&&t(i)}else n.a.error(r.msg)})}},m=function(e,t){return function(a){Object(i.i)("post","/caster/room/one",l({},e),function(e){if(1===e.code){var r=e.obj;a(p({info:r})),t&&t(r)}else n.a.error(e.msg)})}},p=function(e){return{type:o.U.ADD_DATA,data:e}},d=function(e){return{type:o.U.SET_SEARCH_QUERY,data:e}},f=function(e){return{type:o.U.SET_FILTER_DATA,data:e}},g=function(e){return{type:o.U.SET_PAGE_DATA,data:e}}}}]);