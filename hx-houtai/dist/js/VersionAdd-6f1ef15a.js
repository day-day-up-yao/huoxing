(window.webpackJsonp=window.webpackJsonp||[]).push([[187],{1497:function(e,t,n){"use strict";n.r(t);n(247);var r=n(183),a=n.n(r),o=(n(361),n(20)),i=n.n(o),s=(n(184),n(1378)),c=n.n(s),l=(n(678),n(363)),u=n.n(l),p=(n(1379),n(1380)),f=n.n(p),b=n(0),d=n.n(b),h=n(246),y=n(10),m=n(1683),v=n(48);n(1664);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){C(e,t,n[t])})}return e}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=f.a.Item,P=u.a.Group,T=c.a.TextArea,D=[{label:"强制",value:"1"},{label:"不强制",value:"0"}],k=[{label:"Android",value:"1"},{label:"iOS",value:"3"}],A=[{label:"Web",value:"web"},{label:"在线更新",value:"mars_xs0000"},{label:"iOS",value:"mars_ios0000"}],U=function(e){function t(e){var n,r,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,a=E(t).call(this,e),n=!a||"object"!==g(a)&&"function"!=typeof a?S(r):a,C(S(n),"handleCancel",function(){n.props.form.resetFields()}),C(S(n),"handleSubmit",function(e){var t=n.props.form,r=n.state.id;t.validateFields(function(e,n){if(e)return!1;r?Object(v.i)("post","/app/version/updatecontent",w({id:r},n),function(e){1===e.code?(i.a.success("更新成功"),t.resetFields(),"web"===n.channel?y.hashHistory.push("/version-uploadweb?id="+e.obj):"mars_xs0000"===n.channel?y.hashHistory.push("/version-upfile?id="+e.obj):y.hashHistory.push("/version-list")):i.a.sucess(e.msg)}):Object(v.i)("post","/app/version/addcontent",w({},n),function(e){i.a.success("添加成功"),t.resetFields(),"web"===n.channel?y.hashHistory.push("/version-uploadweb?id="+e.obj):"mars_xs0000"===n.channel?y.hashHistory.push("/version-upfile?id="+e.obj):y.hashHistory.push("/version-list")})})}),C(S(n),"renderData",function(e){n.setState({updateOrNot:!0,id:e.id,version:e.version,build:e.version,appType:e.appType,channel:e.channel,newFeatures:e.newFeatures,forceUpdate:e.forceUpdate,versionStatus:e.versionStatus,createTime:e.createTime,type:e.type})}),C(S(n),"platformChange",function(e){n.setState({channel:"1"===e.target.value?"mars_xs0000":"mars_ios0000"})}),C(S(n),"forceUpdateChange",function(){}),n.state={updateOrNot:!1,appType:"",channel:""},n}var n,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,b["Component"]),n=t,(r=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.dispatch,r=t.location;r.query.id&&(this.setState({loading:!0}),n(Object(m.b)({id:r.query.id},function(t){t.code,e.setState({loading:!1}),e.renderData(t)})))}},{key:"render",value:function(){var e={labelCol:{span:4},wrapperCol:{span:8,offset:1}},t=this.props.form.getFieldDecorator,n=this.props.versionInfo,r=this.state.updateOrNot;return d.a.createElement("div",null,d.a.createElement(f.a,null,d.a.createElement(F,O({},e,{label:"版本号："}),t("version",{initialValue:r&&n?"".concat(n.version):"",rules:[{required:!0,message:"字段不能为空!"},{pattern:/^\d(?:\.\d){2}$/,message:"请输入正确的版本号，三位版本，且每位不得大于10"}]})(d.a.createElement(c.a,{placeholder:"请输入版本号"}))),d.a.createElement(F,O({},e,{label:"平台："}),t("appType",{initialValue:r&&n?"".concat(n.appType||"1"):null,rules:[{required:!0,message:"请选择平台"}]})(d.a.createElement(P,{options:k,onChange:this.platformChange,setFieldsValue:this.state.appType}))),d.a.createElement(F,O({},e,{label:"更新内容："}),t("newFeatures",{initialValue:r&&n?"".concat(n.newFeatures):"",rules:[{required:!0,message:"请输入版本更新说明！"}]})(d.a.createElement(T,{style:{height:80},placeholder:"请输入版本更新说明"}))),d.a.createElement(F,O({},e,{label:"强制更新："}),t("forceUpdate",{initialValue:r&&n?"".concat(n.forceUpdate):0,rules:[{required:!0,message:"请选择！"}]})(d.a.createElement(P,{options:D,onChange:this.forceUpdateChange,setFieldsValue:this.state.forceUpdate}))),d.a.createElement(F,O({},e,{label:"版本channel："}),t("channel",{rules:[{required:!0,message:"请输入版本渠道"}],initialValue:r&&n?this.state.channel:null})(d.a.createElement(P,{options:A,onChange:this.channelChange,setFieldsValue:this.state.channel}))),d.a.createElement(F,{wrapperCol:{span:12,offset:6}},d.a.createElement(a.a,{type:"primary",onClick:this.handleSubmit},"确定"),d.a.createElement(a.a,{type:"primary",onClick:this.handleCancel,className:"cancelUpdate"},"取消"))))}}])&&j(n.prototype,r),o&&j(n,o),t}();t.default=Object(h.connect)(function(e){return{versionInfo:e.versionInfo.info}})(f.a.create()(U))},1683:function(e,t,n){"use strict";n.d(t,"c",function(){return l}),n.d(t,"b",function(){return u}),n.d(t,"a",function(){return p}),n.d(t,"e",function(){return b}),n.d(t,"d",function(){return d});n(361);var r=n(20),a=n.n(r),o=n(48),i=n(2);function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){c(e,t,n[t])})}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e,t,n){return function(r){var i="init"===e?"/app/version/listcontent":"/post/search";Object(o.i)("get",i,t?s({},t):{},function(e){if(1===e.code){var t=e.obj;r(f({list:t})),n&&n(t)}else a.a.error(e.msg)})}},u=function(e,t){return function(n){Object(o.i)("post","/app/version/detailcontent",s({},e),function(e){if(1===e.code){var r=e.obj;n(f({info:r})),t&&t(r)}else a.a.error(e.msg)})}},p=function(e,t){return function(n){Object(o.i)("post","/app/version/addcontent ",s({},e),function(e){1===e.code?(a.a.success("添加成功！"),t&&t()):a.a.error(e.msg)})}},f=function(e){return{type:i.Fb.ADD_DATA,data:e}},b=function(e){return{type:i.Fb.SET_SEARCH_QUERY,data:e}},d=function(e){return{type:i.Fb.SET_PAGE_DATA,data:e}}}}]);