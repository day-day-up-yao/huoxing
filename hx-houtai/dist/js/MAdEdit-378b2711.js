(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{1447:function(e,t,a){"use strict";a.r(t);a(675);var n=a(676),l=a.n(n),r=(a(247),a(183)),i=a.n(r),s=(a(1376),a(1377)),o=a.n(s),c=(a(1388),a(1389)),p=a.n(c),u=(a(1392),a(1393)),d=a.n(u),m=(a(184),a(1378)),f=a.n(m),h=(a(1381),a(1382)),y=a.n(h),b=(a(1383),a(1384)),g=a.n(b),v=(a(1387),a(50)),S=a.n(v),E=(a(361),a(20)),T=a.n(E),w=(a(678),a(363)),O=a.n(w),I=(a(677),a(362)),C=a.n(I),V=(a(1379),a(1380)),k=a.n(V),P=a(0),x=a.n(P),j=a(246),D=a(10),L=a(1612),N=a(248),q=a(48),A=(a(1626),a(1608)),Y=a(11),_=a.n(Y);function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function U(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var G=k.a.Item,J=C.a.Option,W=O.a.Group,K=[{label:"PC",value:"1"},{label:"Web",value:"4"},{label:"App",value:"2"}],Q=function(e){function t(){var e,a,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,n=F(t).call(this),e=!n||"object"!==H(n)&&"function"!=typeof n?B(a):n,z(B(e),"label",function(e){var t={};switch(e){case"1":t={label:"链接",message:"请输入正确的链接地址",placeholder:"链接地址",type:"url"};break;case"3":t={label:"新闻 ID",message:"请输入新闻 ID",placeholder:"新闻 ID",type:""};break;case"4":t={label:"频道",message:"请选择新闻频道",placeholder:"新闻 ID",type:""};break;case"5":t={label:"专题名",message:"请输入专题名",placeholder:"示例：MarsBit特训营/20180725170844035121",type:""};break;case"6":t={label:"关键字",message:"请输入搜索的关键字/标签",placeholder:"关键字/标签",type:""};break;default:t={label:"链接",message:"请输入正确的链接地址",placeholder:"链接地址",type:"url"}}return t}),z(B(e),"positionChange",function(t){e.setState({adPlace:t.target.value})}),z(B(e),"typeChange",function(t){e.setState({type:t.target.value})}),z(B(e),"changeOffLineType",function(){"0"===e.state.offlineType&&e.setState({offlineType:"1"})}),z(B(e),"handleCancel",function(){return e.setState({previewVisible:!1})}),z(B(e),"handlePreview",function(t){e.setState({previewImage:t.url||t.thumbUrl,previewVisible:!0})}),z(B(e),"handleChange",function(t){var a=t.file,n=t.fileList;e.setState({fileList:n}),"removed"===a.status&&e.setState({coverImgUrl:""}),a.response&&(1===a.response.code&&"done"===a.status&&e.setState({coverImgUrl:a.response.obj}),"error"===a.status&&(T.a.error("网络错误，上传失败！"),e.setState({coverImgUrl:"",fileList:[]})))}),z(B(e),"offlineType",function(t){e.setState({offlineType:t.target.value})}),z(B(e),"adType",function(t){e.setState({adType:t.target.value,text:e.label(t.target.value)})}),z(B(e),"adVisibleHide",function(){e.setState({adVisible:!1})}),z(B(e),"adVisibleShow",function(){e.setState({adVisible:!0})}),z(B(e),"handleSubmit",function(t){var a=t.target.getAttribute("data-status");t.preventDefault(),e.props.form.setFieldsValue({mImgSrc:e.state.coverImgUrl}),e.props.form.validateFieldsAndScroll(function(t,n){if(!t){if(e.setState({loading:!0}),"0"===e.state.radioValue)n.expiredTime=0;else{var l=n.expiredTime?Date.parse(n.expiredTime.format("YYYY-MM-DD HH:mm:ss")):0;n.expiredTime=l/1e3}n.id=e.props.location.query.id||"",n.status=a||1,n.url="4"===n.useType?n.channelId:n.url||e.state.specialActive,!e.state.updateOrNot&&delete n.id,15===parseInt(e.state.adPlace)&&(n.topOrder=999),Object(q.i)("post","".concat(e.state.updateOrNot?"/ad/update":"/ad/add"),n,function(t){1===t.code?(T.a.success(e.state.updateOrNot?"修改成功！":"添加成功！"),D.hashHistory.goBack()):T.a.error(t.msg)})}})}),z(B(e),"specialIdChange",function(t){var a=B(e);e.setState({specialActive:t.target.value}),Object(q.i)("post","/topic/getTagsByTopicId",{id:t.target.value},function(e){if(1===e.code){var t=e.obj;a.setState({specialValShow:!0}),a.setState({specialVal:t||[]})}else a.setState({specialValShow:!1})})}),z(B(e),"specialValClick",function(t){var a=t.target.getAttribute("data-val");e.setState({specialActive:"".concat(a,"/").concat(e.state.specialActive)}),e.setState({specialValShow:!1})}),z(B(e),"channelIdChange",function(t){e.setState({url:t})}),e.state={updateOrNot:!1,adPlace:"",adVisible:!1,type:"1",previewVisible:!1,previewImage:"",adTitle:"",channelId:"1",adContent:"",fileList:[],coverImgUrl:"",loading:!0,adType:"1",offlineType:"0",specialVal:[],specialActive:"",specialValShow:!0,text:{label:"链接",message:"请输入正确的链接地址",placeholder:"链接地址",type:"url"}},e}var a,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,P["Component"]),a=t,(n=[{key:"componentDidUpdate",value:function(e,t){e.adInfo.url!==this.props.adInfo.url&&this.setState({specialActive:this.props.adInfo.url})}},{key:"componentWillMount",value:function(){var e=this,t=this.props,a=t.dispatch,n=t.location,l=this;a(Object(N.f)()),a(Object(A.a)("post",{pageSize:20,status:1,currentPage:1},function(){l.setState({loading:!1})})),n.query.id?a(Object(L.a)({id:n.query.id},function(t){e.setState({updateOrNot:!0,fileList:[{uid:0,name:"xxx.png",status:"done",url:t.mImgSrc}],coverImgUrl:t.mImgSrc,loading:!1,adPlace:t.adPlace,adType:"".concat(t.useType),text:e.label("".concat(t.useType)),offlineType:t.expiredTime?"1":"0"})})):this.setState({loading:!1})}},{key:"sendPost",value:function(e){var t={adTitle:e.postTitle||"",adContent:"".concat(e.postContent)||""};this.setState(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){z(e,t,a[t])})}return e}({},this.state,t))}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.props,n=a.adInfo,r=a.classifyList,s=this.state,c=s.previewVisible,u=s.previewImage,m=s.fileList,h=s.updateOrNot,b=s.text,v={labelCol:{span:3},wrapperCol:{span:20}},E=[];r.map(function(e){1===e.status&&E.push({label:e.strategyCatName,value:e.strategyCat})});var T=x.a.createElement("div",null,x.a.createElement(S.a,{type:"plus"}),x.a.createElement("div",{className:"ant-upload-text"},"上传图片")),w="";switch(parseInt(this.state.adPlace)){case 4:w="1080*2440，上方520px高度留空";break;case 6:w="560*720，按照实际尺寸，不要做2x，3x的图片";break;case 13:w="690px * 150px";break;case 14:w="228px * 160px";break;case 15:w="690px * 200px"}return x.a.createElement("div",{className:"ad-send"},x.a.createElement(l.a,{spinning:this.state.loading,size:"large"},x.a.createElement(k.a,{onSubmit:this.handleSubmit},x.a.createElement(G,M({},v,{label:"平台: "}),t("type",{initialValue:"2"})(x.a.createElement(W,{disabled:!0,options:K,onChange:this.typeChange,setFieldsValue:this.state.type}))),x.a.createElement(G,M({},v,{label:"位置: "}),t("adPlace",{initialValue:this.state.adPlace.toString(),rules:[{required:!0,message:"请选择广告位置"}]})(x.a.createElement(W,{options:q.f,onChange:this.positionChange,setFieldsValue:this.state.adPlace}))),15===parseInt(this.state.adPlace)?x.a.createElement(G,M({},v,{label:"策略分类"}),t("secondPosition",{initialValue:h&&n&&n.secondPosition?n.secondPosition.toString():"",rules:[{required:!0,message:"请选择策略频道"}]})(x.a.createElement(W,null,x.a.createElement(y.a,null,E.map(function(e,t){return x.a.createElement(g.a,{span:3,key:t},x.a.createElement(O.a,{value:"".concat(e.value)},e.label))}))))):"",x.a.createElement(G,M({},v,{label:"类型: "}),t("useType",{initialValue:this.state.adType,rules:[{required:!0,message:"请选择广告类型"}]})(x.a.createElement(W,{onChange:this.adType,setFieldsValue:this.state.adType},q.d.map(function(e,t){return x.a.createElement(O.a,{key:t,value:e.value},e.label)})))),"4"===this.state.adType?x.a.createElement(G,M({},v,{label:b.label}),t("channelId",{initialValue:h&&n?"".concat(n.url):"1",rules:[{required:!0,type:"".concat(b.type),message:"".concat(b.message)}]})(x.a.createElement(C.a,{style:{width:100},onChange:this.channelIdChange},this.props.channelList.map(function(e){return x.a.createElement(J,{value:e.value,key:e.value},e.label)})))):"5"===this.state.adType?x.a.createElement(G,M({},v,{label:b.label}),x.a.createElement("div",{className:"special-cont"},x.a.createElement(f.a,{placeholder:b.placeholder,value:this.state.specialActive,onChange:this.specialIdChange.bind(event)}),x.a.createElement("div",{className:"special-select",style:{display:this.state.specialValShow?"block":"none"}},this.state.specialVal.map(function(t,a){return x.a.createElement("p",{key:a,"data-val":t,onClick:e.specialValClick.bind(event)},t)})))):x.a.createElement(G,M({},v,{label:b.label}),t("url",{initialValue:h&&n?"".concat(n.url):"",rules:[{required:4!==parseInt(this.state.adPlace),type:"".concat(b.type),message:"".concat(b.message)}]})(x.a.createElement(f.a,{placeholder:b.placeholder}))),x.a.createElement(G,M({},v,{label:"标题: "}),t("remake",{initialValue:h&&n?"".concat(n.remake):"",rules:[{required:!0,message:"请输入链接标题！"}]})(x.a.createElement(f.a,{placeholder:"输入链接标题"}))),15!==parseInt(this.state.adPlace)&&x.a.createElement(G,M({},v,{label:"权重: "}),t("topOrder",{initialValue:h&&n?n.topOrder:"0",rules:[{required:!0,message:"请输入广告权重！"}]})(x.a.createElement(f.a,{placeholder:"请输入广告权重！"}))),15===parseInt(this.state.adPlace)&&x.a.createElement(G,M({},v,{label:"权重: "}),t("weight",{initialValue:h&&n?n.weight:"0",rules:[{required:!0,message:"请输入广告权重！"}]})(x.a.createElement(f.a,{placeholder:"请输入广告权重！"}))),x.a.createElement(G,M({},v,{label:"描述: "}),t("description",{initialValue:h&&n?"".concat(n.description||""):"",rules:[{required:!1,message:"请输入广告描述！"}]})(x.a.createElement(f.a,{placeholder:"请输入广告描述"}))),x.a.createElement(G,M({className:"offlineTime"},v,{label:"定时下线："}),x.a.createElement(O.a.Group,{onChange:this.offlineType,value:this.state.offlineType},x.a.createElement(O.a,{value:"0"},"永久"),x.a.createElement(O.a,{value:"1"},"定时")),t("expiredTime",{rules:[{required:!1,message:"请选择下线时间！"}],initialValue:h&&n?n.expiredTime?"2"===this.state.offlineType?null:_()(Object(q.w)(n.expiredTime),"YYYY-MM-DD HH:mm:ss"):null:"1"===this.state.offlineType?_()():null})(x.a.createElement(d.a,{showTime:!0,format:"YYYY-MM-DD HH:mm:ss",onOk:this.changeOffLineType,style:{marginRight:15}}))),x.a.createElement(G,M({},v,{label:"封面: "}),x.a.createElement("div",{className:"dropbox"},t("mImgSrc",{initialValue:h&&n?m:"",rules:[{required:!0,message:"请上传广告封面！"}]})(x.a.createElement(p.a,{action:"".concat(q.a,"/pic/upload"),headers:{"Sign-Param":Object(q.A)()},name:"uploadFile",listType:"picture-card",fileList:m,onPreview:this.handlePreview,onChange:this.handleChange},m.length>=1?null:T)),x.a.createElement(o.a,{visible:c,footer:null,onCancel:this.handleCancel},x.a.createElement("img",{alt:"example",style:{width:"100%"},src:u})),x.a.createElement("span",{className:"cover-img-tip"},x.a.createElement("font",{style:{color:"red"}},w)))),x.a.createElement(G,{wrapperCol:{span:12,offset:2}},x.a.createElement(i.a,{type:"primary","data-status":"1",htmlType:"submit",style:{marginRight:"10px"}},"发布"),x.a.createElement(i.a,{type:"primary","data-status":"2",onClick:this.handleSubmit,style:{marginRight:"10px"}},"放入草稿箱"),x.a.createElement(i.a,{type:"primary",className:"cancel",onClick:function(){D.hashHistory.goBack()}},"取消")))))}}])&&U(a.prototype,n),r&&U(a,r),t}();t.default=Object(j.connect)(function(e){return{adInfo:e.adInfo.info,channelList:e.channelListInfo,classifyList:e.postTacticsInfo.list}})(k.a.create()(Q))},1608:function(e,t,a){"use strict";a.d(t,"a",function(){return s});a(361);var n=a(20),l=a.n(n),r=a(48),i=a(2),s=function(e,t,a){return function(n){Object(r.i)(e,"/news/strategyCategory/showStrategyCategorylist",t,function(e){if(1===e.code){var t=e.obj;n({type:i.nb.LIST_POST_TACTICS,data:t}),a&&a(t)}else l.a.error(e.msg)})}}},1626:function(e,t,a){var n=a(1647);"string"==typeof n&&(n=[[e.i,n,""]]);var l={transform:void 0};a(186)(n,l);n.locals&&(e.exports=n.locals)},1647:function(e,t,a){(e.exports=a(185)(!1)).push([e.i,"",""])}}]);