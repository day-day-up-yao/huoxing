(window.webpackJsonp=window.webpackJsonp||[]).push([[61],{1469:function(e,t,n){"use strict";n.r(t);n(675);var a=n(676),r=n.n(a),i=(n(1385),n(1386)),c=n.n(i),o=(n(1381),n(1382)),s=n.n(o),l=(n(1383),n(1384)),p=n.n(l),u=(n(247),n(183)),m=n.n(u),f=(n(1390),n(1391)),d=n.n(f),h=(n(361),n(20)),y=n.n(h),b=(n(677),n(362)),g=n.n(b),v=(n(1376),n(1377)),k=n.n(v),E=n(0),O=n.n(E),S=n(246),T=(n(1678),n(10)),w=n(1679),j=n(48),P=n(248);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){V(e,t,n[t])})}return e}function C(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=k.a.confirm,D=g.a.Option,z=[],M=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=L(t).call(this,e),n=!r||"object"!==I(r)&&"function"!=typeof r?_(a):r,V(_(n),"handleChange",function(e){(0,n.props.dispatch)(Object(w.d)({status:e})),n.setState({status:e}),n.doSearch("init",{currentPage:1,status:e})}),V(_(n),"handleTypeChange",function(e){(0,n.props.dispatch)(Object(w.d)({type:e})),n.setState({type:e}),n.doSearch("init",{currentPage:1,type:e})}),V(_(n),"getOrderNum",function(e){n.setState({order:e})}),V(_(n),"handleCancel",function(){return n.setState({previewVisible:!1})}),V(_(n),"handlePreview",function(e){n.setState({previewImage:e.target.getAttribute("src"),previewVisible:!0})}),n.state={loading:!0,previewVisible:!1,previewImage:"",status:null,type:"0",order:1,recommendVisible:!1},n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,E["Component"]),n=t,(a=[{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.filter;(0,t.dispatch)(Object(P.f)()),this.doSearch("init",{status:n.status}),z=[{title:"标题",key:"topicName",render:function(t,n){return n&&O.a.createElement("div",{className:"appTopic-info clearfix"},O.a.createElement("div",null,O.a.createElement("h4",{title:n.topicName,dangerouslySetInnerHTML:e.createMarkup(Object(j.q)(n.topicName,50))}),2!==parseInt(n.status)?"":O.a.createElement("div",{style:{display:"inline-block"}},O.a.createElement("span",{className:"appTopic-status has-publish mr10"},"首页展示中"))))}},{title:"手机端封面 ",dataIndex:"mImgSrc",key:"mImgSrc",render:function(t){return O.a.createElement("div",{className:"shrinkPic",key:t,style:{background:"url(".concat(t||"http://static.huoxing24.com/images/2018/03/31/1522470188490129.png",") no-repeat center / cover")},src:t||"http://static.huoxing24.com/images/2018/03/31/1522470188490129.png",onClick:e.handlePreview})}},{title:"状态",key:"status",render:function(e,t){return 0===t.status?O.a.createElement("span",{className:"banner-status pre-publish"},"已撤回"):1===t.status?O.a.createElement("span",{className:"banner-status has-publish"},"展示中"):O.a.createElement("span",null,"暂无")}},{title:"类型",key:"type",render:function(e){return e&&1===e.type?O.a.createElement("span",{className:"appTopic-status link"},"链接跳转"):e&&2===e.type?O.a.createElement("span",{className:"appTopic-status will-publish"},"待定"):e&&3===e.type?O.a.createElement("span",{className:"appTopic-status news"},"新闻"):e&&5===e.type?O.a.createElement("span",{className:"appTopic-status authorInfo"},"作者信息"):O.a.createElement("span",{className:"appTopic-status no"},"暂无")}},{title:"相关信息",key:"typeLink",width:500,render:function(t){return 1===t.type?O.a.createElement("a",{target:"_blank",href:t.typeLink&&""!==t.typeLink.trim()?t.typeLink:"#/appTopic-list"},t.typeLink&&""!==t.typeLink.trim()?t.typeLink:"暂无链接"):2===t.type?O.a.createElement("p",null,"待定"):3===t.type?parseInt(t.typeLink).toString()===t.typeLink?O.a.createElement("p",null,"频道：",e.channelName(t.typeLink)):O.a.createElement("p",null,"新闻关键字：",t.typeLink||"暂无"):5===t.type?O.a.createElement("p",null,"作者昵称/ID：",t.typeLink):void 0}},{title:"推荐位权重",width:100,key:"setTop",render:function(e){return e.setTop&&0!==parseInt(e.setTop)&&1!==parseInt(e.status)?e.setTop:"无权限"}},{title:"操作",key:"action",render:function(t){var n="";switch(t.status){case 1:n=O.a.createElement("p",null,O.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.recommendTopic(t)},style:{background:"#00b45a"}},"展示"));break;case 2:n=O.a.createElement("div",null,O.a.createElement("p",{style:{marginTop:10}},O.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.recommendTopic(t)},style:{background:"#00b45a"}},"修改展示权重")),O.a.createElement("p",{style:{marginTop:10}},O.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.backRecommend(t)},style:{background:"#e9892f"}},"撤回(取消展示)")));break;default:n=""}return O.a.createElement("div",null,O.a.createElement("p",{style:{marginBottom:10}},O.a.createElement(T.Link,{className:"mr10 opt-btn",to:{pathname:"/appTopic-add",query:{id:t.id}},style:{background:"#49a9ee"}},"修改轮播内容")),n,O.a.createElement("p",{style:{marginTop:10}},O.a.createElement("a",{onClick:function(){return e.delAppTopic(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#d73435"}},"删除")))}}]}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e(Object(w.f)({type:"init",nickName:""})),e(Object(w.e)({pageSize:20,totalCount:0}))}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"channelName",value:function(e){var t="";return this.props.channelList.map(function(n,a){parseInt(n.value)===parseInt(e)&&(t=n.label)}),t}},{key:"doSearch",value:function(e,t){var n=this,a=this.props,r=a.dispatch,i=a.pageData,c=a.filter,o={type:c.type,status:c.status,pageSize:20,currentPage:i.currentPage};o=N({},o,t),r(Object(w.b)(e,o,function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.props.dispatch;this.doSearch("init",{currentPage:1}),e(Object(w.e)({currentPage:1}))}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.props,n=t.dispatch,a=t.search,r=t.filter;n(Object(w.e)({currentPage:e})),this.doSearch(a.type,N({currentPage:e},r))}},{key:"delAppTopic",value:function(e){var t=this;A({title:"提示",content:"确认要删除吗 ?",onOk:function(){var n={id:e.id,status:0};Object(j.i)("POST","/topic/status",N({},n),function(e){1===e.code?(y.a.success("删除成功"),t.doSearch("init")):y.a.error(e.msg)})}})}},{key:"recommendTopic",value:function(e){var t=this,n=this;e.setTop&&0!==parseInt(e.setTop)&&1!==parseInt(e.status)?this.setState({order:e.setTop}):this.setState({order:1}),(0,this.props.dispatch)(Object(w.c)(1,function(a){A({title:"提示",content:O.a.createElement("div",{className:"modal-input"},O.a.createElement("span",{style:{marginRight:10}},"请输入首页推荐位置的权重：(权重越高越靠前)"),O.a.createElement("p",null,"已被占用的权重：",O.a.createElement("span",null,a.join(", "))),O.a.createElement(d.a,{min:1,defaultValue:t.state.order,autoFocus:!0,type:"number",onChange:n.getOrderNum})),onOk:function(){var t=n.state.order;if(""===t.toString().trim())return y.a.error("推荐位的权重值不能为空！"),!1;var a={id:e.id,status:2,type:e.type,setTop:t};-1!==n.props.numArr.indexOf(t)?A({title:"提示",content:O.a.createElement("div",null,O.a.createElement("h3",null,t," 号轮播位置已经被占用！"),O.a.createElement("h3",null,"点击确定原有轮播内容将被 替换！")),onOk:function(){Object(j.i)("POST","/topic/status",N({},a),function(e){1===e.code?(y.a.success("替换成功"),n.doSearch("init")):y.a.error(e.msg)})}}):Object(j.i)("POST","/topic/status",N({},a),function(e){1===e.code?(y.a.success("操作成功"),n.doSearch("init")):y.a.error(e.msg)})}})}))}},{key:"backRecommend",value:function(e){var t=this;A({title:"提示",content:"确认要撤回推荐吗 ?",onOk:function(){var n={id:e.id,status:1};Object(j.i)("POST","/topic/status",N({},n),function(e){1===e.code?(y.a.success("操作成功"),t.doSearch("init")):y.a.error(e.msg)})}})}},{key:"_isPublish",value:function(e){var t=this;A({title:"提示",content:"确认要".concat(0===e.status?"开启直播":"结束直播","吗 ?"),onOk:function(){var n={id:e.id,status:0===e.status?1:0};Object(j.i)("POST","/news/status",N({},n),function(e){1===e.code?(y.a.success("操作成功！"),t.doSearch("init")):y.a.error(e.msg)})}})}},{key:"_forbidcomment",value:function(e){var t=this,n=this.props.dispatch,a={id:e.id,operate:parseInt(e.forbidComment)?"0":"1"};Object(j.i)("post","/post/forbidcomment",a,function(e){200===e.status?(t.doSearch("init"),n(Object(w.f)({type:"init"}))):y.a.error(e.msg)})}},{key:"_isTop",value:function(e){var t=this,n=this.props.dispatch,a={id:e.id,recommend:1===e.recommend?0:1};Object(j.i)("post","/ico/recommend",a,function(e){1===e.code?(t.doSearch("init"),n(Object(w.f)({type:"init"}))):y.a.error(e.msg)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,a=t.pageData,i=t.filter;return O.a.createElement("div",{className:"appTopic-index"},O.a.createElement(s.a,null,O.a.createElement(p.a,null,O.a.createElement("span",null,"状态筛选："),O.a.createElement(g.a,{defaultValue:"".concat(i.status),style:{width:120},onChange:this.handleChange},j.S.map(function(e){return O.a.createElement(D,{value:e.value,key:e.value},e.label)})),O.a.createElement("span",{style:{marginLeft:10}},"类型筛选："),O.a.createElement(g.a,{defaultValue:"".concat(i.type),style:{width:120},onChange:this.handleTypeChange},O.a.createElement(D,{value:"0"},"全部"),j.T.map(function(e){return O.a.createElement(D,{value:e.value,key:e.value},e.label)})),O.a.createElement(m.a,{type:"primary",style:{margin:"0 15px"},onClick:function(){return T.hashHistory.push("/appTopic-add")}},"新增"))),O.a.createElement("div",{className:"mt30"},O.a.createElement(r.a,{spinning:this.state.loading,size:"large"},O.a.createElement(c.a,{dataSource:n.map(function(e,t){return N({},e,{key:t})}),columns:z,bordered:!0,pagination:{current:a.currentPage,total:a.totalCount,pageSize:a.pageSize,onChange:function(t){return e.changePage(t)}}}),O.a.createElement(k.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancel},O.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage})))))}}])&&C(n.prototype,a),i&&C(n,i),t}();t.default=Object(S.connect)(function(e){return{appTopicInfo:e.appTopicInfo,list:e.appTopicInfo.list,search:e.appTopicInfo.search,filter:e.appTopicInfo.filter,pageData:e.appTopicInfo.pageData,numArr:e.appTopicInfo.numArr,channelList:e.channelListInfo}})(M)}}]);