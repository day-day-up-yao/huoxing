(window.webpackJsonp=window.webpackJsonp||[]).push([[196],{1433:function(e,t,a){"use strict";a.r(t),function(e){a(1376);var n=a(1377),r=a.n(n),i=(a(1381),a(1382)),o=a.n(i),s=(a(1383),a(1384)),l=a.n(s),c=(a(675),a(676)),u=a.n(c),p=(a(681),a(682)),d=a.n(p),m=(a(1392),a(1393)),f=a.n(m),g=(a(247),a(183)),v=a.n(g),h=(a(1388),a(1389)),y=a.n(h),b=(a(1387),a(50)),S=a.n(b),w=(a(361),a(20)),I=a.n(w),E=(a(1394),a(1395)),O=a.n(E),L=(a(677),a(362)),j=a.n(L),T=(a(184),a(1378)),C=a.n(T),N=(a(1379),a(1380)),V=a.n(N),U=a(0),_=a.n(U),x=a(246),P=a(1398),k=(a(1606),a(1617)),A=a(51),M=a.n(A),D=a(11),F=a.n(D),R=a(1643),J=a(48);a(1641);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function z(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){K(e,t,a[t])})}return e}function G(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function W(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function K(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var X,Z,ee=V.a.Item,te=C.a.TextArea,ae=j.a.Option,ne=O.a.CheckableTag,re="",ie=1,oe=!1,se=M.a.get("hx_passportId"),le=function(t){function a(t){var n,r,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),r=this,i=B(a).call(this,t),n=!i||"object"!==q(i)&&"function"!=typeof i?Q(r):i,K(Q(n),"insertState",function(e){e.map(function(e){n.state[e+"fileList"]=[],n.state[e+"coverImgUrl"]=""})}),K(Q(n),"fileList",function(e,t){return e[t]&&""!==e[t]?[{uid:0,name:"xxx.png",status:"done",url:e[t]}]:[]}),K(Q(n),"renderData",function(e){var t=Object(J.G)(e.coverPic)?JSON.parse(e.coverPic):{pc_recommend:"",pc:"",wap_big:"",wap_small:"",video_pc:"",video_m:""},a=n.fileList(t,"pc_recommend"),r=n.fileList(t,"video_pc"),i=n.fileList(t,"video_m"),o=n.fileList(t,"pc"),s=n.fileList(t,"video_m"),l=n.fileList(t,"wap_big");n.setState({updateOrNot:!0,videoPcfileList:r,videoMfileList:i,fileList:o,pcfileList:a,mfileList:s,mcfileList:l,videofileList:Object(J.G)(e.url)?JSON.parse(e.url):[],tags:e.tags?e.tags.split(","):[],newsContent:e.content,coverImgUrl:t.pc,allcoverImgUrl:t.all,pccoverImgUrl:t.pc_recommend||"",mcoverImgUrl:t.video_m,mccoverImgUrl:t.wap_big,videoMcoverImgUrl:t.video_m,videoPccoverImgUrl:t.video_pc,videoUrl:Object(J.G)(e.url)?JSON.parse(e.url)[0].fileUrl:"",loading:!1,original:e.original||0,subject:e.subject||1,topOrder:e.topOrder||0})}),K(Q(n),"channelIdChange",function(e){n.setState({channelId:e.target.value})}),K(Q(n),"cateIdChange",function(e){n.setState({cateId:e.target.value})}),K(Q(n),"handleClose",function(e){var t=n.state.tags.filter(function(t){return t!==e});n.setState({tags:t})}),K(Q(n),"showInput",function(){n.setState({inputVisible:!0},function(){return n.input.focus()})}),K(Q(n),"handleInputChange",function(e){n.setState({inputValue:e.target.value})}),K(Q(n),"handleInputConfirm",function(){var e=n.state,t=e.inputValue,a=e.tags;t&&-1===a.indexOf(t)&&(a=[].concat(G(a),[t.slice(0,20)])),n.setState({tags:a,inputVisible:!1,inputValue:""})}),K(Q(n),"saveInputRef",function(e){n.input=e}),K(Q(n),"handleCancel",function(){return n.setState({previewVisible:!1})}),K(Q(n),"handlePreview",function(e){if(e.hasOwnProperty("target")){var t=e.target.getAttribute("data-type");""!==n.state[t]?n.setState({previewImage:n.state[t],previewVisible:!0}):I.a.info("请先上传图片")}else n.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})}),K(Q(n),"handleChange",function(e){var t=e.file,a=e.fileList;n.setState({fileList:a}),"removed"===t.status&&n.setState({coverImgUrl:""}),t.response&&(1===t.response.code&&"done"===t.status&&n.setState({coverImgUrl:t.response.obj}),"error"===t.status&&(I.a.error("网络错误，上传失败！"),n.setState({coverImgUrl:"",fileList:[]})))}),K(Q(n),"handleVideoPcChange",function(e){var t=e.file,a=e.fileList;n.setState({videoPcfileList:a}),"removed"===t.status&&n.setState({videoPccoverImgUrl:""}),t.response&&(1===t.response.code&&"done"===t.status&&n.setState({videoPccoverImgUrl:t.response.obj}),"error"===t.status&&(I.a.error("网络错误，上传失败！"),n.setState({videoPccoverImgUrl:"",videoPcfileList:[]})))}),K(Q(n),"handleVideoMChange",function(e){var t=e.file,a=e.fileList;n.setState({videoMfileList:a}),"removed"===t.status&&n.setState({videoMcoverImgUrl:""}),t.response&&(1===t.response.code&&"done"===t.status&&n.setState({videoMcoverImgUrl:t.response.obj}),"error"===t.status&&(I.a.error("网络错误，上传失败！"),n.setState({videoMcoverImgUrl:"",videoMfileList:[]})))}),K(Q(n),"handlePcChange",function(e){var t=e.file,a=e.fileList;n.setState({pcfileList:a}),"removed"===t.status&&n.setState({pccoverImgUrl:""}),t.response&&(1===t.response.code&&"done"===t.status&&n.setState({pccoverImgUrl:t.response.obj}),"error"===t.status&&(I.a.error("网络错误，上传失败！"),n.setState({pccoverImgUrl:"",pcfileList:[]})))}),K(Q(n),"handleMobileChange",function(e){var t=e.file,a=e.fileList;n.setState({mfileList:a}),"removed"===t.status&&n.setState({mcoverImgUrl:""}),t.response&&(1===t.response.code&&"done"===t.status&&n.setState({mcoverImgUrl:t.response.obj}),"error"===t.status&&(I.a.error("网络错误，上传失败！"),n.setState({mcoverImgUrl:"",mfileList:[]})))}),K(Q(n),"handleMobileCommentChange",function(e){var t=e.file,a=e.fileList;n.setState({mcfileList:a}),"removed"===t.status&&n.setState({mccoverImgUrl:""}),t.response&&(1===t.response.code&&"done"===t.status&&n.setState({mccoverImgUrl:t.response.obj}),"error"===t.status&&(I.a.error("网络错误，上传失败！"),n.setState({mccoverImgUrl:"",mcfileList:[]})))}),K(Q(n),"handleUpload",function(){var e=n.state.videoList[0],t=e.size,a=Math.ceil(t/2097152),r=new FormData;r.append("fileName",e.name),r.append("blockCount",a),r.append("currIndex",ie),r.append("uploadId",re),r.append("uploadFile",null),r.append("type","video"),n.setState({uploading:!0}),n.UploadVideo(e,r,t,a,2097152)}),K(Q(n),"UploadVideo",function(e,t,a,r,i){if(!oe)try{var o=(ie-1)*i,s=Math.min(a,o+i),l=e.slice(o,s);t.set("uploadFile",l),t.set("currIndex",ie),t.set("uploadId",re),Object(J.l)("post","/file/upload",t,function(o){if(o.request)return clearInterval(n.timeOut),n.timeOut=setTimeout(function(){n.UploadVideo(e,t,a,r,i)},1e4),!1;if(o.response)return/^(5|4)\d{2}/.test(o.response.status)&&(clearInterval(n.timeOut),n.timeOut=setTimeout(function(){n.UploadVideo(e,t,a,r,i)},1e4)),!1;if(1===o.code){clearInterval(n.timeOut),1===ie&&(re=o.obj);var s=ie/r*100;ie+1===r&&(s=99),n.setState({progressNum:parseFloat(s.toFixed(2))}),ie<r&&(ie+=1,n.UploadVideo(e,t,a,r,i))}else if(o.code<0)re="",ie=1,I.a.error(o.msg);else if(2===o.code){clearInterval(n.timeOut),re="",ie=1;var l=n.state.videofileList,c=[];l.map(function(e,t){c.push({uid:e.uid,fileName:e.name,name:e.name,fileUrl:o.obj})}),n.setState({videoUrl:o.obj,videoList:[],videofileList:c,uploading:!1}),I.a.success("文件上传成功!")}})}catch(e){console.log(e)}}),K(Q(n),"newsVisibleHide",function(){n.setState({newsVisible:!1})}),K(Q(n),"newsVisibleShow",function(){n.setState({newsVisible:!0})}),K(Q(n),"delVideo",function(){n.setState({videofileList:[]})}),K(Q(n),"uploadAllImg",function(t){var a=t.file,r=t.fileList,i=Q(n);n.setState({allfileList:r}),"removed"===a.status&&(n.setState({allfilelist:[],allcoverImgUrl:""}),n.state.cropImgRule.map(function(e,t){var a;i.setState((K(a={},e.coverName,""),K(a,e.coverList,[]),a))})),a.response&&(1===a.response.code&&"done"===a.status&&n.setState({allcoverImgUrl:a.response.obj,uploadAllImgModal:!0,focusImg:-1},function(){var t=document.querySelector("#croppedImg");t.src=a.thumbUrl,i.setState({cropper:new P.a(t,{aspectRatio:n.state.ratio,crop:function(t){var a=this.cropper.getCroppedCanvas().toDataURL("image/jpeg"),n=e(".crop-preview-item"),r=i.state.focusImg;-1===r?n.each(function(t,n){e(this).children("img").attr("src",a)}):n.eq(r).children("img").attr("src",a)}})})}),"error"===a.status&&(I.a.error("网络错误，上传失败！"),n.setState({allcoverImgUrl:"",allfileList:[]})))}),K(Q(n),"sureCropImg",function(){var t=0,a=Q(n);n.setState({uploadAllImgModal:!1,confirmLoading:!0,loading:!0}),I.a.warning("上传中，请稍候！"),n.state.cropper.destroy(),e(".crop-preview-item").each(function(n,r){var i=this;setTimeout(function(){var n,r=e(i).data("type"),o=e(i).data("list");a.setState((K(n={},r,""),K(n,o,[]),n));var s=Object(J.r)(e(i).find("img").prop("src")),l=new FormData;l.append("uploadFile",s),e.ajax("".concat(J.a,"/pic/upload"),{headers:{"Sign-Param":Object(J.A)()},method:"POST",data:l,timeout:3e4,processData:!1,contentType:!1,success:function(e){var n;2===(t+=1)&&(a.setState({loading:!1,confirmLoading:!1}),I.a.success("上传完毕！")),a.setState((K(n={},r,e.obj),K(n,o,[{uid:0,name:"xxx.png",status:"done",url:e.obj}]),n),function(){})},error:function(e,t){a.setState({confirmLoading:!1,loading:!1}),"timeout"===t?I.a.error("网络不稳定, 请检查网络后重新上传！"):I.a.error("上传发生错误, 请尝试重新上传！"),e.abort()}})},500*n)})}),K(Q(n),"uploadAllImgCancel",function(){n.setState({uploadAllImgModal:!1}),n.state.cropper.destroy()}),K(Q(n),"handleSubmit",function(e){e.preventDefault();var t=e.target.getAttribute("data-status"),a=Q(n);if(n.state.uploading)return I.a.warning("视频正在上传, 请稍候提交!"),!1;var r=Date.parse(n.props.form.getFieldValue("publishTime").format("YYYY-MM-DD HH:mm:ss")),i=Date.parse(new Date);return"3"===t&&r<=i?(I.a.warning("预发布时间应 大于 当前时间，请重新设置!"),!1):"1"===t&&r>i?(I.a.warning("直接发布的时间应 小于等于 当前时间，请重新设置!"),!1):(n.props.form.setFieldsValue({tags:n.state.tags.join(","),pc_recommend:n.state.pccoverImgUrl,pc:n.state.coverImgUrl,wap_small:n.state.mcoverImgUrl,wap_big:n.state.mccoverImgUrl,url:n.state.videofileList[0]&&n.state.videofileList[0].fileUrl?JSON.stringify(n.state.videofileList):"",video_m:n.state.mcoverImgUrl}),void n.props.form.validateFieldsAndScroll(function(e,r){if(!e){if(n.setState({loading:!0}),0===r.tagsV2.length)r.tagsV2="",r.tags="";else{var i=[],o="";r.tagsV2.forEach(function(e){i.push(z({name:e.label},JSON.parse(e.key))),o+="".concat(e.label,",")}),r.tagsV2=JSON.stringify(i),r.tags=o}delete r.smartTags,r.coverPic=JSON.stringify({pc_recommend:r.pc_recommend||"",pc:r.pc,wap_big:r.wap_big,wap_small:r.wap_small,video_pc:n.state.videoPccoverImgUrl,video_m:r.video_m}),r.publishTime=Date.parse(r.publishTime.format("YYYY-MM-DD HH:mm:ss")),r.createdBy="fff9d400cb94444fadaefd429516c276",r.topOrder=n.state.topOrder,delete r.pc,delete r.pc_recommend,delete r.wap_big,delete r.wap_small,delete r.video_pc,delete r.video_m,r.id=n.props.location.query.id||"",r.status="0"===t?"0":1,(!n.state.updateOrNot||!n.props.location.query.id)&&delete r.id,Object(J.i)("post","".concat(n.state.updateOrNot&&n.props.location.query.id?"/video/updatevideo":"/video/addvideo"),r,function(e){n.setState({loading:!1}),1===e.code?(I.a.success(n.state.updateOrNot?"修改成功！":"添加成功！"),a.closeWindow()):I.a.error(e.msg)})}}))}),K(Q(n),"sendVideo",function(e){var t={newsTitle:e.postTitle||"",newsContent:"".concat(e.postContent)||""};n.setState(z({},n.state,t))}),K(Q(n),"createMarkup",function(e){return{__html:e}}),K(Q(n),"CropperImgCroped",function(e){console.log(e)}),K(Q(n),"closeWindow",function(){n.setState({closeLoading:!0})}),K(Q(n),"FormItem",function(e,t,a,r,i,o,s,l,c){var u=n.state.updateOrNot,p=n.props.form.getFieldDecorator,d=_.a.createElement("div",null,_.a.createElement(S.a,{type:"plus"}),_.a.createElement("div",{className:"ant-upload-text"},"上传图片"));return _.a.createElement(ee,H({},{labelCol:{span:1},wrapperCol:{span:15,offset:1}},{label:a}),_.a.createElement("div",{className:"dropbox"},p(t,{initialValue:u&&i?o:"",rules:[{required:e,message:"请上传".concat(a,"封面！")}]})(_.a.createElement(y.a,{headers:{"Sign-Param":Object(J.A)()},action:"".concat(J.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:o,onPreview:n.handlePreview,onChange:s},o.length>=1?null:d)),c?"":_.a.createElement(v.a,{"data-type":r,onClick:n.handlePreview,className:"img-preview",type:"primary"},"预览"),_.a.createElement("span",{className:"cover-img-tip"},"用于 ",a," 的封面展示, 建议尺寸: ",_.a.createElement("font",{style:{color:"red"}},l))))}),K(Q(n),"handleTagsChange",function(e,t){e.map(function(e){e.title=Object(J.R)(JSON.parse(e.key).type,e.label)}),n.setState({value:e})}),K(Q(n),"handleBlur",function(){n.setState({searchText:""})}),K(Q(n),"handleSelect",function(e,t){e.type=t.props.dataType}),K(Q(n),"handleDeselect",function(e,t){var a=n.state.selectedTags.filter(function(t){return JSON.parse(t).id!==JSON.parse(e.key).id});n.setState({selectedTags:a})}),K(Q(n),"judgeExist",function(e,t){0===(t&&0!==t.length?t.filter(function(t){return t.name===e}):[]).length&&0!==t.length?n.setState({noCurrResult:!0}):n.setState({noCurrResult:!1})}),K(Q(n),"getTagList",function(e){X&&(clearTimeout(X),X=null),Z=e;X=setTimeout(function(){n.setState({searching:!0,data:[]}),Object(J.i)("post","/tagmgr/like",{name:e},function(t){if(n.setState({searching:!1}),n.judgeExist(Z,t.obj),0===t.obj.length&&""!==e.trim()?n.setState({searchText:_.a.createElement("div",null,_.a.createElement("span",null,"未查询到相关标签, 是否创建?"),_.a.createElement(v.a,{type:"primary",loading:n.state.tagsIconLoading,style:{margin:"0 10px"},onClick:n.addNewTag,size:"small"},"是"),_.a.createElement(v.a,{type:"primary",size:"small",onClick:function(){n.setState({searchText:""})}},"否")),noCurrResult:!1}):n.setState({searchText:""}),Z===e){var a=t.obj;n.setState({data:a})}})},500)}),K(Q(n),"addNewTag",function(e){e.target.disabled=!0;var t=n.props.form;n.setState({tagsIconLoading:!0}),Object(J.i)("post","/tagmgr/addSimpleTag",{name:Z,creator:M.a.get("hx_passportId")},function(e){n.setState({searchText:"",tagsIconLoading:!1,noCurrResult:!1});var a=[{title:"".concat(e.obj.name,"-聚合"),key:JSON.stringify({id:e.obj.id,type:e.obj.type}),type:e.obj.type,label:e.obj.name}];t.setFieldsValue({tagsV2:t.getFieldValue("tagsV2").concat(a)})})}),K(Q(n),"transTags",function(e){var t=[];return e.forEach(function(e){t.push({title:"".concat(Object(J.R)(e.type,e.name)),label:e.name,key:JSON.stringify({id:e.id,type:e.type})})}),t}),K(Q(n),"handleTagsSelect",function(e,t){var a=JSON.parse(e),r=n.state.selectedTags,i=n.props.form.getFieldValue("tagsV2"),o=t?[].concat(G(r),[e]):r.filter(function(t){return t!==e}),s=(a.name,Y(a,["name"])),l=[{title:"".concat(a.name,"-行情"),key:JSON.stringify(s),type:a.type,label:a.name}],c=!1;i.forEach(function(e){e.key===l[0].key&&(c=!0)}),n.props.form.setFieldsValue({tagsV2:t?c?G(i):[].concat(G(i),l):i.filter(function(e){return e.key!==l[0].key})}),n.setState({selectedTags:o})}),K(Q(n),"handleSmartTags",function(){var t=e("#content").val(),a=e("#title").val(),r=n.props.form.getFieldValue("tagsV2");if(""===t.trim())return I.a.error("视频内容不能为空!"),!1;n.setState({tagsLoading:!0}),Object(J.i)("post","/news/tags/predict",{content:t,title:n.props.location.query.from?n.state.tagTitle:a,media:"视频",passportId:se},function(e){if(!e||!Array.isArray(e.obj)||0===e.obj.length)return I.a.error("没有匹配到符合的标签!"),void n.setState({tagsLoading:!1});var t=[],a=[],i={};n.setState({oldTags:e.obj}),Array.isArray(e.obj)&&e.obj.forEach(function(e){var n=JSON.stringify({id:e.id,type:e.type,name:e.name}),r={title:"".concat(e.name,"-行情"),key:JSON.stringify({id:e.id,type:e.type}),label:e.name};t.push(n),a.push(r)});var o=r.concat(a).reduce(function(e,t){return i[t.key]?i[t.key]=!0:(i[t.key]=!0,e.push(t)),e},[]);n.props.form.setFieldsValue({tagsV2:o}),n.setState({selectedTags:t,smartTags:e.obj,smartTagsStatus:!0,tagsLoading:!1})})}),K(Q(n),"handleSmartTagsCancel",function(){n.setState({smartTags:[],smartTagsStatus:!1})}),n.state={closeLoading:!1,updateOrNot:!1,topOrder:0,tags:[],data:[],videofileList:[],videoList:[],inputVisible:!1,inputValue:"",channelId:"1",newsVisible:!1,cateId:"1",previewVisible:!1,previewImage:"",videoUrl:"",uploading:!1,progressNum:0,loading:!0,original:0,subject:0,uploadAllImgModal:!1,cropper:null,focusImg:-1,confirmLoading:!1,ratio:640/360,cropImgRule:[{coverName:"mcoverImgUrl",coverList:"mfileList",width:"320px",height:"180px",ratio:640/360,intro:"M端列表缩略图:640 * 360"},{coverName:"coverImgUrl",coverList:"fileList",width:"285px",height:"160px",ratio:1.78125,intro:"PC端列表缩略图:285 * 160"}]},n}var n,i,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(a,U["Component"]),n=a,(i=[{key:"componentWillMount",value:function(){this.insertState(["videoPc","videoM","all","","pc","m","mc"])}},{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.dispatch,n=t.location;n.query.id||n.query.url?a(Object(R.b)({id:n.query.id},function(t){e.renderData(t)})):(this.setState({loading:!1}),sessionStorage.setItem("hx_content",""))}},{key:"changeActiveImg",value:function(e,t,a){var n=this;if(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation(),a===this.state.focusImg)return!1;this.setState({ratio:t.ratio,focusImg:a},function(){n.state.cropper.setAspectRatio(t.ratio)})}},{key:"render",value:function(){var e=this,t=this,a=this.props.form.getFieldDecorator,n=this.props.newsInfo,i=this.state,s=i.selectedTags,c=i.focusImg,p=i.allfileList,m=i.uploadAllImgModal,g=i.progressNum,h=i.videofileList,b=i.uploading,w=i.previewVisible,I=i.previewImage,E=i.fileList,O=i.mfileList,L=i.newsContent,T=i.updateOrNot,N=i.newsVisible,U={labelCol:{span:1},wrapperCol:{span:15,offset:1}},x={action:"/file/upload",onRemove:function(t){e.setState(function(e){var a=e.fileList,n=a.indexOf(t),r=a.slice();return r.splice(n,1),{videoList:r,videofileList:r}})},beforeUpload:function(t){return e.setState({videoList:[t],videofileList:[t]}),!1},fileList:this.state.videofileList},P=_.a.createElement("div",null,_.a.createElement(S.a,{type:"plus"}),_.a.createElement("div",{className:"ant-upload-text"},"上传图片")),A=this.state.data.map(function(e){return _.a.createElement(ae,{title:Object(J.R)(e.type,e.name),dataType:e.type,className:"tagType-".concat(e.type),value:JSON.stringify({id:e.id,type:e.type}),key:e.id},e.name)});return _.a.createElement("div",{className:"video-send"},_.a.createElement(u.a,{spinning:this.state.loading,size:"large"},_.a.createElement(V.a,{onSubmit:this.handleSubmit},_.a.createElement(ee,H({},U,{label:"作者: "}),a("author",{initialValue:T&&n?"".concat(n.author):"",rules:[{required:!0,message:"请输入视频作者！"}]})(_.a.createElement(C.a,{ref:function(t){e.authorInput=t},className:"news-author",placeholder:"请输入视频作者"}))),_.a.createElement(ee,H({},U,{label:"来源: "}),a("source",{initialValue:T&&n?"".concat(n.source||""):"",rules:[{required:!0,message:"请输入视频来源！"}]})(_.a.createElement(C.a,{className:"news-source",placeholder:"请输入视频来源"}))),_.a.createElement(ee,H({},U,{label:"发布日期: "}),a("publishTime",{rules:[{required:!0,message:"请选择视频发布时间！"}],initialValue:T&&n?F()(Object(J.w)(n.publishTime),"YYYY-MM-DD HH:mm:ss"):F()()})(_.a.createElement(f.a,{showTime:!0,format:"YYYY-MM-DD HH:mm:ss"}))),_.a.createElement(ee,H({},U,{label:"视频上传"}),a("url",{rules:[{required:!0,message:"请上传视频！"}]})(_.a.createElement(y.a,H({},x,{name:"uploadFile"}),_.a.createElement(v.a,null,_.a.createElement(S.a,{type:"upload"})," 选择视频"))),0===h.length?"":h[0].fileName?_.a.createElement("div",null,_.a.createElement("video",{controls:!0,style:{width:200},src:e.state.videoUrl}),_.a.createElement("p",null,_.a.createElement("span",null,h[0].fileName),_.a.createElement("span",{onClick:e.delVideo,style:{marginLeft:15,color:"#52b8fc",cursor:"pointer"}},"删除"))):void 0,_.a.createElement(v.a,{style:{marginTop:16},className:"upload-demo-start",type:"primary",onClick:this.handleUpload,disabled:0===this.state.videoList.length,loading:b},b?"上传中":"开始上传"),b&&_.a.createElement(d.a,{strokeWidth:5,style:{width:300,display:"block"},percent:g,status:"active"})),_.a.createElement(ee,H({},U,{label:"视频标题: "}),a("title",{initialValue:T&&n?"".concat(n.title):"",rules:[{required:!0,message:"请输入视频标题！"}]})(_.a.createElement(C.a,{placeholder:"请输入视频标题"}))),_.a.createElement(ee,H({},U,{label:"视频简介: "}),a("content",{initialValue:T&&n?"".concat(n.content):"",rules:[{required:!0,message:"请输入视频简介"}]})(_.a.createElement(te,{className:"news-summary",placeholder:"请输入视频简介",rows:4}))),_.a.createElement(ee,H({},U,{label:"智能标签: "}),a("smartTags",{initialValue:this.state.tags.join(","),rules:[{required:!1,message:"至少输入一个标签！"}]})(_.a.createElement(C.a,{className:"tag-item",style:{display:"none"}})),this.state.smartTagsStatus?_.a.createElement("div",null,0!==this.state.smartTags.length?this.state.smartTags.map(function(t){var a=JSON.stringify({id:t.id,type:t.type,name:t.name});return _.a.createElement(ne,{style:{border:"1px dashed #108ee9"},key:a,checked:s.indexOf(a)>-1,onChange:function(t){return e.handleTagsSelect(a,t)}},t.name)}):"没有查询到相关标签",0!==this.state.smartTags.length&&"(点击选择/取消需要关联的标签)",_.a.createElement(v.a,{loading:this.state.tagsLoading,style:{margin:"0 10px"},size:"small",type:"primary",onClick:this.handleSmartTags},"重新生成"),_.a.createElement(v.a,{size:"small",type:"primary",onClick:this.handleSmartTagsCancel},"取消")):_.a.createElement("div",null,"点击",_.a.createElement(v.a,{loading:this.state.tagsLoading,style:{margin:"0 10px"},size:"small",type:"primary",onClick:this.handleSmartTags},"此处"),"根据内容智能生成行情(币)标签")),_.a.createElement(o.a,{style:{maxWidth:1200}},_.a.createElement(l.a,{span:18},_.a.createElement(ee,H({},U,{label:"新版标签："}),a("tagsV2",{initialValue:T&&n&&n.tagsV2&&0!==JSON.parse(n.tagsV2).length?this.transTags(JSON.parse(n.tagsV2)):[],rules:[{required:!0,message:"请选择相关标签！"}]})(_.a.createElement(j.a,{mode:"multiple",showSearch:!0,labelInValue:!0,notFoundContent:this.state.searching?_.a.createElement(u.a,{size:"small"}):this.state.searchText,filterOption:!1,optionFilterProp:"children",style:{width:"100%"},onSearch:this.getTagList,onSelect:this.handleSelect,onDeselect:this.handleDeselect,onChange:this.handleTagsChange,onBlur:this.handleBlur},A)),this.state.noCurrResult&&_.a.createElement("p",{style:{position:"absolute",right:"-160px",bottom:0}},_.a.createElement("span",null,"未找到结果?"),_.a.createElement(v.a,{type:"primary",loading:this.state.tagsIconLoading,style:{margin:"0 10px"},onClick:this.addNewTag,size:"small"},"创建"),_.a.createElement("span",null,"一个"))))),_.a.createElement(ee,H({},U,{label:"热度: "}),a("hotCounts",{initialValue:T&&n&&n.hotCounts||0,rules:[{required:!0,pattern:/^[0-9]+$/,message:"请输入视频热度值(正整数)！"}]})(_.a.createElement(C.a,{className:"news-source",placeholder:"请输入视频热度值"}))),_.a.createElement(ee,H({},U,{label:"统一上传图片: "}),_.a.createElement("div",{className:"dropbox"},_.a.createElement(y.a,{headers:{"Sign-Param":Object(J.A)()},action:"".concat(J.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:p,onPreview:this.handlePreview,onChange:this.uploadAllImg},p.length>=1?null:P),_.a.createElement("span",{className:"cover-img-tip all-img"},"统一上传所有尺寸图片，自动剪裁适配尺寸"))),this.FormItem(!0,"pc","PC列表缩略图","coverImgUrl",n,E,this.handleChange,"285 * 160"),this.FormItem(!0,"video_m","M列表缩略图","mcoverImgUrl",n,O,this.handleMobileChange,"640 * 360"),_.a.createElement(ee,{wrapperCol:{span:12,offset:2}},_.a.createElement(v.a,{type:"primary","data-status":"1",onClick:this.handleSubmit,style:{marginRight:"10px"}},"发表"),_.a.createElement(v.a,{type:"primary","data-status":"3",onClick:this.handleSubmit,style:{marginRight:"10px"}},"定时发表"),_.a.createElement(v.a,{type:"primary","data-status":"0",onClick:this.handleSubmit,style:{marginRight:"10px"}},"存为草稿"),_.a.createElement(v.a,{type:"primary",className:"cancel",onClick:this.closeWindow},"取消")),_.a.createElement(r.a,{confirmLoading:this.state.confirmLoading,height:"700px",width:"1280px",style:{top:"50px"},visible:m,onOk:this.sureCropImg,onCancel:this.uploadAllImgCancel},_.a.createElement("div",{className:"croper-wrap video clearfix"},_.a.createElement("div",{className:"crop-img",id:"cropImgWrap"},_.a.createElement("img",{id:"croppedImg",src:"",alt:"Picture"})),_.a.createElement("div",{onClick:function(t){t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),e.setState({focusImg:-1})},className:"crop-preview"},this.state.cropImgRule.map(function(e,a){return _.a.createElement("div",{key:a,onClick:function(n){t.changeActiveImg(n,e,a)},className:"cropper-intro"},_.a.createElement("div",{className:"cropper-item-wrap ".concat(c===a?"active":"")},_.a.createElement("div",{"data-type":e.coverName,"data-list":e.coverList,className:"crop-preview-item",style:{width:e.width,height:e.height}},_.a.createElement("img",{src:"",alt:"",style:{width:"100%",height:"100%"}}))),_.a.createElement("span",null,e.intro))})))),_.a.createElement(r.a,{visible:N,footer:null,className:"newsModal",onCancel:this.newsVisibleHide,width:1e3},_.a.createElement(o.a,null,_.a.createElement(l.a,{className:"previewNews simditor"},_.a.createElement("p",{className:"simditor-body",style:{padding:10},dangerouslySetInnerHTML:this.createMarkup(L)})))),_.a.createElement(r.a,{visible:w,footer:null,onCancel:this.handleCancel},_.a.createElement("img",{alt:"example",style:{width:"100%"},src:I})))),this.state.closeLoading&&_.a.createElement(k.a,{handleCancel:function(t){clearInterval(t),e.setState({closeLoading:!1})},closeLoading:this.state.closeLoading}))}}])&&W(n.prototype,i),s&&W(n,s),a}();t.default=Object(x.connect)(function(e){return{userInfo:e.videoInfo.userInfo,newsInfo:e.videoInfo.info}})(V.a.create()(le))}.call(this,a(97))},1641:function(e,t,a){var n=a(1642);"string"==typeof n&&(n=[[e.i,n,""]]);var r={transform:void 0};a(186)(n,r);n.locals&&(e.exports=n.locals)},1642:function(e,t,a){(e.exports=a(185)(!1)).push([e.i,"",""])},1643:function(e,t,a){"use strict";a.d(t,"e",function(){return c}),a.d(t,"c",function(){return u}),a.d(t,"b",function(){return p}),a.d(t,"d",function(){return d}),a.d(t,"a",function(){return f}),a.d(t,"h",function(){return g}),a.d(t,"f",function(){return v}),a.d(t,"g",function(){return h});a(361);var n=a(20),r=a.n(n),i=a(48),o=a(2);function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){l(e,t,a[t])})}return e}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var c=function(e){return{type:o.xb,data:e}},u=function(e,t,a){return function(n){var o="init"===e?"/video/getvideolist":"/post/search";Object(i.i)("get",o,t?s({},t,{createrType:0}):{},function(e){if(1===e.code){var t=e.obj;n(m({list:t.inforList})),n(h({totalCount:t.recordCount,pageSize:t.pageSize,currPage:t.currentPage})),a&&a(t)}else r.a.error(e.msg)})}},p=function(e,t){return function(a){Object(i.i)("post","/video/getbyid",s({},e),function(e){if(1===e.code){var n=e.obj;a(m({info:n})),t&&t(n)}else r.a.error(e.msg)})}},d=function(e,t){return function(a){Object(i.i)("post","/news/setorder",s({},e),function(a){1===a.code?(0===parseInt(e.topOrder)?r.a.success("取消置顶成功！"):r.a.success("置顶成功！"),t&&t()):r.a.error(a.msg)})}},m=function(e){return{type:o.Gb.ADD_DATA,data:e}},f=function(e,t){return{type:o.Gb.EDIT_LIST_ITEM,data:e,index:t}},g=function(e){return{type:o.Gb.SET_SEARCH_QUERY,data:e}},v=function(e){return{type:o.Gb.SET_FILTER_DATA,data:e}},h=function(e){return{type:o.Gb.SET_PAGE_DATA,data:e}}}}]);