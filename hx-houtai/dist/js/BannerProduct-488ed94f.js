(window.webpackJsonp=window.webpackJsonp||[]).push([[70],{1475:function(e,t,n){"use strict";n.r(t);n(675);var a=n(676),r=n.n(a),i=(n(1385),n(1386)),s=n.n(i),o=(n(1381),n(1382)),c=n.n(o),l=(n(1383),n(1384)),u=n.n(l),p=(n(247),n(183)),m=n.n(p),d=(n(184),n(1378)),h=n.n(d),f=(n(1390),n(1391)),b=n.n(f),y=(n(361),n(20)),g=n.n(y),k=(n(677),n(362)),v=n.n(k),E=(n(1376),n(1377)),w=n.n(E),O=n(0),S=n.n(O),N=n(246),j=(n(1653),n(10)),P=n(1654),I=n(248),L=n(48);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){D(e,t,n[t])})}return e}function _(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var H=w.a.confirm,z=v.a.Option,M=[],R=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=V(t).call(this,e),n=!r||"object"!==C(r)&&"function"!=typeof r?x(a):r,D(x(n),"handleChange",function(e){(0,n.props.dispatch)(Object(P.d)({status:e})),n.setState({status:e}),n.doSearch("init",{currentPage:1,status:e})}),D(x(n),"handleTypeChange",function(e){(0,n.props.dispatch)(Object(P.d)({position:e})),n.setState({position:e}),n.doSearch("init",{currentPage:1,position:e})}),D(x(n),"searchBanner",function(){var e=n.props.dispatch;console.log(n.state.status),e(Object(P.d)({status:n.state.status})),n.doSearch("init",{status:n.state.status,search:n.state.searchVal})}),D(x(n),"searchTitleVal",function(e){n.setState({searchVal:e.target.value})}),D(x(n),"getOrderNum",function(e){n.setState({order:e})}),D(x(n),"handleCancel",function(){return n.setState({previewVisible:!1})}),D(x(n),"handlePreview",function(e){n.setState({previewImage:e.target.getAttribute("src"),previewVisible:!0})}),n.state={loading:!0,previewVisible:!1,previewImage:"",status:null,position:"0",order:1,recommendVisible:!1,searchVal:null},n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,O["Component"]),n=t,(a=[{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.filter;(0,t.dispatch)(Object(I.f)()),this.doSearch("init",{status:n.status}),M=[{title:"标题",key:"title",render:function(t,n){return n&&S.a.createElement("div",{className:"banner-info clearfix"},S.a.createElement("div",null,S.a.createElement("h4",{title:n.title,dangerouslySetInnerHTML:e.createMarkup(Object(L.q)(n.title,50))}),0===n.status?S.a.createElement("span",{className:"banner-status pre-publish"},"已撤回"):1===n.status?S.a.createElement("span",{className:"banner-status has-publish"},"展示中"):S.a.createElement("span",null,"暂无")))}},{title:"类型",key:"type",width:105,render:function(e){return e?1===e.type?S.a.createElement("span",{className:"banner-status link"},"新闻详情"):2===e.type?S.a.createElement("span",{className:"banner-status will-publish"},"新闻列表"):3===e.type?S.a.createElement("span",{className:"banner-status news"},"关键字/标签"):4===e.type?S.a.createElement("span",{className:"banner-status news"},"专题"):5===e.type?S.a.createElement("span",{className:"banner-status authorInfo"},"作者信息"):6===e.type?S.a.createElement("span",{className:"banner-status ad"},"广告"):7===e.type?S.a.createElement("span",{className:"banner-status link"},"链接跳转"):8===e.type?S.a.createElement("span",{className:"banner-status link"},"产品"):9===e.type?S.a.createElement("span",{className:"banner-status link"},"活动"):S.a.createElement("span",{className:"banner-status no"},"暂无"):S.a.createElement("span",{className:"banner-status no"},"暂无")}},{title:"相关信息",key:"typeLink",render:function(t){return 1===t.type?S.a.createElement("a",{target:"_blank",href:t.typeLink&&""!==t.typeLink.trim()?"http://www.huoxing24.com/newsdetail/"+t.typeLink+".html":"#/banner-productList"},"".concat(t.typeLink&&""!==t.typeLink.trim()?"http://www.huoxing24.com/newsdetail/"+t.typeLink+".html":"暂无链接")):2===t.type?S.a.createElement("p",null,"频道：",e.channelName(e.props.channelList,t.typeLink)):3===t.type?S.a.createElement("p",null,"新闻关键字：",t.typeLink||"暂无"):4===t.type?S.a.createElement("p",null,"专题：",t.typeLink||"暂无"):5===t.type?S.a.createElement("p",null,"作者昵称/ID：",t.typeLink):6===t.type||7===t.type||8===t.type||9===t.type?S.a.createElement("a",{target:"_blank",href:t.typeLink&&""!==t.typeLink.trim()?t.typeLink:"#/banner-productList"},t.typeLink&&""!==t.typeLink.trim()?t.typeLink:"暂无链接"):S.a.createElement("p",null,"暂无")}},{title:"PC 端封面 ",dataIndex:"pcImgSrc",key:"pcImgSrc",render:function(t){return S.a.createElement("div",{className:"shrinkPic",key:t,style:{background:"url(".concat(t||"http://static.huoxing24.com/images/2018/03/31/1522470188490129.png",") no-repeat center / cover")},src:t||"http://static.huoxing24.com/images/2018/03/31/1522470188490129.png",onClick:e.handlePreview})}},{title:"推荐位权重",key:"showNum",render:function(e){return e.showNum&&0!==parseInt(e.showNum)&&0!==parseInt(e.status)?e.showNum:"无权限"}},{title:"操作",key:"action",width:130,render:function(t){var n="";switch(t.status){case 0:n=S.a.createElement("p",null,S.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.recommendTopic(t)},style:{background:"#00b45a"}},"展示"));break;case 1:n=S.a.createElement("div",null,S.a.createElement("p",{style:{marginTop:10}},S.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.recommendTopic(t)},style:{background:"#00b45a"}},"修改展示权重")),S.a.createElement("p",{style:{marginTop:10}},S.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.backRecommend(t)},style:{background:"#e9892f"}},"撤回(取消展示)")));break;default:n=""}return S.a.createElement("div",null,S.a.createElement("p",{style:{marginBottom:10}},S.a.createElement(j.Link,{className:"mr10 opt-btn",to:{pathname:"/banner-add",query:{id:t.id}},style:{background:"#49a9ee"}},"修改轮播内容")),n,S.a.createElement("p",{style:{marginTop:10}},S.a.createElement("a",{onClick:function(){return e.delBanner(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#d73435"}},"删除")))}}]}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"channelName",value:function(e,t){var n="";return e.map(function(e,a){parseInt(e.value)===parseInt(t)&&(n=e.label)}),n}},{key:"doSearch",value:function(e,t){var n=this,a=this.props,r=a.dispatch,i=a.pageData,s={position:8,status:a.filter.status,pageSize:20,currentPage:i.currentPage};s=T({},s,t),r(Object(P.b)(e,s,function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.props.dispatch;this.doSearch("init",{currentPage:1}),e(Object(P.e)({currentPage:1}))}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.props,n=t.dispatch,a=t.filter;n(Object(P.e)({currentPage:e})),this.doSearch("init",T({currentPage:e},a))}},{key:"delBanner",value:function(e){var t=this;H({title:"提示",content:"确认要删除吗 ?",onOk:function(){var n={id:e.id};Object(L.i)("POST","/homerecommend/delhomerecommend",T({},n),function(e){1===e.code?(g.a.success("删除成功"),t.doSearch("init")):g.a.error(e.msg)})}})}},{key:"recommendTopic",value:function(e){var t=this,n=this;e.showNum&&0!==parseInt(e.showNum)&&0!==parseInt(e.status)?this.setState({order:e.showNum}):this.setState({order:1}),(0,this.props.dispatch)(Object(P.c)(e.position,function(a){H({title:"提示",content:S.a.createElement("div",{className:"modal-input"},S.a.createElement("span",{style:{marginRight:10}},"请输入首页推荐位置的权重：(权重越高越靠前)"),S.a.createElement("p",null,"已被占用的权重：",S.a.createElement("span",null,a.join(", "))),S.a.createElement(b.a,{min:1,defaultValue:t.state.order,autoFocus:!0,type:"number",onChange:n.getOrderNum})),onOk:function(){var t=n.state.order;if(""===t.toString().trim())return g.a.error("推荐位的权重值不能为空！"),!1;var a={id:e.id,status:1};0===e.status?Object(L.i)("POST","/homerecommend/updateHomerecommendstatus",T({},a),function(a){1===a.code?Object(L.i)("post","/homerecommend/updateHomerecommendshownum",{id:e.id,position:e.position,showNum:t},function(e){1===e.code?(g.a.success("操作成功"),n.doSearch("init")):g.a.error(e.msg)}):g.a.error(a.msg)}):Object(L.i)("post","/homerecommend/updateHomerecommendshownum",{id:e.id,position:e.position,showNum:t},function(e){1===e.code?(g.a.success("操作成功"),n.doSearch("init")):g.a.error(e.msg)})}})}))}},{key:"backRecommend",value:function(e){var t=this;H({title:"提示",content:"确认要撤回推荐吗 ?",onOk:function(){var n={id:e.id,status:0};Object(L.i)("POST","/homerecommend/updateHomerecommendstatus",T({},n),function(e){1===e.code?(g.a.success("操作成功"),t.doSearch("init")):g.a.error(e.msg)})}})}},{key:"_isPublish",value:function(e){var t=this;H({title:"提示",content:"确认要".concat(0===e.status?"开启直播":"结束直播","吗 ?"),onOk:function(){var n={id:e.id,status:0===e.status?1:0};Object(L.i)("POST","/news/status",T({},n),function(e){1===e.code?(g.a.success("操作成功！"),t.doSearch("init")):g.a.error(e.msg)})}})}},{key:"_forbidcomment",value:function(e){var t=this,n=this.props.dispatch,a={id:e.id,operate:parseInt(e.forbidComment)?"0":"1"};Object(L.i)("post","/post/forbidcomment",a,function(e){200===e.status?(t.doSearch("init"),n(Object(P.f)({type:"init"}))):g.a.error(e.msg)})}},{key:"_isTop",value:function(e){var t=this,n=this.props.dispatch,a={id:e.id,recommend:1===e.recommend?0:1};Object(L.i)("post","/ico/recommend",a,function(e){1===e.code?(t.doSearch("init"),n(Object(P.f)({type:"init"}))):g.a.error(e.msg)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,a=t.pageData,i=t.filter;return S.a.createElement("div",{className:"banner-index"},S.a.createElement(c.a,null,S.a.createElement(u.a,null,S.a.createElement("span",null,"状态筛选："),S.a.createElement(v.a,{defaultValue:"".concat(i.status),style:{width:120},onChange:this.handleChange},L.o.map(function(e){return S.a.createElement(z,{value:e.value,key:e.value},e.label)})),S.a.createElement(h.a,{style:{width:150,margin:"0 15px"},placeholder:"标题",defaultValue:"",onChange:this.searchTitleVal,onPressEnter:function(){e.searchBanner()}}),S.a.createElement(m.a,{type:"primary",onClick:this.searchBanner},"搜索"),S.a.createElement(m.a,{type:"primary",style:{margin:"0 15px"},onClick:function(){return j.hashHistory.push("/banner-add")}},"新增"))),S.a.createElement("div",{className:"mt30"},S.a.createElement(r.a,{spinning:this.state.loading,size:"large"},S.a.createElement(s.a,{dataSource:n.map(function(e,t){return T({},e,{key:t})}),columns:M,bordered:!0,pagination:{current:a.currentPage,total:a.totalCount,pageSize:a.pageSize,onChange:function(t){return e.changePage(t)}}}),S.a.createElement(w.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancel},S.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage})))))}}])&&_(n.prototype,a),i&&_(n,i),t}();t.default=Object(N.connect)(function(e){return{bannerInfo:e.bannerInfo,list:e.bannerInfo.list,search:e.bannerInfo.search,filter:e.bannerInfo.filter,pageData:e.bannerInfo.pageData,numArr:e.bannerInfo.numArr,channelList:e.channelListInfo}})(R)}}]);