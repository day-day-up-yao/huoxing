(window.webpackJsonp=window.webpackJsonp||[]).push([[173],{1464:function(e,t,a){"use strict";a.r(t);a(675);var n=a(676),r=a.n(n),i=(a(247),a(183)),c=a.n(i),l=(a(1376),a(1377)),o=a.n(l),s=(a(1388),a(1389)),u=a.n(s),m=(a(184),a(1378)),p=a.n(m),d=(a(1387),a(50)),f=a.n(d),g=(a(361),a(20)),h=a.n(g),y=(a(1379),a(1380)),b=a.n(y),v=a(0),S=a.n(v),I=a(246),E=a(10),w=a(1675),k=a(48);a(1649);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(){return(C=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function N(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var T=b.a.Item,F=function(e){function t(){var e,a,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var i=arguments.length,c=new Array(i),l=0;l<i;l++)c[l]=arguments[l];return n=this,r=(e=L(t)).call.apply(e,[this].concat(c)),a=!r||"object"!==O(r)&&"function"!=typeof r?j(n):r,B(j(a),"state",{previewVisible:!1,previewImage:"",pcImgSrcFileList:[],pcNewImgSrcFileList:[],mImgSrcFileList:[],pcImgSrc:"",pcNewImgSrc:"",mImgSrc:"",pcBackImageFileList:[],mBackImageFileList:[],pcBackImage:"",mBackImage:"",loading:!1,contentList:[]}),B(j(a),"handleCancel",function(){return a.setState({previewVisible:!1})}),B(j(a),"handlePreview",function(e){a.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})}),B(j(a),"handlePcNewImgChange",function(e){var t=e.file,n=e.fileList;a.setState({pcNewImgSrcFileList:n}),"removed"===t.status&&a.setState({pcNewImgSrc:""}),t.response&&(1===t.response.code&&"done"===t.status&&a.setState({pcNewImgSrc:t.response.obj}),"error"===t.status&&(h.a.error("网络错误，上传失败！"),a.setState({pcNewImgSrc:"",pcNewImgSrcFileList:[]})))}),B(j(a),"handlePcImgChange",function(e){var t=e.file,n=e.fileList;a.setState({pcImgSrcFileList:n}),"removed"===t.status&&a.setState({pcImgSrc:""}),t.response&&(1===t.response.code&&"done"===t.status&&a.setState({pcImgSrc:t.response.obj}),"error"===t.status&&(h.a.error("网络错误，上传失败！"),a.setState({pcImgSrc:"",pcImgSrcFileList:[]})))}),B(j(a),"handleMImgChange",function(e){var t=e.file,n=e.fileList;a.setState({mImgSrcFileList:n}),"removed"===t.status&&a.setState({mImgSrc:""}),t.response&&(1===t.response.code&&"done"===t.status&&a.setState({mImgSrc:t.response.obj}),"error"===t.status&&(h.a.error("网络错误，上传失败！"),a.setState({mImgSrc:"",mImgSrcFileList:[]})))}),B(j(a),"handlePcBackImgChange",function(e){var t=e.file,n=e.fileList;a.setState({pcBackImageFileList:n}),"removed"===t.status&&a.setState({pcBackImage:""}),t.response&&(1===t.response.code&&"done"===t.status&&a.setState({pcBackImage:t.response.obj}),"error"===t.status&&(h.a.error("网络错误，上传失败！"),a.setState({pcBackImage:"",pcBackImageFileList:[]})))}),B(j(a),"handleMBackImgChange",function(e){var t=e.file,n=e.fileList;a.setState({mBackImageFileList:n}),"removed"===t.status&&a.setState({mBackImage:""}),t.response&&(1===t.response.code&&"done"===t.status&&a.setState({mBackImage:t.response.obj}),"error"===t.status&&(h.a.error("网络错误，上传失败！"),a.setState({mBackImage:"",mBackImageFileList:[]})))}),B(j(a),"handleSubmit",function(e){e.preventDefault();var t={type:4,status:1,pcImgSrc:a.state.pcImgSrc,mImgSrc:a.state.mImgSrc,pcBackImage:a.state.pcBackImage,mBackImage:a.state.mBackImage,newSmallPcImgSrc:a.state.pcNewImgSrc};a.props.form.setFieldsValue({pcImgSrc:a.state.pcImgSrc,pcNewImgSrc:a.state.pcNewImgSrc,mImgSrc:a.state.mImgSrc,pcBackImage:a.state.pcBackImage,mBackImage:a.state.mBackImage}),a.props.form.validateFieldsAndScroll(function(e,n){e||(a.setState({loading:!0}),t.topicName=n.topicName,t.tags=n.tags,t.description=n.description,t.descriptionForSEO=n.descriptionForSEO,t.keyword=n.keyword,t.typeLink=n.typeLink,n.topic=t,n.contentList=a.state.contentList,delete n.topicName,delete n.pcImgSrc,delete n.pcNewImgSrc,delete n.mImgSrc,delete n.pcBackImage,delete n.mBackImage,delete n.tags,delete n.typeLink,delete n.keyword,delete n.description,delete n.descriptionForSEO,Object(k.m)("/topic/add",n,function(e){1===e.code?(a.setState({loading:!1}),h.a.success("添加成功！"),E.hashHistory.push("/specialTopic-list")):(h.a.error(e.msg),a.setState({loading:!1}))}))})}),B(j(a),"createMarkup",function(e){return{__html:e}}),a}var a,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,v["Component"]),a=t,(n=[{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state,n=a.previewVisible,i=a.previewImage,l=a.pcNewImgSrcFileList,s=a.pcImgSrcFileList,m=a.pcBackImageFileList,d=a.mBackImageFileList,g=a.mImgSrcFileList,h={labelCol:{span:1},wrapperCol:{span:19}},y=S.a.createElement("div",null,S.a.createElement(f.a,{type:"plus"}),S.a.createElement("div",{className:"ant-upload-text"},"上传图片"));return S.a.createElement("div",{className:"specialTopic-send"},S.a.createElement(r.a,{spinning:this.state.loading,size:"large"},S.a.createElement(b.a,{onSubmit:this.handleSubmit},S.a.createElement(T,C({className:"specialTopicTitle"},h,{label:"专题名称 "}),t("topicName",{initialValue:"",rules:[{required:!0,message:"请输入专题名称！"}]})(S.a.createElement(p.a,{className:"specialTopic-name",placeholder:"请输入专题名称"}))),S.a.createElement(T,C({className:"specialTopicTitle"},h,{label:"专题关键字 "}),t("tags",{initialValue:"",rules:[{required:!0,message:"请输入专题关键字！"}]})(S.a.createElement(p.a,{className:"specialTopic-tags",placeholder:"请输入专题关键字"}))),S.a.createElement(T,C({className:"specialTopicTitle"},h,{label:"KeyWords "}),t("keyword",{initialValue:"",rules:[{required:!0,message:"请输入专题的 KeyWords！"}]})(S.a.createElement(p.a,{className:"specialTopic-tags",placeholder:"专题 KeyWords (用于 SEO 优化), 多个词条请用英文逗号隔开!"}))),S.a.createElement(T,C({className:"specialTopicTitle"},h,{label:"Description "}),t("description",{initialValue:"",rules:[{required:!0,message:"请输入专题的介绍！"}]})(S.a.createElement(p.a,{className:"specialTopic-tags",placeholder:"专题顶部介绍"}))),S.a.createElement(T,C({className:"specialTopicTitle"},h,{label:"DescForSEO "}),t("descriptionForSEO",{initialValue:"",rules:[{message:"请输入专题的 SEO 描述！"}]})(S.a.createElement(p.a,{className:"specialTopic-tags",placeholder:"专题描述(用于 SEO 优化)"}))),S.a.createElement(T,C({},h,{className:"specialTopicTitle",label:"专题链接地址："}),t("typeLink",{initialValue:"",rules:[{type:"url",message:"请输入正确的超链接地址！"}]})(S.a.createElement(p.a,{placeholder:"专题跳转的超链接地址"}))),S.a.createElement(T,C({},h,{label:"首页缩略图: ",className:"upload-div"}),S.a.createElement("div",{className:"dropbox"},t("pcNewImgSrc",{initialValue:"",rules:[{required:!0,message:"请上传新首页pc 封面图！"}]})(S.a.createElement(u.a,{headers:{"Sign-Param":Object(k.A)()},action:"".concat(k.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:l,onPreview:this.handlePreview,onChange:this.handlePcNewImgChange},l.length>=1?null:y)),S.a.createElement(o.a,{visible:n,footer:null,onCancel:this.handleCancel},S.a.createElement("img",{alt:"example",style:{width:"100%"},src:i})),S.a.createElement("span",{className:"cover-img-tip"},"用于 pc 端新首页推荐的缩略图展示, 长宽比例: ",S.a.createElement("font",{style:{color:"red"}},"90 * 65")))),S.a.createElement(T,C({},h,{label:"pc 封面: ",className:"upload-div"}),S.a.createElement("div",{className:"dropbox"},t("pcImgSrc",{initialValue:"",rules:[{required:!0,message:"请上传pc 封面图！"}]})(S.a.createElement(u.a,{headers:{"Sign-Param":Object(k.A)()},action:"".concat(k.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:s,onPreview:this.handlePreview,onChange:this.handlePcImgChange},s.length>=1?null:y)),S.a.createElement(o.a,{visible:n,footer:null,onCancel:this.handleCancel},S.a.createElement("img",{alt:"example",style:{width:"100%"},src:i})),S.a.createElement("span",{className:"cover-img-tip"},"用于 pc 端首页推荐的封面图展示, 长宽比例: ",S.a.createElement("font",{style:{color:"red"}},"300 * 100")))),S.a.createElement(T,C({},h,{label:"pc 专题背景: ",className:"upload-div"}),S.a.createElement("div",{className:"dropbox"},t("pcBackImage",{initialValue:"",rules:[{required:!0,message:"请上传 pc 专题背景！"}]})(S.a.createElement(u.a,{headers:{"Sign-Param":Object(k.A)()},action:"".concat(k.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:m,onPreview:this.handlePreview,onChange:this.handlePcBackImgChange},m.length>=1?null:y)),S.a.createElement(o.a,{visible:n,footer:null,onCancel:this.handleCancel},S.a.createElement("img",{alt:"example",style:{width:"100%"},src:i})),S.a.createElement("span",{className:"cover-img-tip"},"用于专题页面的背景图展示, 长宽比例: ",S.a.createElement("font",{style:{color:"red"}},"1920 * 300")))),S.a.createElement(T,C({},h,{label:"M 端专题封面: ",className:"upload-div"}),S.a.createElement("div",{className:"dropbox"},t("mImgSrc",{initialValue:"",rules:[{required:!0,message:"请上传 m 专题封面图！"}]})(S.a.createElement(u.a,{headers:{"Sign-Param":Object(k.A)()},action:"".concat(k.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:g,onPreview:this.handlePreview,onChange:this.handleMImgChange},g.length>=1?null:y)),S.a.createElement(o.a,{visible:n,footer:null,onCancel:this.handleCancel},S.a.createElement("img",{alt:"example",style:{width:"100%"},src:i})),S.a.createElement("span",{className:"cover-img-tip"},"用于 M 端首页推荐的封面图展示, 长宽比例: ",S.a.createElement("font",{style:{color:"red"}},"252 * 136")))),S.a.createElement(T,C({},h,{label:"M 端专题背景: ",className:"upload-div"}),S.a.createElement("div",{className:"dropbox"},t("mBackImage",{initialValue:"",rules:[{required:!0,message:"请上传 M 端专题背景！"}]})(S.a.createElement(u.a,{headers:{"Sign-Param":Object(k.A)()},action:"".concat(k.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:d,onPreview:this.handlePreview,onChange:this.handleMBackImgChange},d.length>=1?null:y)),S.a.createElement(o.a,{visible:n,footer:null,onCancel:this.handleCancel},S.a.createElement("img",{alt:"example",style:{width:"100%"},src:i})),S.a.createElement("span",{className:"cover-img-tip"},"用于 M 端专题页面的背景图展示, 长宽比例: ",S.a.createElement("font",{style:{color:"red"}},"待定")))),S.a.createElement(T,C({className:"editable"},h,{label:"专题内容 "}),S.a.createElement(w.a,{getData:function(t){e.setState({contentList:t})}})),S.a.createElement(T,{wrapperCol:{span:12,offset:2}},S.a.createElement(c.a,{type:"primary","data-status":"1",htmlType:"submit",style:{marginRight:"10px"}},"保存"),S.a.createElement(c.a,{type:"primary",className:"cancel",onClick:function(){E.hashHistory.goBack()}},"取消")))))}}])&&N(a.prototype,n),i&&N(a,i),t}();t.default=Object(I.connect)(function(e){return{specialTopicInfo:e.specialTopicInfo.info}})(b.a.create()(F))},1675:function(e,t,a){"use strict";a.d(t,"a",function(){return N});a(1385);var n=a(1386),r=a.n(n),i=(a(247),a(183)),c=a.n(i),l=(a(1405),a(1406)),o=a.n(l),s=(a(361),a(20)),u=a.n(s),m=(a(184),a(1378)),p=a.n(m),d=a(0),f=a.n(d),g=a(10),h=a(48);a(1676);function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){k(e,t,a[t])})}return e}function v(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function S(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var O=[],C=function(e){var t=e.editable,a=e.value,n=e.onChange,r=e.type;return f.a.createElement("div",null,t?f.a.createElement(p.a,{type:r||"text",style:{margin:"-5px 0"},value:a,onChange:function(e){return n(e.target.value)}}):a)},N=function(e){function t(e){var a,n,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,r=I(t).call(this,e),a=!r||"object"!==y(r)&&"function"!=typeof r?E(n):r,k(E(a),"handleAdd",function(){var e=a.state,t=e.count,n=e.data,r={editable:!0,key:t,title:"标题".concat(t),url:"http://www.huoxing24.com/",synopsis:"无"};a.setState({data:[r].concat(v(n)),count:t+1})}),k(E(a),"onDelete",function(e,t){var n=v(a.state.data);if(t.id){var r={status:0};r.id=t.id,Object(h.i)("POST","/topic/delcontent",b({},r),function(t){1===t.code?(u.a.success("操作成功！"),a.setState({data:n.filter(function(t){return t.key!==e})}),a.setContentList(n.filter(function(t){return t.key!==e}))):u.a.error(t.msg)})}else a.setState({data:n.filter(function(t){return t.key!==e})}),a.setContentList(n.filter(function(t){return t.key!==e}))}),k(E(a),"setContentList",function(e){var t=[];e.map(function(e,a){var n={};for(var r in e)"key"!==r&&"editable"!==r&&(n[r]=e[r]);t.push(n)}),a.props.getData(t)});var i=a.props,c=i.dataList,l=i.update;a.columns=[{title:"文章标题",dataIndex:"title",width:"30%",render:function(e,t){return a.renderColumns(e,t,"title","text")}},{title:"文章链接(请输入完整的URL地址)",dataIndex:"url",width:"35%",render:function(e,t){return a.renderColumns(e,t,"url","url")}},{title:"备注",dataIndex:"synopsis",width:"15%",render:function(e,t){return a.renderColumns(e,t,"synopsis","text")}},{title:"操作",dataIndex:"operation",render:function(e,t){var n=t.editable;return f.a.createElement("div",{className:"editable-row-operations"},n?f.a.createElement("span",null,f.a.createElement("a",{onClick:function(){return a.save(t.key)}},"保存"),f.a.createElement(o.a,{title:"确定要放弃修改吗？",onConfirm:function(){return a.cancel(t.key)}},f.a.createElement("a",null,"取消"))):f.a.createElement("a",{onClick:function(){return a.edit(t.key)}},"编辑"),a.state.data.length>0?f.a.createElement(o.a,{title:"确定要删除吗？",onConfirm:function(){return a.onDelete(t.key,t)}},f.a.createElement("a",{href:"#"},"删除")):null)}}];var s=[];return l&&c.map(function(e,t){e.key=t,s.push(e)}),a.state=l?{data:s,count:s.length}:{data:O,count:1},a.cacheData=O.map(function(e){return b({},e)}),a}var a,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,d["Component"]),a=t,(n=[{key:"componentWillUpdate",value:function(){}},{key:"renderColumns",value:function(e,t,a,n){var r=this;return f.a.createElement(C,{type:n,editable:t.editable,value:e,onChange:function(e){return r.handleChange(e,t.key,a)}})}},{key:"handleChange",value:function(e,t,a){var n=v(this.state.data),r=n.filter(function(e){return t===e.key})[0];r&&(r[a]=e,this.setState({data:n}),this.setContentList(n))}},{key:"edit",value:function(e){var t=v(this.state.data),a=t.filter(function(t){return e===t.key})[0];this.cacheData=t.map(function(e){return b({},e)}),a&&(a.editable=!0,this.setState({data:t}))}},{key:"save",value:function(e){var t=this,a=v(this.state.data),n=a.filter(function(t){return e===t.key})[0];if(this.props.query){var r={};for(var i in n)"key"!==i&&"editable"!==i&&(r[i]=n[i]);if(n&&!n.id){var c={topic:{id:this.props.query},contentList:[]};c.contentList.push(r),Object(h.m)("/topic/addcontent",b({},c),function(e){1===e.code?(delete n.editable,n.id=e.obj,u.a.success("操作成功！"),t.setState({data:a}),t.cacheData=a.map(function(e){return b({},e)})):u.a.error(e.msg)})}else r.status=1,delete r.key,Object(h.i)("POST","/topic/updatecontent",b({},r),function(e){1===e.code?(delete n.editable,t.setState({data:a}),t.cacheData=a.map(function(e){return b({},e)}),u.a.success("操作成功！")):u.a.error(e.msg)})}else n&&(delete n.editable,this.setState({data:a}),this.cacheData=a.map(function(e){return b({},e)}),this.setContentList(a))}},{key:"cancel",value:function(e){var t=v(this.state.data),a=t.filter(function(t){return e===t.key})[0];a&&(Object.assign(a,this.cacheData.filter(function(t){return e===t.key})[0]),delete a.editable,this.setState({data:t}))}},{key:"render",value:function(){return f.a.createElement("div",{className:"editable-table"},f.a.createElement(c.a,{className:"editable-add-btn",type:"primary",onClick:this.handleAdd},"新增"),this.props.backButton?f.a.createElement(c.a,{type:"primary",className:"cancel",style:{marginLeft:15},onClick:function(){g.hashHistory.goBack()}},"返回"):"",f.a.createElement(r.a,{pagination:!1,bordered:!0,dataSource:this.state.data,columns:this.columns}))}}])&&S(a.prototype,n),i&&S(a,i),t}()},1676:function(e,t,a){var n=a(1677);"string"==typeof n&&(n=[[e.i,n,""]]);var r={transform:void 0};a(186)(n,r);n.locals&&(e.exports=n.locals)},1677:function(e,t,a){(e.exports=a(185)(!1)).push([e.i,"",""])}}]);