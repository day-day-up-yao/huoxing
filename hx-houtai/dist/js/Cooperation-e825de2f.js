(window.webpackJsonp=window.webpackJsonp||[]).push([[84],{1565:function(e,t,n){"use strict";n.r(t);n(1388);var a=n(1389),r=n.n(a),o=(n(1390),n(1391)),i=n.n(o),s=(n(184),n(1378)),l=n.n(s),c=(n(675),n(676)),u=n.n(c),p=(n(1385),n(1386)),m=n.n(p),f=(n(1381),n(1382)),d=n.n(f),g=(n(1383),n(1384)),y=n.n(g),b=(n(247),n(183)),h=n.n(b),v=(n(1387),n(50)),w=n.n(v),E=(n(1376),n(1377)),O=n.n(E),S=(n(361),n(20)),k=n.n(S),I=(n(677),n(362)),j=n.n(I),P=(n(1379),n(1380)),C=n.n(P),N=n(0),_=n.n(N),x=n(246),L=n(48),D=n(2);function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var A=function(e,t){return function(n){Object(L.i)("post","/news/getfooterinfo",e?function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){T(e,t,n[t])})}return e}({},e):{},function(e){if(1===e.code){var a=e.obj;n(F({cooList:a.inforList,maxNum:a.showNum})),t&&t(a)}else k.a.error(e.msg)})}},F=function(e){return{type:D.z.INIT_COOPERATION,data:e}},V=function(e){return{type:D.z.SET_PAGE_DATA,data:e}},z=function(e){return{type:D.z.SET_FILTER_DATA,data:e}},M=function(e){return{type:D.z.SET_FORM_DATA,data:e}},q=(n(1801),n(1605));function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(){return(J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){H(e,t,n[t])})}return e}function U(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e,t){return(B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var K=C.a.Item,Q=[],X={labelCol:{xs:{span:2},sm:{span:4}},wrapperCol:{xs:{span:4},sm:{span:16}}},Y=j.a.Option,Z=function(e){function t(){var e,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=W(t).call(this),e=!a||"object"!==R(a)&&"function"!=typeof a?$(n):a,H($(e),"doInit",function(t){var n=e.props,a=n.dispatch,r=n.pageData,o=G({},n.filter,{pageSize:100,currentPage:r.currPage});o=G({},o,t),a(A(o,function(){e.setState({loading:!1})}))}),H($(e),"changePage",function(t){e.setState({loading:!0}),(0,e.props.dispatch)(V({currPage:t})),e.doInit({currentPage:t,type:e.state.newsStatus})}),H($(e),"handleChange",function(t){(0,e.props.dispatch)(z({type:t})),e.setState({newsStatus:t}),e.doInit({currentPage:1,type:t})}),H($(e),"updateCoo",function(t){e.props.dispatch(M(t)),3===parseInt(e.props.filter.type)&&e.setState({imageList:[{uid:0,name:"xxx.png",status:"done",url:t.image}],image:t.image}),e.setState({visible:!0})}),H($(e),"handleImageChange",function(t){var n=t.file,a=t.fileList;e.setState({imageList:a}),"removed"===n.status&&e.setState({image:""}),n.response&&(1===n.response.code&&"done"===n.status&&e.setState({image:n.response.obj}),"error"===n.status&&(k.a.error("网络错误，上传失败！"),e.setState({image:"",imageList:[]})))}),H($(e),"delCoo",function(t){var n=$(e);O.a.confirm({title:"提示",content:"确认要删除该友情链接?",onOk:function(){var e={id:t.id,type:t.type};Object(L.i)("POST","/news/delfooterinfo",G({},e),function(e){1===e.code?(k.a.success("操作成功"),n.doInit()):k.a.error(e.msg)})}})}),H($(e),"submitForm",function(){var t=$(e),n=e.props,a=n.form,r=n.formData,o=n.filter;a.validateFields(function(n,i){if(n)return!1;3===parseInt(o.type)&&(i.image=e.state.image),r.id?Object(L.i)("post","/news/updatefooterinfo",G({},i,{id:r.id,type:e.state.newsStatus}),function(n){1===n.code?(k.a.success("操作成功!"),t.setState({visible:!1}),e.props.dispatch(M({name:"",url:"",show_num:"",id:""})),t.doInit({type:e.state.newsStatus}),a.resetFields()):k.a.success(n.msg)}):Object(L.i)("post","/news/addfooterinfo",G({},i,{type:e.state.newsStatus}),function(n){1===n.code?(k.a.success("操作成功!"),t.setState({visible:!1}),e.props.dispatch(M({name:"",url:"",show_num:"",id:""})),t.doInit({type:e.state.newsStatus}),a.resetFields()):k.a.success(n.msg)})})}),H($(e),"getOrderNum",function(t){e.setState({order:t})}),H($(e),"handlePreview",function(t){e.setState({previewImage:t.url||t.thumbUrl,previewVisible:!0})}),H($(e),"handleCancel",function(){return e.setState({previewVisible:!1})}),H($(e),"cancelModal",function(){var t=e.props,n=t.form;(0,t.dispatch)(M({name:"",url:"",show_num:"",id:"",image:""})),n.resetFields(),e.setState({visible:!1})}),e.state={loading:!0,visible:!1,newsStatus:1,order:1,imageList:[],image:"",previewVisible:!1,previewImage:""},e}var n,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&B(e,t)}(t,N["Component"]),n=t,(a=[{key:"componentWillMount",value:function(){this.setState({order:this.props.maxNum})}},{key:"componentDidMount",value:function(){var e=this;this.doInit({type:this.state.newsStatus}),Q=[{title:"序号",key:"showNum",render:function(e,t){return _.a.createElement("p",null,t.show_num)}},{title:"名称",key:"linkName",render:function(e,t){return t&&_.a.createElement("div",{className:"flashAccount-info clearfix"},_.a.createElement("div",null,_.a.createElement("h4",{title:t.name},t.name)))}},{title:"网址",dataIndex:"webLink",key:"webLink",render:function(e,t){return t&&_.a.createElement("a",{href:t.url,target:"_blank"},t.url)}},{title:"ID",dataIndex:"linkId",key:"linkId",render:function(e,t){return _.a.createElement("p",null,t.id)}},{title:"链接类型",key:"linkType",render:function(e,t){return t&&1===t.type?_.a.createElement("span",{className:"type-status"},"友情链接"):t&&2===t.type?_.a.createElement("span",{className:"type-status cont-publish"},"热门标签"):t&&3===t.type?_.a.createElement("span",{className:"type-status cont-publish"},"合作伙伴"):void 0}},{title:"创建时间",key:"createTime",render:function(e,t){return _.a.createElement("p",null,Object(L.w)(t.create_time)||"时间格式错误")}},{title:"操作",key:"action",render:function(t){return _.a.createElement("div",{className:"btns"},_.a.createElement("p",null,_.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){e.updateCoo(t)},style:{background:"#108ee9"}},"编辑")),_.a.createElement("p",null,_.a.createElement("a",{onClick:function(){e.delCoo(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#d73435"}},"删除")))}}]}},{key:"render",value:function(){var e=this,t=this.props,n=t.pageData,a=t.filter,o=t.formData,s=t.form,c=t.maxNum,p=this.state,f=p.imageList,g=p.previewImage,b=p.previewVisible,v=p.visible,E=_.a.createElement("div",null,_.a.createElement(w.a,{type:"plus"}),_.a.createElement("div",{className:"ant-upload-text"},"上传图片")),S=s.getFieldDecorator,k=this.props.cooList;return _.a.createElement("div",{className:"cooperation"},_.a.createElement(d.a,null,_.a.createElement(y.a,null,_.a.createElement("span",null,"当前分类："),_.a.createElement(j.a,{defaultValue:"".concat(a.type),style:{width:100},onChange:this.handleChange},_.a.createElement(Y,{value:"1"},"友情链接"),_.a.createElement(Y,{value:"2"},"热门标签"),_.a.createElement(Y,{value:"3"},"合作伙伴")),_.a.createElement("span",null,_.a.createElement(h.a,{type:"primary",style:{margin:"0 0 0 15px"},onClick:function(){e.setState({imageList:[],image:"",visible:!0})}},_.a.createElement(q.a,{type:"icon-post-send"}),"新增")))),_.a.createElement("div",{className:"mt30"},_.a.createElement(u.a,{spinning:this.state.loading,size:"large"},_.a.createElement(m.a,{dataSource:k.map(function(e,t){return G({},e,{key:t})}),columns:Q,bordered:!0,pagination:{current:n.currPage,total:n.totalCount,pageSize:n.pageSize,onChange:function(t){return e.changePage(t)}}}))),_.a.createElement(O.a,{title:"添加/修改链接信息",visible:v,onOk:this.submitForm,onCancel:this.cancelModal},_.a.createElement(C.a,null,_.a.createElement(K,J({},X,{label:"名称"}),S("name",{rules:[{required:!0,message:"请输入名称!"}],initialValue:o.name})(_.a.createElement(l.a,{disabled:!!o.id}))),_.a.createElement(K,J({},X,{label:"链接地址"}),S("url",{rules:[{required:!0,message:"请输入网址!"},{type:"url",message:"格式：http://www.huoxing24.com"}],initialValue:o.url})(_.a.createElement(l.a,null))),_.a.createElement(K,J({},X,{label:"当前序号"}),S("showNum",{rules:[{required:!0,message:"请输入序列号!"},{pattern:/^[1-9][0-9]*$/,message:"请输入正整数，例如：1、2、13等；错误格式：01、1.0"}],initialValue:o.show_num?o.show_num:c+1})(_.a.createElement(i.a,{min:1,max:c+1,type:"number",onChange:this.getOrderNum}))),3===parseInt(a.type)&&v&&_.a.createElement(K,J({},X,{label:"Logo: ",className:"upload-div"}),_.a.createElement("div",{className:"dropbox"},S("image",{initialValue:o.image?f:"",rules:[{required:!0,message:"请上传合作方logo！"}]})(_.a.createElement(r.a,{headers:{"Sign-Param":Object(L.A)()},action:"".concat(L.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:f,onPreview:this.handlePreview,onChange:this.handleImageChange},f.length>=1?null:E)))))),_.a.createElement(O.a,{visible:b,footer:null,onCancel:this.handleCancel},_.a.createElement("img",{alt:"example",style:{width:"100%"},src:g})))}}])&&U(n.prototype,a),o&&U(n,o),t}();t.default=Object(x.connect)(function(e){return{cooList:e.cooperationInfo.cooList,pageData:e.cooperationInfo.pageData,filter:e.cooperationInfo.filter,formData:e.cooperationInfo.formData,maxNum:e.cooperationInfo.maxNum}})(C.a.create()(Z))},1801:function(e,t,n){var a=n(1802);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(186)(a,r);a.locals&&(e.exports=a.locals)},1802:function(e,t,n){(e.exports=n(185)(!1)).push([e.i,"",""])}}]);