(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{1458:function(e,t,n){"use strict";n.r(t);n(675);var a=n(676),r=n.n(a),i=(n(1385),n(1386)),o=n.n(i),c=(n(1381),n(1382)),s=n.n(c),l=(n(1383),n(1384)),u=n.n(l),p=(n(247),n(183)),m=n.n(p),f=(n(184),n(1378)),d=n.n(f),h=(n(361),n(20)),b=n.n(h),y=(n(677),n(362)),v=n.n(y),g=(n(1376),n(1377)),k=n.n(g),O=n(0),E=n.n(O),w=n(246),S=(n(1648),n(10)),j=n(1628),P=n(48);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){D(e,t,n[t])})}return e}function _(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function N(e){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var L=k.a.confirm,V=v.a.Option,B=[],M=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=N(t).call(this,e),n=!r||"object"!==C(r)&&"function"!=typeof r?T(a):r,D(T(n),"changeTitle",function(e){n.setState({titleVal:e})}),D(T(n),"handleChange",function(e){(0,n.props.dispatch)(Object(j.d)({status:e})),n.setState({icoStatus:e}),n.doSearch("init",{currentPage:1,status:e})}),D(T(n),"handleCancel",function(){return n.setState({previewVisible:!1})}),D(T(n),"handlePreview",function(e){n.setState({previewImage:e.target.getAttribute("src"),previewVisible:!0})}),n.state={loading:!0,previewVisible:!1,previewImage:"",icoStatus:null,titleVal:""},n}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(t,O["Component"]),n=t,(a=[{key:"componentWillMount",value:function(){var e=this,t=this.props.filter;this.doSearch("init",{status:t.status}),B=[{title:"直播标题",width:550,key:"title",render:function(t,n){return n&&E.a.createElement("div",{className:"live-info clearfix"},E.a.createElement("div",null,E.a.createElement("h4",{title:n.title,dangerouslySetInnerHTML:e.createMarkup(n.title)})))}},{title:"直播时间",dataIndex:"beginTime",width:200,key:"beginTime",render:function(e){return e&&Object(P.w)(e)}},{title:"简介",key:"casterDesc",render:function(t,n){return n&&E.a.createElement("h4",{title:n.casterDesc,dangerouslySetInnerHTML:e.createMarkup(Object(P.q)(n.casterDesc,100))})}},{title:"状态",key:"status",width:150,render:function(e){return e&&2===e.status?E.a.createElement("span",{className:"live-status pre-publish"},"已结束"):e&&1===e.status?E.a.createElement("span",{className:"live-status has-publish"},"进行中"):e&&0===e.status?E.a.createElement("span",{className:"live-status will-publish"},"即将开始"):E.a.createElement("span",null,"暂无")}},{title:"直播间",key:"room",width:150,render:function(e){return E.a.createElement("div",null,E.a.createElement("p",{style:{marginBottom:10}},E.a.createElement(S.Link,{className:"mr10 opt-btn",href:"https://www.huoxing24.com/live/".concat(e.id),target:"_blank",style:{background:"#344399"}},"进入直播间")),E.a.createElement("p",{style:{marginBottom:10}},E.a.createElement(S.Link,{className:"mr10 opt-btn",to:{pathname:"/live-detail",query:{id:e.id}},style:{background:"#108ee9"}},"发布内容")))}},{title:"操作",key:"action",width:150,render:function(t){var n="";switch(t.status){case 0:n=E.a.createElement("p",{style:{marginBottom:10}},E.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.enterRoom(t)},style:{background:"#00b45a"}},"开始直播"));break;case 1:n=E.a.createElement("p",{style:{marginBottom:10}},E.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.endRoom(t)},style:{background:"#e9892f"}},"结束直播"));break;default:n=""}return E.a.createElement("div",null,n,E.a.createElement("p",{style:{marginBottom:10}},E.a.createElement(S.Link,{className:"mr10 opt-btn",to:{pathname:"/live-edit",query:{id:t.id}},style:{background:"#108ee9"}},"重新编辑")),E.a.createElement("p",{style:{marginBottom:10}},E.a.createElement("a",{onClick:function(){return e.delLive(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#d73435"}},"删除")))}}]}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e(Object(j.f)({type:"init",nickName:""})),e(Object(j.e)({pageSize:10,totalCount:0}))}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"channelName",value:function(e){var t="";return P.J.map(function(n,a){parseInt(n.value)===e&&(t=n.label)}),t}},{key:"doSearch",value:function(e,t){var n=this,a=this.props,r=a.dispatch,i=a.pageData,o={status:a.filter.status,pageSize:10,currentPage:i.currentPage};o=I({},o,t),r(Object(j.c)(e,o,function(){n.setState({loading:!1})}))}},{key:"_search",value:function(e){this.doSearch("init",{currentPage:1,title:this.state.titleVal})}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.props,n=t.dispatch,a=t.search,r=t.filter;n(Object(j.e)({currentPage:e})),this.doSearch(a.type,I({currentPage:e},r))}},{key:"delLive",value:function(e){var t=this.props.dispatch,n=this;L({title:"提示",content:"确认要删除吗 ?",onOk:function(){var a={castId:e.id,status:-1};Object(P.i)("POST","/caster/room/update/status",I({},a),function(e){1===e.code?(b.a.success("删除成功"),n.doSearch("init"),t(Object(j.f)({type:"init"}))):b.a.error(e.msg)})}})}},{key:"enterRoom",value:function(e){var t=this.props.dispatch;L({title:"提示",content:"确认要开始直播吗 ?",onOk:function(){var n={castId:e.id,status:1};Object(P.i)("POST","/caster/room/update/status",I({},n),function(n){1===n.code?(t(Object(j.d)({status:1})),S.hashHistory.push({pathname:"/live-detail",query:{id:e.id}})):b.a.error(n.msg)})}})}},{key:"endRoom",value:function(e){var t=this.props.dispatch,n=this;L({title:"提示",content:"确认要结束直播吗 ?",onOk:function(){var a={castId:e.id,status:2};Object(P.i)("POST","/caster/room/update/status",I({},a),function(e){1===e.code?(t(Object(j.d)({status:-2})),b.a.success("操作成功"),n.doSearch("init")):b.a.error(e.msg)})}})}},{key:"_isPublish",value:function(e){var t=this;L({title:"提示",content:"确认要".concat(0===e.status?"开启直播":"结束直播","吗 ?"),onOk:function(){var n={id:e.id,status:0===e.status?1:0};Object(P.i)("POST","/news/status",I({},n),function(e){1===e.code?(b.a.success("操作成功！"),t.doSearch("init")):b.a.error(e.msg)})}})}},{key:"_forbidcomment",value:function(e){var t=this,n=this.props.dispatch,a={id:e.id,operate:parseInt(e.forbidComment)?"0":"1"};Object(P.i)("post","/post/forbidcomment",a,function(e){200===e.status?(t.doSearch("init"),n(Object(j.f)({type:"init"}))):b.a.error(e.msg)})}},{key:"_isTop",value:function(e){var t=this,n=this.props.dispatch,a={id:e.id,recommend:1===e.recommend?0:1};Object(P.i)("post","/ico/recommend",a,function(e){1===e.code?(t.doSearch("init"),n(Object(j.f)({type:"init"}))):b.a.error(e.msg)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,a=t.pageData,i=t.filter;return E.a.createElement("div",{className:"live-index"},E.a.createElement(s.a,null,E.a.createElement(u.a,null,E.a.createElement("span",null,"直播状态："),E.a.createElement(v.a,{defaultValue:"".concat(i.status),style:{width:120},onChange:this.handleChange},E.a.createElement(V,{value:"-2"},"全部"),P.J.map(function(e){return E.a.createElement(V,{value:e.value,key:e.value},e.label)})),E.a.createElement("span",{style:{marginLeft:15}},"直播标题： "),E.a.createElement(d.a,{style:{width:200,marginRight:"15px"},onChange:function(t){return e.changeTitle(t.target.value)},placeholder:"请输入直播标题搜索"}),E.a.createElement(m.a,{type:"primary",onClick:function(){e._search()}},"搜索"),E.a.createElement(m.a,{type:"primary",style:{margin:"0 15px"},onClick:function(){return S.hashHistory.push("/live-edit")}},"创建直播"))),E.a.createElement("div",{className:"mt30"},E.a.createElement(r.a,{spinning:this.state.loading,size:"large"},E.a.createElement(o.a,{dataSource:n.map(function(e,t){return I({},e,{key:t})}),columns:B,bordered:!0,pagination:{current:a.currentPage,total:a.totalCount,pageSize:a.pageSize,onChange:function(t){return e.changePage(t)}}}),E.a.createElement(k.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancel},E.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage})))))}}])&&_(n.prototype,a),i&&_(n,i),t}();t.default=Object(w.connect)(function(e){return{liveInfo:e.liveInfo,list:e.liveInfo.list,search:e.liveInfo.search,filter:e.liveInfo.filter,pageData:e.liveInfo.pageData}})(M)}}]);