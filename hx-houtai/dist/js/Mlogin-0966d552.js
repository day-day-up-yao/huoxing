(window.webpackJsonp=window.webpackJsonp||[]).push([[124],{1521:function(e,t,n){"use strict";n.r(t);n(1381);var a=n(1382),o=n.n(a),r=(n(247),n(183)),i=n.n(r),c=(n(1383),n(1384)),s=n.n(c),u=(n(184),n(1378)),l=n.n(u),p=(n(1387),n(50)),f=n.n(p),m=(n(361),n(20)),h=n.n(m),d=(n(1379),n(1380)),g=n.n(d),y=n(0),v=n.n(y),b=n(89),E=n(246),x=(n(1857),n(248)),w=n(48);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t,n,a,o,r,i){try{var c=e[r](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(a,o)}function C(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var N=g.a.Item,P=function(e){function t(e){var n,a,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,o=T(t).call(this,e),n=!o||"object"!==S(o)&&"function"!=typeof o?O(a):o,I(O(n),"enterIconLoading",function(){n.setState({iconLoading:!0})}),I(O(n),"handleSubmit",function(e){e.preventDefault();var t=O(n);n.props.form.validateFields(function(e,a){e||(n.enterIconLoading(),t.props.actions.login(a,function(e){1===e.code&&e.code||t.setState({iconLoading:!1})}))})}),I(O(n),"accountChange",function(e){n.setState({value:e.target.value})}),I(O(n),"getSmsCodeFunc",function(){var e=O(n),t=Object(w.V)(n.state.value),a=n.state,o=a.graphToken,r=a.graphAuth;"发送验证码"===a.smsCodeBtnTxt&&(Object(w.H)(t)?""!==r&&""!==r?function(){var n,a=(n=regeneratorRuntime.mark(function n(){var a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(x.i)({phonenum:t,countrycode:"86",verifcategory:"3",token:o,authenticate:r}).catch(function(e){throw h.a.info("获取验证码错误"),e});case 2:if(a=n.sent){n.next=5;break}return n.abrupt("return");case 5:1!==a.code?(e.graphVerifyProgram(),e.setState({graphToken:"",graphAuth:""})):e.setState({smsCodeBtnTxt:"60s"},function(){e.setState({codeTimer:setInterval(function(){var t=parseInt(e.state.smsCodeBtnTxt);t>0?e.setState({smsCodeBtnTxt:"".concat(t-1,"s")}):(clearInterval(e.state.codeTimer),e.graphVerifyProgram(),e.setState({smsCodeBtnTxt:"发送验证码"}))},1e3)})});case 6:case"end":return n.stop()}},n)}),function(){var e=this,t=arguments;return new Promise(function(a,o){var r=n.apply(e,t);function i(e){k(r,a,o,i,c,"next",e)}function c(e){k(r,a,o,i,c,"throw",e)}i(void 0)})});return function(){return a.apply(this,arguments)}}()():h.a.info("请进行图形验证"):h.a.info("手机格式不正确"))}),I(O(n),"graphVerifyProgram",function(){var e=O(n);new YpRiddler({expired:10,mode:"dialog",winWidth:440,lang:"zh-cn",container:document.getElementById("graphCodeBox"),appId:"a8c0a90197e14dbda2621a071fd256fa",version:"v1",onError:function(t){e.setState({graphToken:"",graphAuth:""}),t.code?5===parseInt(t.code/100)?h.a.info("验证服务暂不可用"):429===t.code?h.a.info("请求过于频繁，请稍后再试"):403===t.code?h.a.info("请求受限，请稍后再试"):400===t.code&&h.a.info("非法请求，请检查参数"):h.a.info("错误请求"),h.a.info("验证服务异常")},onSuccess:function(t,n,a){e.setState({graphToken:t.token,graphAuth:t.authenticate}),console.log("验证通过! token="+t.token+", authenticate="+t.authenticate),a(!0),n()},onFail:function(t,n,a){e.setState({graphToken:"",graphAuth:""}),h.a.info("图形验证失败"),console.error("出错啦："+n+" code: "+t),a()},beforeStart:function(e){console.log("验证马上开始"),e()},onExit:function(){e.setState({graphToken:"",graphAuth:""}),console.log("退出验证")}})}),n.state={value:"",graphToken:"",graphAuth:"",smsCode:"",smsCodeBtnTxt:"发送验证码",iconLoading:!1},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,y["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){this.graphVerifyProgram()}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.codeTimer),this.setState=function(e,t){return!1}}},{key:"render",value:function(){var e=this,t=this.props.form.getFieldDecorator;return v.a.createElement("div",{className:"login-wrap"},v.a.createElement("header",{className:"clearfix"},v.a.createElement("div",{className:"logo"})),v.a.createElement("div",{className:"login-main"},v.a.createElement("div",{className:"login-contain"},v.a.createElement(g.a,{onSubmit:this.handleSubmit,className:"login-form",name:"login"},v.a.createElement(N,{name:"nickNameOrphoneNum"},t("nickNameOrphoneNum",{rules:[{required:!0,message:"请输入账号"}],initialValue:this.state.value})(v.a.createElement(l.a,{onChange:function(t){e.accountChange(t)},style:{height:"40px"},prefix:v.a.createElement(f.a,{type:"user"}),type:"text",placeholder:"请输入账号"}))),v.a.createElement(N,null,v.a.createElement("div",{className:"input-box",id:"graphCodeBox"})),v.a.createElement(N,{name:"phoneCode"},v.a.createElement(o.a,{gutter:8},v.a.createElement(s.a,{span:16},t("phoneCode",{rules:[{required:!0,message:"请输入短信验证码"}]})(v.a.createElement(l.a,{style:{height:"40px"},prefix:v.a.createElement(f.a,{type:"cloud-o"}),placeholder:"短信验证码"}))),v.a.createElement(s.a,{span:8},v.a.createElement(i.a,{onClick:this.getSmsCodeFunc,style:{height:"40px"}},this.state.smsCodeBtnTxt)))),v.a.createElement(N,{name:"password"},t("password",{rules:[{required:!0,message:"请输入密码"}],initialValue:""})(v.a.createElement(l.a,{style:{height:"40px"},prefix:v.a.createElement(f.a,{type:"lock"}),type:"password",placeholder:"请输入密码"}))),v.a.createElement(N,null,v.a.createElement(i.a,{type:"primary",htmlType:"submit",loading:this.state.iconLoading,className:"login-form-button"},"登录"))))))}}])&&C(n.prototype,a),r&&C(n,r),t}();t.default=Object(E.connect)(function(e){return{loginInfo:e.loginInfo}},function(e){return{actions:Object(b.bindActionCreators)({login:x.m},e)}})(g.a.create()(P))},1857:function(e,t,n){var a=n(1858);"string"==typeof a&&(a=[[e.i,a,""]]);var o={transform:void 0};n(186)(a,o);a.locals&&(e.exports=a.locals)},1858:function(e,t,n){(e.exports=n(185)(!1)).push([e.i,"",""])}}]);