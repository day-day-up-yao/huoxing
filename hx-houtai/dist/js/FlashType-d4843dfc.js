(window.webpackJsonp=window.webpackJsonp||[]).push([[96,17],{1586:function(e,t,n){"use strict";n.r(t);n(184);var a=n(1378),r=n.n(a),i=(n(675),n(676)),c=n.n(i),l=(n(1385),n(1386)),o=n.n(l),s=(n(1381),n(1382)),u=n.n(s),p=(n(1383),n(1384)),f=n.n(p),d=(n(247),n(183)),h=n.n(d),m=(n(361),n(20)),y=n.n(m),b=(n(1379),n(1380)),v=n.n(b),g=(n(1376),n(1377)),k=n.n(g),E=(n(678),n(363)),O=n.n(E),S=n(0),j=n.n(S),P=n(246),I=(n(1611),n(1605)),w=n(48),T=n(2);function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){N(e,t,n[t])})}return e}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=function(e){return{type:T.xb,data:e}},C=function(e){return{type:T.I.ADD_DATA,data:e}},x=function(e){return{type:T.I.SET_SEARCH_QUERY,data:e}},A=function(e){return{type:T.I.SET_FILTER_DATA,data:e}},F=function(e){return{type:T.I.SET_PAGE_DATA,data:e}},M=n(11),z=n.n(M);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){U(e,t,n[t])})}return e}function G(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var W=O.a.Group,$=k.a.confirm,Q={labelCol:{xs:{span:2},sm:{span:4}},wrapperCol:{xs:{span:4},sm:{span:16}}},Y=[],B=v.a.Item,K=function(e){function t(){var e,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=H(t).call(this),e=!a||"object"!==q(a)&&"function"!=typeof a?J(n):a,U(J(e),"disabledDate",function(e){return e&&e<z()().endOf("hours")}),U(J(e),"handleChange1",function(t){(0,e.props.dispatch)(A({status:t})),e.doSearch("init",{currentPage:1,status:t})}),U(J(e),"cancelModal",function(){var t=e.props.form;e.setState({visible:!1}),t.resetFields()}),e.state={loading:!0,flashStatus:null,editNewsId:"",visible:!1},e}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,S["Component"]),n=t,(a=[{key:"channelName",value:function(e){var t="";return w.p.map(function(n,a){parseInt(n.value)===e&&(t=n.label)}),t}},{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.search,a=t.filter;this.doSearch("init",V({},a,{title:n.title})),Y=[{title:"频道名称",key:"channelName",render:function(t,n){return n&&j.a.createElement("div",{className:"flash-info clearfix"},j.a.createElement("div",null,j.a.createElement("h4",{title:n.channelName,dangerouslySetInnerHTML:e.createMarkup(Object(w.q)(n.channelName,30))})))}},{title:"频道 ID",dataIndex:"channelId",key:"channelId"},{title:"频道状态",key:"status",render:function(e){return e&&0===e.status?j.a.createElement("span",{className:"flash-status pre-publish"},"关闭 (禁用)"):e&&1===e.status?j.a.createElement("span",{className:"flash-status"},"打开 (使用中)"):j.a.createElement("span",null,"暂无")}},{title:"创建时间",key:"createTime",render:function(e){return e&&Object(w.w)(e.createTime)}},{title:"排序权重",dataIndex:"rank",key:"rank"},{title:"操作",key:"action",render:function(t){return j.a.createElement("div",{className:"btns"},j.a.createElement("p",null,j.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){e.updateType(t)},style:{background:"#108ee9"}},"修改")),j.a.createElement("p",{style:{margin:"10px 0"}},j.a.createElement("a",{className:"mr10 opt-btn",href:"javascript:void(0)",onClick:function(){return e._isPublish(t)},style:{background:"#f68e15"}},1===t.status?"禁用":0===t.status?"启用":void 0)),j.a.createElement("p",null,j.a.createElement("a",{onClick:function(){return e.delType(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#d73435"}},"删除")))}}]}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e(x({type:"init",nickName:""})),e(F({pageSize:20,totalCount:0}))}},{key:"updateType",value:function(e){this.props.dispatch(_(e)),this.setState({visible:!0})}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"doSearch",value:function(e,t){var n=this,a=this.props,r=a.dispatch,i=a.pageData,c=V({},a.filter,{pageSize:20,currentPage:i.currPage});r(function(e,t,n){return function(a){var r="init"===e?"/lives/channel/list":"/post/search";Object(w.i)("get",r,t?D({},t):{},function(e){if(1===e.code){var t=e.obj;a(C({list:t})),n&&n(t)}else y.a.error(e.msg)})}}(e,c=V({},c,t),function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.props.dispatch;this.doSearch("init",{currentPage:1}),e(x({type:"init"})),e(F({currPage:1}))}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.props,n=t.dispatch,a=t.search,r=t.filter;n(F({currPage:e})),this.doSearch(a.type,V({currentPage:e},r))}},{key:"delType",value:function(e){var t=this.props.dispatch,n=this;$({title:"提示",content:"确认要删除吗 ?",onOk:function(){var a={id:e.id};Object(w.i)("POST","/lives/channel/del",V({},a),function(e){1===e.code?(y.a.success("删除成功"),n.doSearch("init"),t(x({type:"init"}))):y.a.error(e.msg)})}})}},{key:"_isPublish",value:function(e){var t=this;$({title:"提示",content:"确认要".concat(1===e.status?"禁用":"启用","吗 ?"),onOk:function(){var n={id:e.id,channelId:e.channelId,channelName:e.channelName,rank:e.rank,status:0===e.status?1:0};Object(w.i)("POST","/lives/channel/update",V({},n),function(e){1===e.code?(y.a.success("操作成功"),t.doSearch("init")):y.a.error(e.msg)})}})}},{key:"submit",value:function(){var e=this,t=this.props,n=t.dispatch,a=t.form,r=t.selectedData,i=this;a.validateFields(function(t,c){if(t)return!1;var l,o;c.id=r.id,r.id?Object(w.i)("POST","/lives/channel/update",c,function(t){1===t.code?(y.a.success("操作成功!"),e.setState({visible:!1}),a.resetFields(),i.doSearch("init")):y.a.success(t.msg)}):n((l=c,o=function(){e.setState({visible:!1}),a.resetFields(),e.doSearch("init")},function(e){Object(w.i)("post","/lives/channel/add",D({},l),function(e){1===e.code?(y.a.success("添加成功！"),o&&o()):y.a.error(e.msg)})}))})}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,a=t.form,i=t.selectedData,l=t.pageData,s=t.dispatch,p=a.getFieldDecorator;return j.a.createElement("div",{className:"flash-index"},j.a.createElement(u.a,null,j.a.createElement(f.a,null,j.a.createElement("span",null,j.a.createElement(h.a,{type:"primary",style:{margin:0},onClick:function(){e.setState({visible:!0}),s(_({}))}},j.a.createElement(I.a,{type:"icon-flash-send"}),"新增")))),j.a.createElement("div",{className:"mt30"},j.a.createElement(c.a,{spinning:this.state.loading,size:"large"},j.a.createElement(o.a,{dataSource:n.map(function(e,t){return V({},e,{key:t})}),columns:Y,bordered:!0,pagination:{current:l.currPage,total:l.totalCount,pageSize:l.pageSize,onChange:function(t){return e.changePage(t)}}}))),j.a.createElement(k.a,{title:"添加/修改账号",visible:this.state.visible,onOk:function(){return e.submit()},onCancel:this.cancelModal},j.a.createElement(v.a,null,j.a.createElement(B,R({},Q,{label:"频道名称"}),p("channelName",{rules:[{required:!0,message:"请输入频道名称!"}],initialValue:""===i.channelName?"":i.channelName})(j.a.createElement(r.a,null))),j.a.createElement(B,R({},Q,{label:"频道 ID"}),p("channelId",{rules:[{required:!0,message:"请输入频道 ID!"},{pattern:/^[1-9]\d*$/,message:"请输入正确的频道 ID!"}],initialValue:""===i.channelId?"":i.channelId})(j.a.createElement(r.a,{disabled:i.id&&""!==i.id}))),j.a.createElement(B,R({},Q,{label:"排序权重"}),p("rank",{rules:[{required:!i.rank&&""!==i.rank,message:"请输入排序权重!"},{pattern:/^[0-9]\d*$/,message:"请输入正确的权重值!"}],initialValue:""===i.rank?"":i.rank})(j.a.createElement(r.a,{placeholder:"权重越大, 排序越靠前"}))),j.a.createElement(B,R({},Q,{label:"状态"}),p("status",{initialValue:(0===i.status?"0":"1")||"1"})(j.a.createElement(W,null,j.a.createElement(O.a,{value:"1"},"启用"),j.a.createElement(O.a,{value:"0"},"禁用")))))))}}])&&G(n.prototype,a),i&&G(n,i),t}();t.default=Object(P.connect)(function(e){return{flashInfo:e.flashTypeInfo,list:e.flashTypeInfo.list,search:e.flashTypeInfo.search,filter:e.flashTypeInfo.filter,pageData:e.flashTypeInfo.pageData,selectedData:e.flashTypeInfo.selectedData}})(v.a.create()(K))},1611:function(e,t,n){var a=n(1644);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(186)(a,r);a.locals&&(e.exports=a.locals)},1644:function(e,t,n){(e.exports=n(185)(!1)).push([e.i,"",""])}}]);