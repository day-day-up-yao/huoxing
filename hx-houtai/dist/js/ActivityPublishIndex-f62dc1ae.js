(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{1483:function(e,t,n){"use strict";n.r(t);n(675);var a=n(676),r=n.n(a),i=(n(1385),n(1386)),c=n.n(i),o=(n(1381),n(1382)),s=n.n(o),l=(n(1383),n(1384)),u=n.n(l),p=(n(247),n(183)),d=n.n(p),f=(n(184),n(1378)),m=n.n(f),h=(n(361),n(20)),b=n.n(h),y=(n(1379),n(1380)),v=n.n(y),g=(n(677),n(362)),O=n.n(g),E=(n(1376),n(1377)),k=n.n(E),w=n(0),j=n.n(w),S=n(246),P=(n(1661),n(10)),T=n(1655),C=n(248),I=n(48),_=n(11),N=n.n(_);function D(e){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){F(e,t,n[t])})}return e}function x(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function F(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=k.a.confirm,q=O.a.Option,H=v.a.Item,J={labelCol:{xs:{span:2},sm:{span:4}},wrapperCol:{xs:{span:4},sm:{span:16}}},U=[],W=function(e){function t(){var e,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=M(t).call(this),e=!a||"object"!==D(a)&&"function"!=typeof a?z(n):a,F(z(e),"disabledDate",function(e){return e&&e<N()().endOf("hours")}),F(z(e),"handleChange",function(t){(0,e.props.dispatch)(Object(T.e)({status:t})),e.setState({newsStatus:t}),e.doSearch("init",{currentPage:1,status:t})}),F(z(e),"handleChange1",function(t){(0,e.props.dispatch)(Object(T.e)({recommend:t})),e.doSearch("init",{currentPage:1,recommend:t})}),F(z(e),"handleChange2",function(t){(0,e.props.dispatch)(Object(T.e)({ingOrEnd:t})),e.doSearch("init",{currentPage:1,ingOrEnd:t})}),e.state={loading:!0,newsStatus:null,activityId:""},e}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,w["Component"]),n=t,(a=[{key:"channelName",value:function(e){var t="";return this.props.placeList.map(function(n,a){parseInt(n.value)===e&&(t=n.label)}),t}},{key:"componentWillMount",value:function(){var e=this,t=this.props,n=t.search,a=t.filter;(0,t.dispatch)(Object(C.e)()),this.doSearch("init",L({},a,{title:n.title})),U=[].concat([{title:"活动标题",width:200,key:"name",render:function(t,n){return n&&j.a.createElement("div",{className:"activityPublish-info clearfix"},j.a.createElement("div",null,j.a.createElement("h4",{title:n.title,dangerouslySetInnerHTML:e.createMarkup(Object(I.q)(n.title,30))}),parseInt(n.recommend)?j.a.createElement("div",{style:{display:"inline-block",verticalAlign:"middle"}},j.a.createElement("span",{className:"org-bg mr10"},"推荐")):"",1!==n.status?j.a.createElement("div",{style:{display:"inline-block",verticalAlign:"middle"}},j.a.createElement("span",{className:"gray-bg mr10"},"未发布")):j.a.createElement("div",{style:{display:"inline-block",verticalAlign:"middle"}},j.a.createElement("span",{className:"green-bg mr10"},"已发布")),n.topOrder&&0!==parseInt(n.topOrder)?j.a.createElement("div",{style:{display:"inline-block",verticalAlign:"middle"},className:"news-top clearfix"},j.a.createElement("span",{className:"top-bg"},"置顶(",n.topOrder,")")):""))}},{title:"状态",key:"ingOrEnd",width:80,render:function(e){return e&&2===e.ingOrEnd?j.a.createElement("span",{className:"news-status pre-publish"},"已结束"):e&&1===e.ingOrEnd?j.a.createElement("span",{className:"news-status"},"进行中"):j.a.createElement("span",{className:"news-status will-publish"},"暂无")}},{title:"城市",width:50,dataIndex:"place",key:"place",render:function(e){return"overseas"===e?"海外":"others"===e?"其他":e}},{title:"开始时间",key:"startTime",width:150,render:function(e){return e&&Object(I.w)(e.startTime)}},{title:"结束时间",key:"endTime",width:150,render:function(e){return e&&Object(I.w)(e.endTime)}}],[{title:"推荐",key:"option",width:110,render:function(t){return j.a.createElement("div",{className:"btns"},j.a.createElement("p",null,j.a.createElement("a",{className:"mr10 recommend-btn opt-btn ".concat(1!==t.status?"disabled":""),href:"javascript:void(0)",onClick:function(){return e._isTop(t)},disabled:1!==t.status&&!0},1===t.recommend?"取消推荐":"推荐")),j.a.createElement("p",null,parseInt(t.topOrder)?j.a.createElement("a",{className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#ff4f3e"},onClick:function(){return e.cancelTop(t.id)}},"取消置顶"):j.a.createElement("a",{className:"mr10 top-btn opt-btn ".concat(1!==t.status?"disabled":""),disabled:1!==t.status&&!0,href:"javascript:void(0)",onClick:function(){return e.showToTopModal(t.id,t)}},"置顶")),parseInt(t.topOrder)?j.a.createElement("p",null,j.a.createElement("a",{className:"mr10 top-btn opt-btn ".concat(1!==t.status?"disabled":""),disabled:1!==t.status&&!0,href:"javascript:void(0)",onClick:function(){return e.showToTopModal(t.id,t)}},"修改置顶位")):"")}},{title:"操作",key:"action",width:130,render:function(t){return j.a.createElement("div",{className:"btns"},j.a.createElement("p",null,j.a.createElement(P.Link,{className:"mr10 opt-btn",to:{pathname:"/activityPublish-detail",query:{id:t.id}},style:{background:"#108ee9"}},"详情")),j.a.createElement("p",null,j.a.createElement(P.Link,{className:"mr10 opt-btn",to:{pathname:"/activityPublish-send",query:{id:t.id}},style:{background:"#e35ba3"}},"编辑")),j.a.createElement("p",null,j.a.createElement("a",{disabled:1!==t.status&&0!==t.status,className:"mr10 opt-btn",href:"javascript:void(0)",onClick:function(){return e._isPublish(t)},style:{background:"#00a854"}},1===t.status?"撤回":0===t.status?"发布":-1===t.status?"已删除":"不可操作")),j.a.createElement("p",null,j.a.createElement("a",{onClick:function(){return e.delActivityPublish(t)},className:"mr10 opt-btn",href:"javascript:void(0)",style:{background:"#d73435"}},"删除")))}}])}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e(Object(T.g)({type:"init",nickName:""})),e(Object(T.f)({pageSize:20,totalCount:0}))}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"cancelTop",value:function(e){var t=this.props.dispatch,n=this;R({title:"提示",content:"确认要取消置顶吗 ?",onOk:function(){var a={id:e,topOrder:0};Object(I.i)("POST","/activity/settoporder",L({},a),function(e){1===e.code?(b.a.success("取消置顶成功"),n.doSearch("init"),t(Object(T.g)({type:"init"}))):b.a.error(e.msg)})}})}},{key:"showToTopModal",value:function(e,t){var n=this.props.dispatch;this.setState({activityId:e,topIsShow:!0}),n(Object(T.d)(t))}},{key:"setNewsTop",value:function(){var e=this,t=this.props.form,n=this;t.validateFields(function(a,r){a||(e.setState({topIsShow:!1}),Object(I.i)("post","/activity/settoporder",{id:e.state.activityId,topOrder:r.order},function(e){1===e.code?(b.a.success("操作成功！"),n.doSearch("init")):b.a.error(e.msg)}),t.resetFields())})}},{key:"changeTopValue",value:function(e,t){var n=this.props.dispatch,a=e.target.value;0!==parseInt(a)?n(Object(T.a)({topOrder:a},t.key)):b.a.warning("置顶权重值不能为0！")}},{key:"_editTopValue",value:function(e,t){var n=e.target.value,a=t.id;n?/^\d+$/.test(n)?this.newsIsToTop({id:a,topOrder:n}):b.a.warning("置顶权重值必须是整数！"):b.a.warning("请输入置顶权重值！")}},{key:"doSearch",value:function(e,t){var n=this;console.log(123);var a=this.props,r=a.dispatch,i=a.pageData,c=a.search,o=L({},a.filter,{title:c.title,pageSize:20,currentPage:i.currPage});this.setState({loading:!0}),o=L({},o,t),r(Object(T.c)("init",o,function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.props,t=e.dispatch,n=e.search,a="init";a=(n.nickName||n.title,"init"),this.doSearch(a,{currentPage:1}),t(Object(T.g)({type:a})),t(Object(T.f)({currPage:1}))}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.props,n=t.dispatch,a=t.search,r=t.filter;n(Object(T.f)({currPage:e})),this.doSearch(a.type,L({currentPage:e},r))}},{key:"delActivityPublish",value:function(e){var t=this.props.dispatch,n=this;R({title:"提示",content:"确认要删除吗 ?",onOk:function(){var a={id:e.id,status:-1};Object(I.i)("POST","/activity/status",L({},a),function(e){1===e.code?(b.a.success("删除成功"),n.doSearch("init"),t(Object(T.g)({type:"init"}))):b.a.error(e.msg)})}})}},{key:"_isPublish",value:function(e){var t=this.props.dispatch,n=this;R({title:"提示",content:"确认要".concat(1===e.status?"下线":"发布","吗 ?"),onOk:function(){var a={id:e.id,status:0===e.status?1:0};Object(I.i)("POST","/activity/status",L({},a),function(a){1===a.code?(b.a.success("".concat(1===e.status?"下线":"发布","成功")),n.doSearch("init"),t(Object(T.g)({type:"init"}))):b.a.error(a.msg)})}})}},{key:"_isTop",value:function(e){var t=this;R({title:"提示",content:"确认要".concat(1===e.recommend?"撤销推荐（从轮播位撤回）":"推荐到轮播位","吗 ?"),onOk:function(){var n={id:e.id,recommend:1===e.recommend?0:1};Object(I.i)("POST","/activity/recommend",n,function(e){1===e.code?(b.a.success("操作成功"),t.doSearch("init")):b.a.error(e.msg)})}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,a=t.pageData,i=t.filter,o=t.search,l=t.dispatch,p=t.form,f=t.selectedData,h=p.getFieldDecorator;return j.a.createElement("div",{className:"activityPublish-index"},j.a.createElement(s.a,null,j.a.createElement(u.a,null,j.a.createElement("span",null,"未发布/已发布："),j.a.createElement(O.a,{defaultValue:"".concat(i.status),style:{width:100,marginBottom:10},onChange:this.handleChange},j.a.createElement(q,{value:""},"全部"),j.a.createElement(q,{value:"1"},"已发布"),j.a.createElement(q,{value:"0"},"未发布")),j.a.createElement("span",{style:{marginLeft:15}},"状态："),j.a.createElement(O.a,{defaultValue:"".concat(i.ingOrEnd),style:{width:100},onChange:this.handleChange2},j.a.createElement(q,{value:""},"全部"),j.a.createElement(q,{value:"1"},"进行中"),j.a.createElement(q,{value:"2"},"已结束")),j.a.createElement("span",{style:{marginLeft:15}},"推荐："),j.a.createElement(O.a,{defaultValue:"".concat(i.recommend),style:{width:100},onChange:this.handleChange1},j.a.createElement(q,{value:""},"全部"),j.a.createElement(q,{value:"0"},"未推荐"),j.a.createElement(q,{value:"1"},"推荐")),j.a.createElement("span",{style:{marginLeft:15}},"活动标题："),j.a.createElement(m.a,{value:o.title,style:{width:150,marginRight:15},onChange:function(e){return l(Object(T.g)({title:e.target.value}))},placeholder:"请输入活动标题",onPressEnter:function(){e._search()}}),j.a.createElement("span",null,j.a.createElement(d.a,{type:"primary",onClick:function(){e._search()}},"搜索"),j.a.createElement(d.a,{type:"primary",style:{margin:"0 0 0 15px"},onClick:function(){P.hashHistory.push("/activityPublish-send")}},"新增")))),j.a.createElement("div",{className:"mt30"},j.a.createElement(r.a,{spinning:this.state.loading,size:"large"},j.a.createElement(c.a,{dataSource:n.map(function(e,t){return L({},e,{key:t})}),columns:U,bordered:!0,pagination:{current:a.currPage,total:a.totalCount,pageSize:a.pageSize,onChange:function(t){return e.changePage(t)}}}))),j.a.createElement(k.a,{title:"置顶权重",visible:this.state.topIsShow,onOk:function(){return e.setNewsTop()},onCancel:function(){e.setState({topIsShow:!1}),p.resetFields()}},j.a.createElement(v.a,null,j.a.createElement(H,A({},J,{label:"置顶权重"}),h("order",{rules:[{required:!0,message:"请输入置顶权重!"},{pattern:/^[1-9]\d*$/,message:"设置权重必须大于0!"}],initialValue:0===f.topOrder?1:f.topOrder})(j.a.createElement(m.a,{min:1}))))))}}])&&x(n.prototype,a),i&&x(n,i),t}();t.default=Object(S.connect)(function(e){return{activityPublishInfo:e.activityPublishInfo,list:e.activityPublishInfo.list,search:e.activityPublishInfo.search,filter:e.activityPublishInfo.filter,pageData:e.activityPublishInfo.pageData,selectedData:e.activityPublishInfo.selectedData,placeList:e.placeListInfo}})(v.a.create()(W))},1655:function(e,t,n){"use strict";(function(e){n.d(t,"d",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"b",function(){return p}),n.d(t,"a",function(){return f}),n.d(t,"g",function(){return m}),n.d(t,"e",function(){return h}),n.d(t,"f",function(){return b});n(361);var a=n(20),r=n.n(a),i=n(48),c=n(2);function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){s(e,t,n[t])})}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(e){return{type:c.xb,data:e}},u=function(e,t,n){return function(a){var c="init"===e?"/activity/list":"/post/search";Object(i.i)("get",c,t?o({},t):{},function(e){if(1===e.code){var t=e.obj;a(d({list:t.inforList})),a(b({totalCount:t.recordCount,pageSize:t.pageSize,currPage:t.currentPage})),n&&n(t)}else e.msg&&r.a.error(e.msg)})}},p=function(e,t){return function(n){Object(i.i)("post","/activity/getbyid",o({},e),function(e){if(1===e.code){var a=e.obj;n(d({info:a})),t&&t(a)}else r.a.error(e.msg)})}},d=function(e){return{type:c.c.ADD_DATA,data:e}},f=function(e,t){return{type:c.c.EDIT_LIST_ITEM,data:e,index:t}},m=function(e){return{type:c.c.SET_SEARCH_QUERY,data:e}},h=function(e){return{type:c.c.SET_FILTER_DATA,data:e}},b=function(e){return{type:c.c.SET_PAGE_DATA,data:e}}}).call(this,n(97))}}]);