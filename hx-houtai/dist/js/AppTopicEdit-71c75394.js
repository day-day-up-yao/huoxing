(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{1471:function(e,a,t){"use strict";t.r(a);t(675);var n=t(676),r=t.n(n),c=(t(247),t(183)),i=t.n(c),l=(t(1376),t(1377)),s=t.n(l),o=(t(1388),t(1389)),m=t.n(o),p=(t(184),t(1378)),u=t.n(p),g=(t(1387),t(50)),d=t.n(g),f=(t(361),t(20)),h=t.n(f),I=(t(1379),t(1380)),b=t.n(I),S=t(0),v=t.n(S),y=t(246),E=t(10),k=t(1679),w=t(48);t(1678);function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(){return(L=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function C(e,a){for(var t=0;t<a.length;t++){var n=a[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function F(e){return(F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e,a){return(O=Object.setPrototypeOf||function(e,a){return e.__proto__=a,e})(e,a)}function P(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var T=b.a.Item,x=function(e){function a(){var e,t,n,r;!function(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,a);for(var c=arguments.length,i=new Array(c),l=0;l<c;l++)i[l]=arguments[l];return n=this,r=(e=F(a)).call.apply(e,[this].concat(i)),t=!r||"object"!==B(r)&&"function"!=typeof r?N(n):r,P(N(t),"state",{updateOrNot:!1,previewVisible:!1,previewImage:"",pcImgSrcFileList:[],mImgSrcFileList:[],pcImgSrc:"",mImgSrc:"",pcBackImageFileList:[],mBackImageFileList:[],pcBackImage:"",mBackImage:"",loading:!0}),P(N(t),"handleCancel",function(){return t.setState({previewVisible:!1})}),P(N(t),"handlePreview",function(e){t.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})}),P(N(t),"handlePcImgChange",function(e){var a=e.file,n=e.fileList;t.setState({pcImgSrcFileList:n}),"removed"===a.status&&t.setState({pcImgSrc:""}),a.response&&(1===a.response.code&&"done"===a.status&&t.setState({pcImgSrc:a.response.obj}),"error"===a.status&&(h.a.error("网络错误，上传失败！"),t.setState({pcImgSrc:"",pcImgSrcFileList:[]})))}),P(N(t),"handleMImgChange",function(e){var a=e.file,n=e.fileList;t.setState({mImgSrcFileList:n}),"removed"===a.status&&t.setState({mImgSrc:""}),a.response&&(1===a.response.code&&"done"===a.status&&t.setState({mImgSrc:a.response.obj}),"error"===a.status&&(h.a.error("网络错误，上传失败！"),t.setState({mImgSrc:"",mImgSrcFileList:[]})))}),P(N(t),"handlePcBackImgChange",function(e){var a=e.file,n=e.fileList;t.setState({pcBackImageFileList:n}),"removed"===a.status&&t.setState({pcBackImage:""}),a.response&&(1===a.response.code&&"done"===a.status&&t.setState({pcBackImage:a.response.obj}),"error"===a.status&&(h.a.error("网络错误，上传失败！"),t.setState({pcBackImage:"",pcBackImageFileList:[]})))}),P(N(t),"handleMBackImgChange",function(e){var a=e.file,n=e.fileList;t.setState({mBackImageFileList:n}),"removed"===a.status&&t.setState({mBackImage:""}),a.response&&(1===a.response.code&&"done"===a.status&&t.setState({mBackImage:a.response.obj}),"error"===a.status&&(h.a.error("网络错误，上传失败！"),t.setState({mBackImage:"",mBackImageFileList:[]})))}),P(N(t),"handleSubmit",function(e){e.preventDefault(),t.props.form.setFieldsValue({pcImgSrc:t.state.pcImgSrc,mImgSrc:t.state.mImgSrc,pcBackImage:t.state.pcBackImage,mBackImage:t.state.mBackImage}),t.props.form.validateFieldsAndScroll(function(e,a){e||(t.setState({loading:!0}),a.id=t.props.location.query.id,a.type=4,a.setTop=t.props.appTopicInfo.setTop,Object(w.i)("post","/topic/update",a,function(e){1===e.code?(t.setState({loading:!1}),h.a.success("修改成功！"),E.hashHistory.push("/appTopic-list")):(t.setState({loading:!1}),h.a.error(e.msg))}))})}),P(N(t),"createMarkup",function(e){return{__html:e}}),t}var t,n,c;return function(e,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),a&&O(e,a)}(a,S["Component"]),t=a,(n=[{key:"componentWillMount",value:function(){var e=this,a=this.props,t=a.dispatch,n=a.location;n.query.id?t(Object(k.a)({id:n.query.id},function(a){e.setState({updateOrNot:!0,pcImgSrcFileList:[{uid:0,name:"xxx.png",status:"done",url:a.pcImgSrc}],mImgSrcFileList:[{uid:0,name:"xxx.png",status:"done",url:a.mImgSrc}],pcBackImageFileList:[{uid:0,name:"xxx.png",status:"done",url:a.pcBackImage}],mBackImageFileList:[{uid:0,name:"xxx.png",status:"done",url:a.mBackImage}],pcImgSrc:a.pcImgSrc,mImgSrc:a.mImgSrc,pcBackImage:a.pcBackImage,mBackImage:a.mBackImage,loading:!1})})):this.setState({loading:!1})}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,a=this.props.appTopicInfo,t=this.state,n=t.previewVisible,c=t.previewImage,l=t.pcImgSrcFileList,o=t.pcBackImageFileList,p=t.mBackImageFileList,g=t.updateOrNot,f=t.mImgSrcFileList,h={labelCol:{span:1},wrapperCol:{span:15,offset:1}},I=v.a.createElement("div",null,v.a.createElement(d.a,{type:"plus"}),v.a.createElement("div",{className:"ant-upload-text"},"上传图片"));return v.a.createElement("div",{className:"appTopic-send"},v.a.createElement(r.a,{spinning:this.state.loading,size:"large"},v.a.createElement(b.a,{onSubmit:this.handleSubmit},v.a.createElement(T,L({className:"appTopicTitle"},h,{label:"专题名称 "}),e("topicName",{initialValue:g&&a?"".concat(a.topicName):"",rules:[{required:!0,message:"请输入专题名称！"}]})(v.a.createElement(u.a,{className:"appTopic-name",placeholder:"请输入专题名称"}))),v.a.createElement(T,L({className:"appTopicTitle"},h,{label:"专题关键字 "}),e("tags",{initialValue:g&&a?"".concat(a.tags||"暂无"):"",rules:[{required:!0,message:"请输入专题关键字！"}]})(v.a.createElement(u.a,{className:"appTopic-tags",placeholder:"请输入专题关键字"}))),v.a.createElement(T,L({},h,{className:"appTopicTitle",label:"专题链接地址："}),e("typeLink",{initialValue:g&&a?"".concat(a.typeLink||"暂无"):"",rules:[{type:"url",message:"请输入正确的超链接地址！"}]})(v.a.createElement(u.a,{placeholder:"专题跳转的超链接地址"}))),v.a.createElement(T,L({},h,{label:"pc 封面: ",className:"upload-div"}),v.a.createElement("div",{className:"dropbox"},e("pcImgSrc",{initialValue:g&&a?l:"",rules:[{required:!0,message:"请上传pc 封面图！"}]})(v.a.createElement(m.a,{headers:{"Sign-Param":Object(w.A)()},action:"".concat(w.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:l,onPreview:this.handlePreview,onChange:this.handlePcImgChange},l.length>=1?null:I)),v.a.createElement(s.a,{visible:n,footer:null,onCancel:this.handleCancel},v.a.createElement("img",{alt:"example",style:{width:"100%"},src:c})),v.a.createElement("span",{className:"cover-img-tip"},"用于 pc 端首页推荐的封面图展示, 长宽比例: ",v.a.createElement("font",{style:{color:"red"}},"300 * 160")))),v.a.createElement(T,L({},h,{label:"pc 专题背景: ",className:"upload-div"}),v.a.createElement("div",{className:"dropbox"},e("pcBackImage",{initialValue:g&&a?o:"",rules:[{required:!0,message:"请上传 pc 专题背景！"}]})(v.a.createElement(m.a,{headers:{"Sign-Param":Object(w.A)()},action:"".concat(w.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:o,onPreview:this.handlePreview,onChange:this.handlePcBackImgChange},o.length>=1?null:I)),v.a.createElement(s.a,{visible:n,footer:null,onCancel:this.handleCancel},v.a.createElement("img",{alt:"example",style:{width:"100%"},src:c})),v.a.createElement("span",{className:"cover-img-tip"},"用于专题页面的背景图展示, 长宽比例: ",v.a.createElement("font",{style:{color:"red"}},"1920 * 460")))),v.a.createElement(T,L({},h,{label:"M 端专题封面: ",className:"upload-div"}),v.a.createElement("div",{className:"dropbox"},e("mImgSrc",{initialValue:g&&a?f:"",rules:[{required:!0,message:"请上传 m 专题封面图！"}]})(v.a.createElement(m.a,{headers:{"Sign-Param":Object(w.A)()},action:"".concat(w.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:f,onPreview:this.handlePreview,onChange:this.handleMImgChange},f.length>=1?null:I)),v.a.createElement(s.a,{visible:n,footer:null,onCancel:this.handleCancel},v.a.createElement("img",{alt:"example",style:{width:"100%"},src:c})),v.a.createElement("span",{className:"cover-img-tip"},"用于 M 端首页推荐的封面图展示, 长宽比例: ",v.a.createElement("font",{style:{color:"red"}},"待定")))),v.a.createElement(T,L({},h,{label:"M 端专题背景: ",className:"upload-div"}),v.a.createElement("div",{className:"dropbox"},e("mBackImage",{initialValue:g&&a?p:"",rules:[{required:!0,message:"请上传 M 端专题背景！"}]})(v.a.createElement(m.a,{headers:{"Sign-Param":Object(w.A)()},action:"".concat(w.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:p,onPreview:this.handlePreview,onChange:this.handleMBackImgChange},p.length>=1?null:I)),v.a.createElement(s.a,{visible:n,footer:null,onCancel:this.handleCancel},v.a.createElement("img",{alt:"example",style:{width:"100%"},src:c})),v.a.createElement("span",{className:"cover-img-tip"},"用于 M 端专题页面的背景图展示, 长宽比例: ",v.a.createElement("font",{style:{color:"red"}},"496 * 267")))),v.a.createElement(T,{wrapperCol:{span:12,offset:2}},v.a.createElement(i.a,{type:"primary","data-status":"1",htmlType:"submit",style:{marginRight:"10px"}},"保存"),v.a.createElement(i.a,{type:"primary",className:"cancel",onClick:function(){E.hashHistory.goBack()}},"取消")))))}}])&&C(t.prototype,n),c&&C(t,c),a}();a.default=Object(y.connect)(function(e){return{appTopicInfo:e.appTopicInfo.info,selectData:e.appTopicInfo.selectedData}})(b.a.create()(x))}}]);