(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{1601:function(e,t,n){"use strict";n.r(t);n(675);var a=n(676),r=n.n(a),i=(n(1385),n(1386)),o=n.n(i),l=(n(1381),n(1382)),c=n.n(l),s=(n(1383),n(1384)),u=n.n(s),p=(n(247),n(183)),f=n.n(p),d=(n(361),n(20)),m=n.n(d),b=(n(1376),n(1377)),h=n.n(b),v=n(0),y=n.n(v),g=n(246),w=(n(1388),n(1389)),O=n.n(w),S=(n(184),n(1378)),E=n.n(S),j=(n(1387),n(50)),k=n.n(j),I=(n(1379),n(1380)),P=n.n(I),C=n(48);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function T(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var U=P.a.Item,D=function(e){function t(e){var n,a,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,r=L(t).call(this,e),n=!r||"object"!==_(r)&&"function"!=typeof r?M(a):r,N(M(n),"handleCancel",function(){return n.setState({previewVisible:!1})}),N(M(n),"handlePreview",function(e){n.setState({previewImage:e.url||e.thumbUrl,previewVisible:!0})}),N(M(n),"handleChange",function(e){var t=e.file,a=e.fileList;n.setState({fileList:a}),"removed"===t.status&&n.setState({coverImgUrl:""}),t.response&&(1===t.response.code&&"done"===t.status&&(n.setState({coverImgUrl:t.response.obj}),n.props.getImgData(t.response.obj)),"error"===t.status&&(m.a.error("网络错误，上传失败！"),n.setState({coverImgUrl:"",fileList:[]})))}),console.log(e),n.state={previewVisible:!1,previewImage:"",brief:"",loading:!0,userType:"1",fileList:e.data.avatar?[{uid:0,name:"avatar.png",status:"done",url:e.data.avatar}]:[],coverImgUrl:e.data.avatar||""},n}var n,a,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,v["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.visible,n=e.onCancel,a=e.onCreate,r=e.form,i=e.data,o=r.getFieldDecorator,l={labelCol:{span:4},wrapperCol:{span:18,offset:1}},c=y.a.createElement("div",null,y.a.createElement(k.a,{type:"plus"}),y.a.createElement("div",{className:"ant-upload-text"},"上传图片"));return y.a.createElement(h.a,{visible:t,title:"新增讲师",okText:"确定",onCancel:n,onOk:a},y.a.createElement(P.a,null,y.a.createElement(U,x({},l,{label:"讲师名"}),o("name",{initialValue:i.name||"",rules:[{required:!0,message:"请输入直播讲师名！"}]})(y.a.createElement(E.a,null))),y.a.createElement(U,x({},l,{label:"讲师头像",className:"upload-div"}),y.a.createElement("div",{className:"dropbox"},o("avatar",{initialValue:i.name?this.state.fileList:"",rules:[{required:!0,message:"请上传讲师头像！"}]})(y.a.createElement(O.a,{headers:{"Sign-Param":Object(C.A)()},action:"".concat(C.a,"/pic/upload"),name:"uploadFile",listType:"picture-card",fileList:this.state.fileList,onPreview:this.handlePreview,onChange:this.handleChange},this.state.fileList.length>=1?null:c)),y.a.createElement(h.a,{visible:this.state.previewVisible,footer:null,onCancel:this.handleCancel},y.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage})),y.a.createElement("span",{className:"cover-img-tip",style:{display:"inline-block",marginTop:"70px",position:"absolute"}},"用于直播页面头像展示, 长宽比例: ",y.a.createElement("font",{style:{color:"red"}},"1 : 1")))),y.a.createElement(U,x({},l,{label:"讲师信息"}),o("brief",{initialValue:i.brief||""})(y.a.createElement(E.a,{rows:4,type:"textarea"})))))}}])&&T(n.prototype,a),r&&T(n,r),t}(),F=P.a.create()(D),z=(n(1848),n(1685));function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){B(e,t,n[t])})}return e}function A(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G=h.a.confirm,K=[],Q=[{label:"嘉宾",value:"1"},{label:"主持人",value:"2"},{label:"全部",value:"0"}],X=function(e){function t(){var e,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=H(t).call(this),e=!a||"object"!==q(a)&&"function"!=typeof a?J(n):a,B(J(e),"showModal",function(){e.setState({visible:!0})}),B(J(e),"handleCancel",function(){e.setState({visible:!1,data:{}})}),B(J(e),"getImgUrl",function(t){e.setState({imgUrl:t})}),B(J(e),"handleCreate",function(){var t=e.form,n=e.state.data;t.setFieldsValue({avatar:e.state.imgUrl}),t.validateFields(function(a,r){a||(n.lecturerId&&(r.lecturerId=n.lecturerId),Object(C.i)("POST",e.state.data.lecturerId?"/college/lecturer/update":"/college/lecturer/add",r,function(n){1===n.code?(m.a.success("操作成功！"),t.resetFields(),e.setState({visible:!1}),e.doSearch("init")):m.a.error(n.msg)}))})}),B(J(e),"saveFormRef",function(t){e.form=t}),B(J(e),"handleChange",function(t){(0,e.props.dispatch)(Object(z.c)({type:t})),e.setState({type:t}),e.doSearch("init",{page:1,type:t})}),B(J(e),"handleImgModalCancel",function(){return e.setState({previewVisible:!1})}),B(J(e),"handlePreview",function(t){e.setState({previewImage:t.target.getAttribute("src"),previewVisible:!0})}),e.state={visible:!1,loading:!0,type:null,data:{},imgUrl:"",previewVisible:!1,previewImage:""},e}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,v["Component"]),n=t,(a=[{key:"componentWillMount",value:function(){var e=this,t=this.props.filter;this.doSearch("init",R({},t)),K=[{title:"讲师名",key:"name",render:function(t,n){return n&&y.a.createElement("div",{className:"lecturer-info clearfix"},y.a.createElement("div",null,y.a.createElement("h4",{title:n.name,dangerouslySetInnerHTML:e.createMarkup(Object(C.q)(n.name,30))})))}},{title:"讲师头像 ",dataIndex:"avatar",key:"avatar",render:function(t){return y.a.createElement("div",{className:"shrinkPic",key:t,style:{background:"url(".concat(t||"http://static.huoxing24.com/images/2018/03/31/1522470188490129.png",") no-repeat center / cover")},src:t||"http://static.huoxing24.com/images/2018/03/31/1522470188490129.png",onClick:e.handlePreview})}},{title:"创建时间",dataIndex:"createTime",key:"createTime",render:function(e){return e&&Object(C.w)(e)}},{title:"讲师描述",key:"brief",render:function(t){return t.brief?y.a.createElement("h4",{title:t.brief,dangerouslySetInnerHTML:e.createMarkup(Object(C.q)(t.brief,80))}):"无"}},{title:"操作",key:"action",render:function(t){return y.a.createElement("div",null,y.a.createElement("a",{className:"mr10 opt-btn",onClick:function(){return e.updateLecturer(t)},style:{background:"#108ee9"}},"修改"))}}]}},{key:"componentWillUnmount",value:function(){var e=this.props.dispatch;e(Object(z.e)({type:"init"})),e(Object(z.d)({pageSize:20,totalCount:0}))}},{key:"createMarkup",value:function(e){return{__html:e}}},{key:"channelName",value:function(e){var t="";return Q.map(function(n,a){parseInt(n.value)===e&&(t=n.label)}),t}},{key:"doSearch",value:function(e,t){var n=this;this.setState({loading:!0});var a=this.props,r=a.dispatch,i={pageSize:20,currentPage:a.pageData.page};i=R({},i,t),r(Object(z.b)(e,i,function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var e=this.props.dispatch;this.doSearch("init",{currentPage:1}),e(Object(z.d)({currentPage:1}))}},{key:"changePage",value:function(e){this.setState({loading:!0});var t=this.props,n=t.dispatch,a=t.filter;n(Object(z.d)({currentPage:e})),this.doSearch("init",R({currentPage:e},a))}},{key:"updateLecturer",value:function(e){this.showModal(),this.setState({data:e})}},{key:"delIco",value:function(e){var t=this.props.dispatch,n=this;G({title:"提示",content:"确认要删除吗 ?",onOk:function(){var a={id:e.userId,status:0};Object(C.i)("POST","/caster/user/delete",R({},a),function(e){1===e.code?(m.a.success("删除成功"),n.doSearch("init"),t(Object(z.e)({type:"init"}))):m.a.error(e.msg)})}})}},{key:"_isPublish",value:function(e){var t=this;G({title:"提示",content:"确认要".concat(0===e.type?"开启直播":"结束直播","吗 ?"),onOk:function(){var n={id:e.id,type:0===e.type?1:0};Object(C.i)("POST","/news/status",R({},n),function(e){1===e.code?(m.a.success("操作成功！"),t.doSearch("init")):m.a.error(e.msg)})}})}},{key:"render",value:function(){var e=this,t=this.props,n=t.list,a=t.pageData;return y.a.createElement("div",{className:"lecturer-index"},y.a.createElement(c.a,null,y.a.createElement(u.a,null,y.a.createElement(f.a,{type:"primary",style:{margin:"0 15px 0 0"},onClick:this.showModal},"新增讲师"))),y.a.createElement("div",{className:"mt30"},y.a.createElement(r.a,{spinning:this.state.loading,size:"large"},y.a.createElement(o.a,{dataSource:n.map(function(e,t){return R({},e,{key:t})}),columns:K,bordered:!0,pagination:{current:a.page,total:a.totalCount,pageSize:a.pageSize,onChange:function(t){return e.changePage(t)}}}))),y.a.createElement(h.a,{className:"pre-Modal",visible:this.state.previewVisible,footer:null,onCancel:this.handleImgModalCancel},y.a.createElement("img",{alt:"example",style:{width:"100%"},src:this.state.previewImage})),this.state.visible&&y.a.createElement(F,{getImgData:function(t){e.getImgUrl(t)},ref:this.saveFormRef,visible:this.state.visible,onCancel:this.handleCancel,onCreate:this.handleCreate,data:this.state.data}))}}])&&A(n.prototype,a),i&&A(n,i),t}();t.default=Object(g.connect)(function(e){return{lecturerInfo:e.lecturerInfo,list:e.lecturerInfo.list,search:e.lecturerInfo.search,filter:e.lecturerInfo.filter,pageData:e.lecturerInfo.pageData}})(X)},1848:function(e,t,n){var a=n(1849);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(186)(a,r);a.locals&&(e.exports=a.locals)},1849:function(e,t,n){(e.exports=n(185)(!1)).push([e.i,"",""])}}]);