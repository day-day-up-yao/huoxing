(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{1587:function(t,e,n){"use strict";n.r(e);n(675);var a=n(676),r=n.n(a),i=(n(1385),n(1386)),o=n.n(i),s=(n(1381),n(1382)),c=n.n(s),u=(n(1383),n(1384)),l=n.n(u),p=(n(361),n(20)),f=n.n(p),h=(n(677),n(362)),d=n.n(h),m=(n(1376),n(1377)),y=n.n(m),b=n(0),v=n.n(b),g=n(246),k=(n(1611),n(10)),E=n(48),S=n(2);var O=function(t){return{type:S.G.ADD_DATA,data:t}},w=function(t){return{type:S.G.SET_SEARCH_QUERY,data:t}},P=function(t){return{type:S.G.SET_PAGE_DATA,data:t}},j=n(248);function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),a.forEach(function(e){D(t,e,n[e])})}return t}function T(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function N(t){return(N=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function I(t,e){return(I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function D(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var x=y.a.confirm,z=d.a.Option,L=[],G=function(t){function e(){var t,n,a;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),n=this,a=N(e).call(this),t=!a||"object"!==_(a)&&"function"!=typeof a?A(n):a,D(A(t),"handleChange",function(e){(0,t.props.dispatch)(w({status:e})),t.setState({flashStatus:e}),t.doSearch("init",{currentPage:1,status:e})}),t.state={loading:!0,flashStatus:""},t}var n,a,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&I(t,e)}(e,b["Component"]),n=e,(a=[{key:"channelName",value:function(t){var e="";return this.props.flashTypeList.map(function(n,a){parseInt(n.value)===t&&(e=n.label)}),e}},{key:"componentWillMount",value:function(){var t=this.props,e=t.dispatch,n=t.search;e(Object(j.k)()),this.doSearch(n.type?n.type:"init"),L=[{title:"快讯内容",width:"500px",key:"content",render:function(t,e){return v.a.createElement("div",{className:"flash-info clearfix"},v.a.createElement("div",null,v.a.createElement("h4",null,"【",e.title||"快讯","】",Object(E.q)(e.content,50))),e.pictureUrl?v.a.createElement("img",{src:e.pictureUrl.split(",")[0]}):"")}},{title:"昵称",dataIndex:"nickName",key:"nickName"},{title:"利好",dataIndex:"upCounts",key:"upCounts",render:function(t){return t||0}},{title:"利空 ",dataIndex:"downCounts",key:"downCounts",render:function(t){return t||0}},{title:"状态",key:"status",render:function(t){return 0===t.status?v.a.createElement("span",{className:"state-btns prev"},"待审核"):1===t.status?v.a.createElement("span",{className:"state-btns pass"},"审核通过"):2===t.status?v.a.createElement("div",null,v.a.createElement("span",{className:"state-btns nopass"},"审核未通过"),v.a.createElement("p",{style:{marginTop:10}},"(原因：",t.nopassLivesReason,")")):v.a.createElement("span",{className:"state-btns none"},"状态暂无")}},{title:"发表时间",key:"createdTime",render:function(t){return Object(E.w)(t.createdTime)}},{title:"操作",key:"action",render:function(t){return v.a.createElement("div",null,v.a.createElement(k.Link,{className:"mr10",to:{pathname:"/flash-auditEdit",query:{id:t.id,audit:!0}}},0===t.status?"审核":"重新审核"))}}]}},{key:"componentWillUnmount",value:function(){var t=this.props.dispatch;t(w({type:"init",nickName:"",title:""})),t(P({pageSize:20,totalCount:0}))}},{key:"createMarkup",value:function(t){return{__html:t}}},{key:"doSearch",value:function(t,e){var n=this,a=this.props,r=a.dispatch,i=a.pageData,o=a.search,s={currentPage:i.currPage,status:o.status};r(function(t,e,n){return function(a){var r="init"===t?"/lives/showpartnerlives":"/post/search";Object(E.i)("get",r,e||{},function(t){if(1===t.code){var e=t.obj;a(O({list:e.inforList||[]})),a(P({totalCount:e.recordCount,pageSize:e.pageSize,currPage:e.currentPage})),n&&n(e)}else f.a.error(t.msg)})}}(t,s=C({},s,e),function(){n.setState({loading:!1})}))}},{key:"_search",value:function(){var t=this.props.dispatch;this.doSearch("init",{currentPage:1}),t(w({type:"init"})),t(P({currPage:1}))}},{key:"changePage",value:function(t){this.setState({loading:!0});var e=this.props,n=e.dispatch,a=e.search;n(P({currPage:t})),this.doSearch(a.type,{currentPage:t})}},{key:"delFlash",value:function(t){var e=this.props.dispatch,n=this;x({title:"提示",content:"确认要删除吗 ?",onOk:function(){var a={id:t.id,status:-1};Object(E.i)("POST","/lives/status",C({},a),function(t){1===t.code?(f.a.success("删除成功"),n.doSearch("init"),e(w({type:"init"}))):f.a.error(t.msg)})}})}},{key:"_forbidcomment",value:function(t){var e=this,n=this.props.dispatch,a={id:t.id,operate:parseInt(t.forbidComment)?"0":"1"};Object(E.i)("post","/post/forbidcomment",a,function(t){200===t.status?(e.doSearch("init"),n(w({type:"init"}))):f.a.error(t.msg)})}},{key:"_isTop",value:function(t){var e=this,n=this.props.dispatch,a={id:t.id,operate:"1"===t.isTop?"0":"1"};Object(E.i)("post","/post/top",a,function(t){200===t.status?(e.doSearch("init"),n(w({type:"init"}))):f.a.error(t.msg)})}},{key:"render",value:function(){var t=this,e=this.props,n=e.list,a=e.pageData,i=e.search;return v.a.createElement("div",{className:"flash-index"},v.a.createElement(c.a,null,v.a.createElement(l.a,{span:3,style:{minWidth:200}},v.a.createElement("span",null,"帖子状态："),v.a.createElement(d.a,{defaultValue:"".concat(i.status),style:{width:120},onChange:this.handleChange},E.u.map(function(t){return v.a.createElement(z,{value:t.value,key:t.value},t.label)})))),v.a.createElement("div",{className:"mt30"},v.a.createElement(r.a,{spinning:this.state.loading,size:"large"},v.a.createElement(o.a,{dataSource:n.map(function(t,e){return C({},t,{key:e})}),columns:L,bordered:!0,pagination:{current:a.currPage,total:a.totalCount,pageSize:a.pageSize,onChange:function(e){return t.changePage(e)}}}))))}}])&&T(n.prototype,a),i&&T(n,i),e}();e.default=Object(g.connect)(function(t){return{flashInfo:t.flashAuditInfo,list:t.flashAuditInfo.list,search:t.flashAuditInfo.search,pageData:t.flashAuditInfo.pageData,flashTypeList:t.flashTypeListInfo}})(G)}}]);